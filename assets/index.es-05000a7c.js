import{d3 as Ms,d4 as en,d5 as we,d6 as Mb,d7 as rd,d8 as id,d9 as et,da as Nc,db as Yr,dc as Fr,A as sd,dd as nd,de as od,df as Cb,dg as ad,dh as wf,di as la,dj as Rb,dk as Nb,dl as xb,P as hd,dm as ba,dn as Xr,dp as Ob,dq as rn,dr as Es,ds as Qr,dt as Aa,Q as cd,du as Tb,dv as ar,dw as wr,dx as Ea,dy as Db,dz as Fb,dA as bf,dB as qb,dC as Bb,dD as fc,dE as ud,dF as xc,dG as kb,dH as Oc,dI as _a,dJ as Tc,dK as Dc,dL as $i,dM as Gs,O as Ub,dN as Af,dO as $b,_ as jb}from"./index-85f30e3b.js";const zb=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Ms},Symbol.toStringTag,{value:"Module"})),Lb=":";function ra(i){const[t,e]=i.split(Lb);return{namespace:t,reference:e}}function Ef(i,t=[]){const e=[];return Object.keys(i).forEach(s=>{if(t.length&&!t.includes(s))return;const o=i[s];e.push(...o.accounts)}),e}function ld(i,t){return i.includes(":")?[i]:t.chains||[]}var Hb=Object.defineProperty,_f=Object.getOwnPropertySymbols,Kb=Object.prototype.hasOwnProperty,Vb=Object.prototype.propertyIsEnumerable,If=(i,t,e)=>t in i?Hb(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Sf=(i,t)=>{for(var e in t||(t={}))Kb.call(t,e)&&If(i,e,t[e]);if(_f)for(var e of _f(t))Vb.call(t,e)&&If(i,e,t[e]);return i};const Qb="ReactNative",mr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Gb="js";function Xn(){return typeof en<"u"&&typeof en.versions<"u"&&typeof en.versions.node<"u"}function hn(){return!id()&&!!rd()&&navigator.product===Qb}function cn(){return!Xn()&&!!rd()&&!!id()}function io(){return hn()?mr.reactNative:Xn()?mr.node:cn()?mr.browser:mr.unknown}function Jb(){var i;try{return hn()&&typeof we<"u"&&typeof(we==null?void 0:we.Application)<"u"?(i=we.Application)==null?void 0:i.applicationId:void 0}catch{return}}function Yb(i,t){let e=la.parse(i);return e=Sf(Sf({},e),t),i=la.stringify(e),i}function Wb(){return Mb()||{name:"",description:"",url:"",icons:[""]}}function Xb(){if(io()===mr.reactNative&&typeof we<"u"&&typeof(we==null?void 0:we.Platform)<"u"){const{OS:e,Version:s}=we.Platform;return[e,s].join("-")}const i=Rb();if(i===null)return"unknown";const t=i.os?i.os.replace(" ","").toLowerCase():"unknown";return i.type==="browser"?[t,i.name,i.version].join("-"):[t,i.version].join("-")}function Zb(){var i;const t=io();return t===mr.browser?[t,((i=Nb())==null?void 0:i.host)||"unknown"].join(":"):t}function t2(i,t,e){const s=Xb(),o=Zb();return[[i,t].join("-"),[Gb,e].join("-"),s,o].join("/")}function e2({protocol:i,version:t,relayUrl:e,sdkVersion:s,auth:o,projectId:a,useOnCloseEvent:u,bundleId:d}){const y=e.split("?"),b=t2(i,t,s),C={auth:o,ua:b,projectId:a,useOnCloseEvent:u||void 0,origin:d||void 0},P=Yb(y[1]||"",C);return y[0]+"?"+P}function _s(i,t){return i.filter(e=>t.includes(e)).length===i.length}function fd(i){return Object.fromEntries(i.entries())}function pd(i){return new Map(Object.entries(i))}function As(i=et.FIVE_MINUTES,t){const e=et.toMiliseconds(i||et.FIVE_MINUTES);let s,o,a;return{resolve:u=>{a&&s&&(clearTimeout(a),s(u))},reject:u=>{a&&o&&(clearTimeout(a),o(u))},done:()=>new Promise((u,d)=>{a=setTimeout(()=>{d(new Error(t))},e),s=u,o=d})}}function Zn(i,t,e){return new Promise(async(s,o)=>{const a=setTimeout(()=>o(new Error(e)),t);try{const u=await i;s(u)}catch(u){o(u)}clearTimeout(a)})}function dd(i,t){if(typeof t=="string"&&t.startsWith(`${i}:`))return t;if(i.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(i.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${i}`)}function r2(i){return dd("topic",i)}function i2(i){return dd("id",i)}function gd(i){const[t,e]=i.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof e=="string")s.topic=e;else if(t==="id"&&Number.isInteger(Number(e)))s.id=Number(e);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${e}`);return s}function He(i,t){return et.fromMiliseconds((t||Date.now())+et.toMiliseconds(i))}function ss(i){return Date.now()>=et.toMiliseconds(i)}function St(i,t){return`${i}${t?`:${t}`:""}`}function ia(i=[],t=[]){return[...new Set([...i,...t])]}async function s2({id:i,topic:t,wcDeepLink:e}){try{if(!e)return;const s=typeof e=="string"?JSON.parse(e):e;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const a=`${o}/wc?requestId=${i}&sessionTopic=${t}`,u=io();u===mr.browser?a.startsWith("https://")||a.startsWith("http://")?window.open(a,"_blank","noreferrer noopener"):window.open(a,"_self","noreferrer noopener"):u===mr.reactNative&&typeof(we==null?void 0:we.Linking)<"u"&&await we.Linking.openURL(a)}catch(s){console.error(s)}}async function n2(i,t){try{return await i.getItem(t)||(cn()?localStorage.getItem(t):void 0)}catch(e){console.error(e)}}var md=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof we<"u"?we:typeof self<"u"?self:{};function o2(i){var t=i.default;if(typeof t=="function"){var e=function(){return t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(i).forEach(function(s){var o=Object.getOwnPropertyDescriptor(i,s);Object.defineProperty(e,s,o.get?o:{enumerable:!0,get:function(){return i[s]}})}),e}var vd={exports:{}};/**
* [js-sha3]{@link https://github.com/emn178/js-sha3}
*
* @version 0.8.0
* @author Chen, Yi-Cyuan [emn178@gmail.com]
* @copyright Chen, Yi-Cyuan 2015-2018
* @license MIT
*/(function(i){(function(){var t="input is invalid type",e="finalize already called",s=typeof window=="object",o=s?window:{};o.JS_SHA3_NO_WINDOW&&(s=!1);var a=!s&&typeof self=="object",u=!o.JS_SHA3_NO_NODE_JS&&typeof en=="object"&&en.versions&&en.versions.node;u?o=md:a&&(o=self);var d=!o.JS_SHA3_NO_COMMON_JS&&!0&&i.exports,y=!o.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",b="0123456789abcdef".split(""),C=[31,7936,2031616,520093696],P=[4,1024,262144,67108864],O=[1,256,65536,16777216],F=[6,1536,393216,100663296],q=[0,8,16,24],H=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],V=[224,256,384,512],Y=[128,256],ct=["hex","buffer","arrayBuffer","array","digest"],at={128:168,256:136};(o.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(v){return Object.prototype.toString.call(v)==="[object Array]"}),y&&(o.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(v){return typeof v=="object"&&v.buffer&&v.buffer.constructor===ArrayBuffer});for(var it=function(v,$,k){return function(L){return new _(v,$,v).update(L)[k]()}},rt=function(v,$,k){return function(L,Z){return new _(v,$,Z).update(L)[k]()}},ht=function(v,$,k){return function(L,Z,W,X){return f["cshake"+v].update(L,Z,W,X)[k]()}},gt=function(v,$,k){return function(L,Z,W,X){return f["kmac"+v].update(L,Z,W,X)[k]()}},ut=function(v,$,k,L){for(var Z=0;Z<ct.length;++Z){var W=ct[Z];v[W]=$(k,L,W)}return v},Ot=function(v,$){var k=it(v,$,"hex");return k.create=function(){return new _(v,$,v)},k.update=function(L){return k.create().update(L)},ut(k,it,v,$)},Ae=function(v,$){var k=rt(v,$,"hex");return k.create=function(L){return new _(v,$,L)},k.update=function(L,Z){return k.create(Z).update(L)},ut(k,rt,v,$)},yt=function(v,$){var k=at[v],L=ht(v,$,"hex");return L.create=function(Z,W,X){return!W&&!X?f["shake"+v].create(Z):new _(v,$,Z).bytepad([W,X],k)},L.update=function(Z,W,X,ot){return L.create(W,X,ot).update(Z)},ut(L,ht,v,$)},Jt=function(v,$){var k=at[v],L=gt(v,$,"hex");return L.create=function(Z,W,X){return new lt(v,$,W).bytepad(["KMAC",X],k).bytepad([Z],k)},L.update=function(Z,W,X,ot){return L.create(Z,X,ot).update(W)},ut(L,gt,v,$)},c=[{name:"keccak",padding:O,bits:V,createMethod:Ot},{name:"sha3",padding:F,bits:V,createMethod:Ot},{name:"shake",padding:C,bits:Y,createMethod:Ae},{name:"cshake",padding:P,bits:Y,createMethod:yt},{name:"kmac",padding:P,bits:Y,createMethod:Jt}],f={},g=[],E=0;E<c.length;++E)for(var S=c[E],R=S.bits,x=0;x<R.length;++x){var I=S.name+"_"+R[x];if(g.push(I),f[I]=S.createMethod(R[x],S.padding),S.name!=="sha3"){var p=S.name+R[x];g.push(p),f[p]=f[I]}}function _(v,$,k){this.blocks=[],this.s=[],this.padding=$,this.outputBits=k,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(v<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=k>>5,this.extraBytes=(k&31)>>3;for(var L=0;L<50;++L)this.s[L]=0}_.prototype.update=function(v){if(this.finalized)throw new Error(e);var $,k=typeof v;if(k!=="string"){if(k==="object"){if(v===null)throw new Error(t);if(y&&v.constructor===ArrayBuffer)v=new Uint8Array(v);else if(!Array.isArray(v)&&(!y||!ArrayBuffer.isView(v)))throw new Error(t)}else throw new Error(t);$=!0}for(var L=this.blocks,Z=this.byteCount,W=v.length,X=this.blockCount,ot=0,mt=this.s,G,Tt;ot<W;){if(this.reset)for(this.reset=!1,L[0]=this.block,G=1;G<X+1;++G)L[G]=0;if($)for(G=this.start;ot<W&&G<Z;++ot)L[G>>2]|=v[ot]<<q[G++&3];else for(G=this.start;ot<W&&G<Z;++ot)Tt=v.charCodeAt(ot),Tt<128?L[G>>2]|=Tt<<q[G++&3]:Tt<2048?(L[G>>2]|=(192|Tt>>6)<<q[G++&3],L[G>>2]|=(128|Tt&63)<<q[G++&3]):Tt<55296||Tt>=57344?(L[G>>2]|=(224|Tt>>12)<<q[G++&3],L[G>>2]|=(128|Tt>>6&63)<<q[G++&3],L[G>>2]|=(128|Tt&63)<<q[G++&3]):(Tt=65536+((Tt&1023)<<10|v.charCodeAt(++ot)&1023),L[G>>2]|=(240|Tt>>18)<<q[G++&3],L[G>>2]|=(128|Tt>>12&63)<<q[G++&3],L[G>>2]|=(128|Tt>>6&63)<<q[G++&3],L[G>>2]|=(128|Tt&63)<<q[G++&3]);if(this.lastByteIndex=G,G>=Z){for(this.start=G-Z,this.block=L[X],G=0;G<X;++G)mt[G]^=L[G];st(mt),this.reset=!0}else this.start=G}return this},_.prototype.encode=function(v,$){var k=v&255,L=1,Z=[k];for(v=v>>8,k=v&255;k>0;)Z.unshift(k),v=v>>8,k=v&255,++L;return $?Z.push(L):Z.unshift(L),this.update(Z),Z.length},_.prototype.encodeString=function(v){var $,k=typeof v;if(k!=="string"){if(k==="object"){if(v===null)throw new Error(t);if(y&&v.constructor===ArrayBuffer)v=new Uint8Array(v);else if(!Array.isArray(v)&&(!y||!ArrayBuffer.isView(v)))throw new Error(t)}else throw new Error(t);$=!0}var L=0,Z=v.length;if($)L=Z;else for(var W=0;W<v.length;++W){var X=v.charCodeAt(W);X<128?L+=1:X<2048?L+=2:X<55296||X>=57344?L+=3:(X=65536+((X&1023)<<10|v.charCodeAt(++W)&1023),L+=4)}return L+=this.encode(L*8),this.update(v),L},_.prototype.bytepad=function(v,$){for(var k=this.encode($),L=0;L<v.length;++L)k+=this.encodeString(v[L]);var Z=$-k%$,W=[];return W.length=Z,this.update(W),this},_.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var v=this.blocks,$=this.lastByteIndex,k=this.blockCount,L=this.s;if(v[$>>2]|=this.padding[$&3],this.lastByteIndex===this.byteCount)for(v[0]=v[k],$=1;$<k+1;++$)v[$]=0;for(v[k-1]|=2147483648,$=0;$<k;++$)L[$]^=v[$];st(L)}},_.prototype.toString=_.prototype.hex=function(){this.finalize();for(var v=this.blockCount,$=this.s,k=this.outputBlocks,L=this.extraBytes,Z=0,W=0,X="",ot;W<k;){for(Z=0;Z<v&&W<k;++Z,++W)ot=$[Z],X+=b[ot>>4&15]+b[ot&15]+b[ot>>12&15]+b[ot>>8&15]+b[ot>>20&15]+b[ot>>16&15]+b[ot>>28&15]+b[ot>>24&15];W%v===0&&(st($),Z=0)}return L&&(ot=$[Z],X+=b[ot>>4&15]+b[ot&15],L>1&&(X+=b[ot>>12&15]+b[ot>>8&15]),L>2&&(X+=b[ot>>20&15]+b[ot>>16&15])),X},_.prototype.arrayBuffer=function(){this.finalize();var v=this.blockCount,$=this.s,k=this.outputBlocks,L=this.extraBytes,Z=0,W=0,X=this.outputBits>>3,ot;L?ot=new ArrayBuffer(k+1<<2):ot=new ArrayBuffer(X);for(var mt=new Uint32Array(ot);W<k;){for(Z=0;Z<v&&W<k;++Z,++W)mt[W]=$[Z];W%v===0&&st($)}return L&&(mt[Z]=$[Z],ot=ot.slice(0,X)),ot},_.prototype.buffer=_.prototype.arrayBuffer,_.prototype.digest=_.prototype.array=function(){this.finalize();for(var v=this.blockCount,$=this.s,k=this.outputBlocks,L=this.extraBytes,Z=0,W=0,X=[],ot,mt;W<k;){for(Z=0;Z<v&&W<k;++Z,++W)ot=W<<2,mt=$[Z],X[ot]=mt&255,X[ot+1]=mt>>8&255,X[ot+2]=mt>>16&255,X[ot+3]=mt>>24&255;W%v===0&&st($)}return L&&(ot=W<<2,mt=$[Z],X[ot]=mt&255,L>1&&(X[ot+1]=mt>>8&255),L>2&&(X[ot+2]=mt>>16&255)),X};function lt(v,$,k){_.call(this,v,$,k)}lt.prototype=new _,lt.prototype.finalize=function(){return this.encode(this.outputBits,!0),_.prototype.finalize.call(this)};var st=function(v){var $,k,L,Z,W,X,ot,mt,G,Tt,Zt,Rt,Zr,te,Dt,Re,Ft,kt,Ei,qt,ee,hr,xt,$t,qr,jt,zt,Br,Lt,Ht,kr,Kt,re,_i,ie,Yt,ti,se,ne,Ii,oe,Wt,Si,ae,he,Ur,ce,Vt,Pi,ue,le,Mi,fe,pe,Ci,de,Xt,ei,ri,ii,si,ni,oi;for(L=0;L<48;L+=2)Z=v[0]^v[10]^v[20]^v[30]^v[40],W=v[1]^v[11]^v[21]^v[31]^v[41],X=v[2]^v[12]^v[22]^v[32]^v[42],ot=v[3]^v[13]^v[23]^v[33]^v[43],mt=v[4]^v[14]^v[24]^v[34]^v[44],G=v[5]^v[15]^v[25]^v[35]^v[45],Tt=v[6]^v[16]^v[26]^v[36]^v[46],Zt=v[7]^v[17]^v[27]^v[37]^v[47],Rt=v[8]^v[18]^v[28]^v[38]^v[48],Zr=v[9]^v[19]^v[29]^v[39]^v[49],$=Rt^(X<<1|ot>>>31),k=Zr^(ot<<1|X>>>31),v[0]^=$,v[1]^=k,v[10]^=$,v[11]^=k,v[20]^=$,v[21]^=k,v[30]^=$,v[31]^=k,v[40]^=$,v[41]^=k,$=Z^(mt<<1|G>>>31),k=W^(G<<1|mt>>>31),v[2]^=$,v[3]^=k,v[12]^=$,v[13]^=k,v[22]^=$,v[23]^=k,v[32]^=$,v[33]^=k,v[42]^=$,v[43]^=k,$=X^(Tt<<1|Zt>>>31),k=ot^(Zt<<1|Tt>>>31),v[4]^=$,v[5]^=k,v[14]^=$,v[15]^=k,v[24]^=$,v[25]^=k,v[34]^=$,v[35]^=k,v[44]^=$,v[45]^=k,$=mt^(Rt<<1|Zr>>>31),k=G^(Zr<<1|Rt>>>31),v[6]^=$,v[7]^=k,v[16]^=$,v[17]^=k,v[26]^=$,v[27]^=k,v[36]^=$,v[37]^=k,v[46]^=$,v[47]^=k,$=Tt^(Z<<1|W>>>31),k=Zt^(W<<1|Z>>>31),v[8]^=$,v[9]^=k,v[18]^=$,v[19]^=k,v[28]^=$,v[29]^=k,v[38]^=$,v[39]^=k,v[48]^=$,v[49]^=k,te=v[0],Dt=v[1],Ur=v[11]<<4|v[10]>>>28,ce=v[10]<<4|v[11]>>>28,Br=v[20]<<3|v[21]>>>29,Lt=v[21]<<3|v[20]>>>29,ii=v[31]<<9|v[30]>>>23,si=v[30]<<9|v[31]>>>23,Wt=v[40]<<18|v[41]>>>14,Si=v[41]<<18|v[40]>>>14,_i=v[2]<<1|v[3]>>>31,ie=v[3]<<1|v[2]>>>31,Re=v[13]<<12|v[12]>>>20,Ft=v[12]<<12|v[13]>>>20,Vt=v[22]<<10|v[23]>>>22,Pi=v[23]<<10|v[22]>>>22,Ht=v[33]<<13|v[32]>>>19,kr=v[32]<<13|v[33]>>>19,ni=v[42]<<2|v[43]>>>30,oi=v[43]<<2|v[42]>>>30,pe=v[5]<<30|v[4]>>>2,Ci=v[4]<<30|v[5]>>>2,Yt=v[14]<<6|v[15]>>>26,ti=v[15]<<6|v[14]>>>26,kt=v[25]<<11|v[24]>>>21,Ei=v[24]<<11|v[25]>>>21,ue=v[34]<<15|v[35]>>>17,le=v[35]<<15|v[34]>>>17,Kt=v[45]<<29|v[44]>>>3,re=v[44]<<29|v[45]>>>3,$t=v[6]<<28|v[7]>>>4,qr=v[7]<<28|v[6]>>>4,de=v[17]<<23|v[16]>>>9,Xt=v[16]<<23|v[17]>>>9,se=v[26]<<25|v[27]>>>7,ne=v[27]<<25|v[26]>>>7,qt=v[36]<<21|v[37]>>>11,ee=v[37]<<21|v[36]>>>11,Mi=v[47]<<24|v[46]>>>8,fe=v[46]<<24|v[47]>>>8,ae=v[8]<<27|v[9]>>>5,he=v[9]<<27|v[8]>>>5,jt=v[18]<<20|v[19]>>>12,zt=v[19]<<20|v[18]>>>12,ei=v[29]<<7|v[28]>>>25,ri=v[28]<<7|v[29]>>>25,Ii=v[38]<<8|v[39]>>>24,oe=v[39]<<8|v[38]>>>24,hr=v[48]<<14|v[49]>>>18,xt=v[49]<<14|v[48]>>>18,v[0]=te^~Re&kt,v[1]=Dt^~Ft&Ei,v[10]=$t^~jt&Br,v[11]=qr^~zt&Lt,v[20]=_i^~Yt&se,v[21]=ie^~ti&ne,v[30]=ae^~Ur&Vt,v[31]=he^~ce&Pi,v[40]=pe^~de&ei,v[41]=Ci^~Xt&ri,v[2]=Re^~kt&qt,v[3]=Ft^~Ei&ee,v[12]=jt^~Br&Ht,v[13]=zt^~Lt&kr,v[22]=Yt^~se&Ii,v[23]=ti^~ne&oe,v[32]=Ur^~Vt&ue,v[33]=ce^~Pi&le,v[42]=de^~ei&ii,v[43]=Xt^~ri&si,v[4]=kt^~qt&hr,v[5]=Ei^~ee&xt,v[14]=Br^~Ht&Kt,v[15]=Lt^~kr&re,v[24]=se^~Ii&Wt,v[25]=ne^~oe&Si,v[34]=Vt^~ue&Mi,v[35]=Pi^~le&fe,v[44]=ei^~ii&ni,v[45]=ri^~si&oi,v[6]=qt^~hr&te,v[7]=ee^~xt&Dt,v[16]=Ht^~Kt&$t,v[17]=kr^~re&qr,v[26]=Ii^~Wt&_i,v[27]=oe^~Si&ie,v[36]=ue^~Mi&ae,v[37]=le^~fe&he,v[46]=ii^~ni&pe,v[47]=si^~oi&Ci,v[8]=hr^~te&Re,v[9]=xt^~Dt&Ft,v[18]=Kt^~$t&jt,v[19]=re^~qr&zt,v[28]=Wt^~_i&Yt,v[29]=Si^~ie&ti,v[38]=Mi^~ae&Ur,v[39]=fe^~he&ce,v[48]=ni^~pe&de,v[49]=oi^~Ci&Xt,v[0]^=H[L],v[1]^=H[L+1]};if(d)i.exports=f;else for(E=0;E<g.length;++E)o[g[E]]=f[g[E]]})()})(vd);var a2=vd.exports;const h2="logger/5.7.0";let Pf=!1,Mf=!1;const sa={debug:1,default:2,info:2,warning:3,error:4,off:5};let Cf=sa.default,Bh=null;function c2(){try{const i=[];if(["NFD","NFC","NFKD","NFKC"].forEach(t=>{try{if("test".normalize(t)!=="test")throw new Error("bad normalize")}catch{i.push(t)}}),i.length)throw new Error("missing "+i.join(", "));if(String.fromCharCode(233).normalize("NFD")!==String.fromCharCode(101,769))throw new Error("broken implementation")}catch(i){return i.message}return null}const Rf=c2();var pc;(function(i){i.DEBUG="DEBUG",i.INFO="INFO",i.WARNING="WARNING",i.ERROR="ERROR",i.OFF="OFF"})(pc||(pc={}));var Gr;(function(i){i.UNKNOWN_ERROR="UNKNOWN_ERROR",i.NOT_IMPLEMENTED="NOT_IMPLEMENTED",i.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",i.NETWORK_ERROR="NETWORK_ERROR",i.SERVER_ERROR="SERVER_ERROR",i.TIMEOUT="TIMEOUT",i.BUFFER_OVERRUN="BUFFER_OVERRUN",i.NUMERIC_FAULT="NUMERIC_FAULT",i.MISSING_NEW="MISSING_NEW",i.INVALID_ARGUMENT="INVALID_ARGUMENT",i.MISSING_ARGUMENT="MISSING_ARGUMENT",i.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",i.CALL_EXCEPTION="CALL_EXCEPTION",i.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",i.NONCE_EXPIRED="NONCE_EXPIRED",i.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",i.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",i.TRANSACTION_REPLACED="TRANSACTION_REPLACED",i.ACTION_REJECTED="ACTION_REJECTED"})(Gr||(Gr={}));const Nf="0123456789abcdef";let Ue=class Oe{constructor(t){Object.defineProperty(this,"version",{enumerable:!0,value:t,writable:!1})}_log(t,e){const s=t.toLowerCase();sa[s]==null&&this.throwArgumentError("invalid log level name","logLevel",t),!(Cf>sa[s])&&console.log.apply(console,e)}debug(...t){this._log(Oe.levels.DEBUG,t)}info(...t){this._log(Oe.levels.INFO,t)}warn(...t){this._log(Oe.levels.WARNING,t)}makeError(t,e,s){if(Mf)return this.makeError("censored error",e,{});e||(e=Oe.errors.UNKNOWN_ERROR),s||(s={});const o=[];Object.keys(s).forEach(y=>{const b=s[y];try{if(b instanceof Uint8Array){let C="";for(let P=0;P<b.length;P++)C+=Nf[b[P]>>4],C+=Nf[b[P]&15];o.push(y+"=Uint8Array(0x"+C+")")}else o.push(y+"="+JSON.stringify(b))}catch{o.push(y+"="+JSON.stringify(s[y].toString()))}}),o.push(`code=${e}`),o.push(`version=${this.version}`);const a=t;let u="";switch(e){case Gr.NUMERIC_FAULT:{u="NUMERIC_FAULT";const y=t;switch(y){case"overflow":case"underflow":case"division-by-zero":u+="-"+y;break;case"negative-power":case"negative-width":u+="-unsupported";break;case"unbound-bitwise-result":u+="-unbound-result";break}break}case Gr.CALL_EXCEPTION:case Gr.INSUFFICIENT_FUNDS:case Gr.MISSING_NEW:case Gr.NONCE_EXPIRED:case Gr.REPLACEMENT_UNDERPRICED:case Gr.TRANSACTION_REPLACED:case Gr.UNPREDICTABLE_GAS_LIMIT:u=e;break}u&&(t+=" [ See: https://links.ethers.org/v5-errors-"+u+" ]"),o.length&&(t+=" ("+o.join(", ")+")");const d=new Error(t);return d.reason=a,d.code=e,Object.keys(s).forEach(function(y){d[y]=s[y]}),d}throwError(t,e,s){throw this.makeError(t,e,s)}throwArgumentError(t,e,s){return this.throwError(t,Oe.errors.INVALID_ARGUMENT,{argument:e,value:s})}assert(t,e,s,o){t||this.throwError(e,s,o)}assertArgument(t,e,s,o){t||this.throwArgumentError(e,s,o)}checkNormalize(t){Rf&&this.throwError("platform missing String.prototype.normalize",Oe.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:Rf})}checkSafeUint53(t,e){typeof t=="number"&&(e==null&&(e="value not safe"),(t<0||t>=9007199254740991)&&this.throwError(e,Oe.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:t}),t%1&&this.throwError(e,Oe.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:t}))}checkArgumentCount(t,e,s){s?s=": "+s:s="",t<e&&this.throwError("missing argument"+s,Oe.errors.MISSING_ARGUMENT,{count:t,expectedCount:e}),t>e&&this.throwError("too many arguments"+s,Oe.errors.UNEXPECTED_ARGUMENT,{count:t,expectedCount:e})}checkNew(t,e){(t===Object||t==null)&&this.throwError("missing new",Oe.errors.MISSING_NEW,{name:e.name})}checkAbstract(t,e){t===e?this.throwError("cannot instantiate abstract class "+JSON.stringify(e.name)+" directly; use a sub-class",Oe.errors.UNSUPPORTED_OPERATION,{name:t.name,operation:"new"}):(t===Object||t==null)&&this.throwError("missing new",Oe.errors.MISSING_NEW,{name:e.name})}static globalLogger(){return Bh||(Bh=new Oe(h2)),Bh}static setCensorship(t,e){if(!t&&e&&this.globalLogger().throwError("cannot permanently disable censorship",Oe.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),Pf){if(!t)return;this.globalLogger().throwError("error censorship permanent",Oe.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}Mf=!!t,Pf=!!e}static setLogLevel(t){const e=sa[t.toLowerCase()];if(e==null){Oe.globalLogger().warn("invalid log level - "+t);return}Cf=e}static from(t){return new Oe(t)}};Ue.errors=Gr,Ue.levels=pc;const u2="bytes/5.7.0",Me=new Ue(u2);function yd(i){return!!i.toHexString}function sn(i){return i.slice||(i.slice=function(){const t=Array.prototype.slice.call(arguments);return sn(new Uint8Array(Array.prototype.slice.apply(i,t)))}),i}function l2(i){return vr(i)&&!(i.length%2)||un(i)}function xf(i){return typeof i=="number"&&i==i&&i%1===0}function un(i){if(i==null)return!1;if(i.constructor===Uint8Array)return!0;if(typeof i=="string"||!xf(i.length)||i.length<0)return!1;for(let t=0;t<i.length;t++){const e=i[t];if(!xf(e)||e<0||e>=256)return!1}return!0}function Ie(i,t){if(t||(t={}),typeof i=="number"){Me.checkSafeUint53(i,"invalid arrayify value");const e=[];for(;i;)e.unshift(i&255),i=parseInt(String(i/256));return e.length===0&&e.push(0),sn(new Uint8Array(e))}if(t.allowMissingPrefix&&typeof i=="string"&&i.substring(0,2)!=="0x"&&(i="0x"+i),yd(i)&&(i=i.toHexString()),vr(i)){let e=i.substring(2);e.length%2&&(t.hexPad==="left"?e="0"+e:t.hexPad==="right"?e+="0":Me.throwArgumentError("hex data is odd-length","value",i));const s=[];for(let o=0;o<e.length;o+=2)s.push(parseInt(e.substring(o,o+2),16));return sn(new Uint8Array(s))}return un(i)?sn(new Uint8Array(i)):Me.throwArgumentError("invalid arrayify value","value",i)}function f2(i){const t=i.map(o=>Ie(o)),e=t.reduce((o,a)=>o+a.length,0),s=new Uint8Array(e);return t.reduce((o,a)=>(s.set(a,o),o+a.length),0),sn(s)}function p2(i,t){i=Ie(i),i.length>t&&Me.throwArgumentError("value out of range","value",arguments[0]);const e=new Uint8Array(t);return e.set(i,t-i.length),sn(e)}function vr(i,t){return!(typeof i!="string"||!i.match(/^0x[0-9A-Fa-f]*$/)||t&&i.length!==2+2*t)}const kh="0123456789abcdef";function Je(i,t){if(t||(t={}),typeof i=="number"){Me.checkSafeUint53(i,"invalid hexlify value");let e="";for(;i;)e=kh[i&15]+e,i=Math.floor(i/16);return e.length?(e.length%2&&(e="0"+e),"0x"+e):"0x00"}if(typeof i=="bigint")return i=i.toString(16),i.length%2?"0x0"+i:"0x"+i;if(t.allowMissingPrefix&&typeof i=="string"&&i.substring(0,2)!=="0x"&&(i="0x"+i),yd(i))return i.toHexString();if(vr(i))return i.length%2&&(t.hexPad==="left"?i="0x0"+i.substring(2):t.hexPad==="right"?i+="0":Me.throwArgumentError("hex data is odd-length","value",i)),i.toLowerCase();if(un(i)){let e="0x";for(let s=0;s<i.length;s++){let o=i[s];e+=kh[(o&240)>>4]+kh[o&15]}return e}return Me.throwArgumentError("invalid hexlify value","value",i)}function d2(i){if(typeof i!="string")i=Je(i);else if(!vr(i)||i.length%2)return null;return(i.length-2)/2}function Of(i,t,e){return typeof i!="string"?i=Je(i):(!vr(i)||i.length%2)&&Me.throwArgumentError("invalid hexData","value",i),t=2+2*t,e!=null?"0x"+i.substring(t,2+2*e):"0x"+i.substring(t)}function mi(i,t){for(typeof i!="string"?i=Je(i):vr(i)||Me.throwArgumentError("invalid hex string","value",i),i.length>2*t+2&&Me.throwArgumentError("value out of range","value",arguments[1]);i.length<2*t+2;)i="0x0"+i.substring(2);return i}function wd(i){const t={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0,yParityAndS:"0x",compact:"0x"};if(l2(i)){let e=Ie(i);e.length===64?(t.v=27+(e[32]>>7),e[32]&=127,t.r=Je(e.slice(0,32)),t.s=Je(e.slice(32,64))):e.length===65?(t.r=Je(e.slice(0,32)),t.s=Je(e.slice(32,64)),t.v=e[64]):Me.throwArgumentError("invalid signature string","signature",i),t.v<27&&(t.v===0||t.v===1?t.v+=27:Me.throwArgumentError("signature invalid v byte","signature",i)),t.recoveryParam=1-t.v%2,t.recoveryParam&&(e[32]|=128),t._vs=Je(e.slice(32,64))}else{if(t.r=i.r,t.s=i.s,t.v=i.v,t.recoveryParam=i.recoveryParam,t._vs=i._vs,t._vs!=null){const o=p2(Ie(t._vs),32);t._vs=Je(o);const a=o[0]>=128?1:0;t.recoveryParam==null?t.recoveryParam=a:t.recoveryParam!==a&&Me.throwArgumentError("signature recoveryParam mismatch _vs","signature",i),o[0]&=127;const u=Je(o);t.s==null?t.s=u:t.s!==u&&Me.throwArgumentError("signature v mismatch _vs","signature",i)}if(t.recoveryParam==null)t.v==null?Me.throwArgumentError("signature missing v and recoveryParam","signature",i):t.v===0||t.v===1?t.recoveryParam=t.v:t.recoveryParam=1-t.v%2;else if(t.v==null)t.v=27+t.recoveryParam;else{const o=t.v===0||t.v===1?t.v:1-t.v%2;t.recoveryParam!==o&&Me.throwArgumentError("signature recoveryParam mismatch v","signature",i)}t.r==null||!vr(t.r)?Me.throwArgumentError("signature missing or invalid r","signature",i):t.r=mi(t.r,32),t.s==null||!vr(t.s)?Me.throwArgumentError("signature missing or invalid s","signature",i):t.s=mi(t.s,32);const e=Ie(t.s);e[0]>=128&&Me.throwArgumentError("signature s out of range","signature",i),t.recoveryParam&&(e[0]|=128);const s=Je(e);t._vs&&(vr(t._vs)||Me.throwArgumentError("signature invalid _vs","signature",i),t._vs=mi(t._vs,32)),t._vs==null?t._vs=s:t._vs!==s&&Me.throwArgumentError("signature _vs mismatch v and s","signature",i)}return t.yParityAndS=t._vs,t.compact=t.r+t.yParityAndS.substring(2),t}function Fc(i){return"0x"+a2.keccak_256(Ie(i))}var bd={exports:{}},g2={},m2=Object.freeze({__proto__:null,default:g2}),v2=o2(m2);(function(i){(function(t,e){function s(c,f){if(!c)throw new Error(f||"Assertion failed")}function o(c,f){c.super_=f;var g=function(){};g.prototype=f.prototype,c.prototype=new g,c.prototype.constructor=c}function a(c,f,g){if(a.isBN(c))return c;this.negative=0,this.words=null,this.length=0,this.red=null,c!==null&&((f==="le"||f==="be")&&(g=f,f=10),this._init(c||0,f||10,g||"be"))}typeof t=="object"?t.exports=a:e.BN=a,a.BN=a,a.wordSize=26;var u;try{typeof window<"u"&&typeof window.Buffer<"u"?u=window.Buffer:u=v2.Buffer}catch{}a.isBN=function(c){return c instanceof a?!0:c!==null&&typeof c=="object"&&c.constructor.wordSize===a.wordSize&&Array.isArray(c.words)},a.max=function(c,f){return c.cmp(f)>0?c:f},a.min=function(c,f){return c.cmp(f)<0?c:f},a.prototype._init=function(c,f,g){if(typeof c=="number")return this._initNumber(c,f,g);if(typeof c=="object")return this._initArray(c,f,g);f==="hex"&&(f=16),s(f===(f|0)&&f>=2&&f<=36),c=c.toString().replace(/\s+/g,"");var E=0;c[0]==="-"&&(E++,this.negative=1),E<c.length&&(f===16?this._parseHex(c,E,g):(this._parseBase(c,f,E),g==="le"&&this._initArray(this.toArray(),f,g)))},a.prototype._initNumber=function(c,f,g){c<0&&(this.negative=1,c=-c),c<67108864?(this.words=[c&67108863],this.length=1):c<4503599627370496?(this.words=[c&67108863,c/67108864&67108863],this.length=2):(s(c<9007199254740992),this.words=[c&67108863,c/67108864&67108863,1],this.length=3),g==="le"&&this._initArray(this.toArray(),f,g)},a.prototype._initArray=function(c,f,g){if(s(typeof c.length=="number"),c.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(c.length/3),this.words=new Array(this.length);for(var E=0;E<this.length;E++)this.words[E]=0;var S,R,x=0;if(g==="be")for(E=c.length-1,S=0;E>=0;E-=3)R=c[E]|c[E-1]<<8|c[E-2]<<16,this.words[S]|=R<<x&67108863,this.words[S+1]=R>>>26-x&67108863,x+=24,x>=26&&(x-=26,S++);else if(g==="le")for(E=0,S=0;E<c.length;E+=3)R=c[E]|c[E+1]<<8|c[E+2]<<16,this.words[S]|=R<<x&67108863,this.words[S+1]=R>>>26-x&67108863,x+=24,x>=26&&(x-=26,S++);return this._strip()};function d(c,f){var g=c.charCodeAt(f);if(g>=48&&g<=57)return g-48;if(g>=65&&g<=70)return g-55;if(g>=97&&g<=102)return g-87;s(!1,"Invalid character in "+c)}function y(c,f,g){var E=d(c,g);return g-1>=f&&(E|=d(c,g-1)<<4),E}a.prototype._parseHex=function(c,f,g){this.length=Math.ceil((c.length-f)/6),this.words=new Array(this.length);for(var E=0;E<this.length;E++)this.words[E]=0;var S=0,R=0,x;if(g==="be")for(E=c.length-1;E>=f;E-=2)x=y(c,f,E)<<S,this.words[R]|=x&67108863,S>=18?(S-=18,R+=1,this.words[R]|=x>>>26):S+=8;else{var I=c.length-f;for(E=I%2===0?f+1:f;E<c.length;E+=2)x=y(c,f,E)<<S,this.words[R]|=x&67108863,S>=18?(S-=18,R+=1,this.words[R]|=x>>>26):S+=8}this._strip()};function b(c,f,g,E){for(var S=0,R=0,x=Math.min(c.length,g),I=f;I<x;I++){var p=c.charCodeAt(I)-48;S*=E,p>=49?R=p-49+10:p>=17?R=p-17+10:R=p,s(p>=0&&R<E,"Invalid character"),S+=R}return S}a.prototype._parseBase=function(c,f,g){this.words=[0],this.length=1;for(var E=0,S=1;S<=67108863;S*=f)E++;E--,S=S/f|0;for(var R=c.length-g,x=R%E,I=Math.min(R,R-x)+g,p=0,_=g;_<I;_+=E)p=b(c,_,_+E,f),this.imuln(S),this.words[0]+p<67108864?this.words[0]+=p:this._iaddn(p);if(x!==0){var lt=1;for(p=b(c,_,c.length,f),_=0;_<x;_++)lt*=f;this.imuln(lt),this.words[0]+p<67108864?this.words[0]+=p:this._iaddn(p)}this._strip()},a.prototype.copy=function(c){c.words=new Array(this.length);for(var f=0;f<this.length;f++)c.words[f]=this.words[f];c.length=this.length,c.negative=this.negative,c.red=this.red};function C(c,f){c.words=f.words,c.length=f.length,c.negative=f.negative,c.red=f.red}if(a.prototype._move=function(c){C(c,this)},a.prototype.clone=function(){var c=new a(null);return this.copy(c),c},a.prototype._expand=function(c){for(;this.length<c;)this.words[this.length++]=0;return this},a.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},a.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{a.prototype[Symbol.for("nodejs.util.inspect.custom")]=P}catch{a.prototype.inspect=P}else a.prototype.inspect=P;function P(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var O=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],F=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],q=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];a.prototype.toString=function(c,f){c=c||10,f=f|0||1;var g;if(c===16||c==="hex"){g="";for(var E=0,S=0,R=0;R<this.length;R++){var x=this.words[R],I=((x<<E|S)&16777215).toString(16);S=x>>>24-E&16777215,E+=2,E>=26&&(E-=26,R--),S!==0||R!==this.length-1?g=O[6-I.length]+I+g:g=I+g}for(S!==0&&(g=S.toString(16)+g);g.length%f!==0;)g="0"+g;return this.negative!==0&&(g="-"+g),g}if(c===(c|0)&&c>=2&&c<=36){var p=F[c],_=q[c];g="";var lt=this.clone();for(lt.negative=0;!lt.isZero();){var st=lt.modrn(_).toString(c);lt=lt.idivn(_),lt.isZero()?g=st+g:g=O[p-st.length]+st+g}for(this.isZero()&&(g="0"+g);g.length%f!==0;)g="0"+g;return this.negative!==0&&(g="-"+g),g}s(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var c=this.words[0];return this.length===2?c+=this.words[1]*67108864:this.length===3&&this.words[2]===1?c+=4503599627370496+this.words[1]*67108864:this.length>2&&s(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-c:c},a.prototype.toJSON=function(){return this.toString(16,2)},u&&(a.prototype.toBuffer=function(c,f){return this.toArrayLike(u,c,f)}),a.prototype.toArray=function(c,f){return this.toArrayLike(Array,c,f)};var H=function(c,f){return c.allocUnsafe?c.allocUnsafe(f):new c(f)};a.prototype.toArrayLike=function(c,f,g){this._strip();var E=this.byteLength(),S=g||Math.max(1,E);s(E<=S,"byte array longer than desired length"),s(S>0,"Requested array length <= 0");var R=H(c,S),x=f==="le"?"LE":"BE";return this["_toArrayLike"+x](R,E),R},a.prototype._toArrayLikeLE=function(c,f){for(var g=0,E=0,S=0,R=0;S<this.length;S++){var x=this.words[S]<<R|E;c[g++]=x&255,g<c.length&&(c[g++]=x>>8&255),g<c.length&&(c[g++]=x>>16&255),R===6?(g<c.length&&(c[g++]=x>>24&255),E=0,R=0):(E=x>>>24,R+=2)}if(g<c.length)for(c[g++]=E;g<c.length;)c[g++]=0},a.prototype._toArrayLikeBE=function(c,f){for(var g=c.length-1,E=0,S=0,R=0;S<this.length;S++){var x=this.words[S]<<R|E;c[g--]=x&255,g>=0&&(c[g--]=x>>8&255),g>=0&&(c[g--]=x>>16&255),R===6?(g>=0&&(c[g--]=x>>24&255),E=0,R=0):(E=x>>>24,R+=2)}if(g>=0)for(c[g--]=E;g>=0;)c[g--]=0},Math.clz32?a.prototype._countBits=function(c){return 32-Math.clz32(c)}:a.prototype._countBits=function(c){var f=c,g=0;return f>=4096&&(g+=13,f>>>=13),f>=64&&(g+=7,f>>>=7),f>=8&&(g+=4,f>>>=4),f>=2&&(g+=2,f>>>=2),g+f},a.prototype._zeroBits=function(c){if(c===0)return 26;var f=c,g=0;return f&8191||(g+=13,f>>>=13),f&127||(g+=7,f>>>=7),f&15||(g+=4,f>>>=4),f&3||(g+=2,f>>>=2),f&1||g++,g},a.prototype.bitLength=function(){var c=this.words[this.length-1],f=this._countBits(c);return(this.length-1)*26+f};function V(c){for(var f=new Array(c.bitLength()),g=0;g<f.length;g++){var E=g/26|0,S=g%26;f[g]=c.words[E]>>>S&1}return f}a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var c=0,f=0;f<this.length;f++){var g=this._zeroBits(this.words[f]);if(c+=g,g!==26)break}return c},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(c){return this.negative!==0?this.abs().inotn(c).iaddn(1):this.clone()},a.prototype.fromTwos=function(c){return this.testn(c-1)?this.notn(c).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return this.negative!==0},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(c){for(;this.length<c.length;)this.words[this.length++]=0;for(var f=0;f<c.length;f++)this.words[f]=this.words[f]|c.words[f];return this._strip()},a.prototype.ior=function(c){return s((this.negative|c.negative)===0),this.iuor(c)},a.prototype.or=function(c){return this.length>c.length?this.clone().ior(c):c.clone().ior(this)},a.prototype.uor=function(c){return this.length>c.length?this.clone().iuor(c):c.clone().iuor(this)},a.prototype.iuand=function(c){var f;this.length>c.length?f=c:f=this;for(var g=0;g<f.length;g++)this.words[g]=this.words[g]&c.words[g];return this.length=f.length,this._strip()},a.prototype.iand=function(c){return s((this.negative|c.negative)===0),this.iuand(c)},a.prototype.and=function(c){return this.length>c.length?this.clone().iand(c):c.clone().iand(this)},a.prototype.uand=function(c){return this.length>c.length?this.clone().iuand(c):c.clone().iuand(this)},a.prototype.iuxor=function(c){var f,g;this.length>c.length?(f=this,g=c):(f=c,g=this);for(var E=0;E<g.length;E++)this.words[E]=f.words[E]^g.words[E];if(this!==f)for(;E<f.length;E++)this.words[E]=f.words[E];return this.length=f.length,this._strip()},a.prototype.ixor=function(c){return s((this.negative|c.negative)===0),this.iuxor(c)},a.prototype.xor=function(c){return this.length>c.length?this.clone().ixor(c):c.clone().ixor(this)},a.prototype.uxor=function(c){return this.length>c.length?this.clone().iuxor(c):c.clone().iuxor(this)},a.prototype.inotn=function(c){s(typeof c=="number"&&c>=0);var f=Math.ceil(c/26)|0,g=c%26;this._expand(f),g>0&&f--;for(var E=0;E<f;E++)this.words[E]=~this.words[E]&67108863;return g>0&&(this.words[E]=~this.words[E]&67108863>>26-g),this._strip()},a.prototype.notn=function(c){return this.clone().inotn(c)},a.prototype.setn=function(c,f){s(typeof c=="number"&&c>=0);var g=c/26|0,E=c%26;return this._expand(g+1),f?this.words[g]=this.words[g]|1<<E:this.words[g]=this.words[g]&~(1<<E),this._strip()},a.prototype.iadd=function(c){var f;if(this.negative!==0&&c.negative===0)return this.negative=0,f=this.isub(c),this.negative^=1,this._normSign();if(this.negative===0&&c.negative!==0)return c.negative=0,f=this.isub(c),c.negative=1,f._normSign();var g,E;this.length>c.length?(g=this,E=c):(g=c,E=this);for(var S=0,R=0;R<E.length;R++)f=(g.words[R]|0)+(E.words[R]|0)+S,this.words[R]=f&67108863,S=f>>>26;for(;S!==0&&R<g.length;R++)f=(g.words[R]|0)+S,this.words[R]=f&67108863,S=f>>>26;if(this.length=g.length,S!==0)this.words[this.length]=S,this.length++;else if(g!==this)for(;R<g.length;R++)this.words[R]=g.words[R];return this},a.prototype.add=function(c){var f;return c.negative!==0&&this.negative===0?(c.negative=0,f=this.sub(c),c.negative^=1,f):c.negative===0&&this.negative!==0?(this.negative=0,f=c.sub(this),this.negative=1,f):this.length>c.length?this.clone().iadd(c):c.clone().iadd(this)},a.prototype.isub=function(c){if(c.negative!==0){c.negative=0;var f=this.iadd(c);return c.negative=1,f._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(c),this.negative=1,this._normSign();var g=this.cmp(c);if(g===0)return this.negative=0,this.length=1,this.words[0]=0,this;var E,S;g>0?(E=this,S=c):(E=c,S=this);for(var R=0,x=0;x<S.length;x++)f=(E.words[x]|0)-(S.words[x]|0)+R,R=f>>26,this.words[x]=f&67108863;for(;R!==0&&x<E.length;x++)f=(E.words[x]|0)+R,R=f>>26,this.words[x]=f&67108863;if(R===0&&x<E.length&&E!==this)for(;x<E.length;x++)this.words[x]=E.words[x];return this.length=Math.max(this.length,x),E!==this&&(this.negative=1),this._strip()},a.prototype.sub=function(c){return this.clone().isub(c)};function Y(c,f,g){g.negative=f.negative^c.negative;var E=c.length+f.length|0;g.length=E,E=E-1|0;var S=c.words[0]|0,R=f.words[0]|0,x=S*R,I=x&67108863,p=x/67108864|0;g.words[0]=I;for(var _=1;_<E;_++){for(var lt=p>>>26,st=p&67108863,v=Math.min(_,f.length-1),$=Math.max(0,_-c.length+1);$<=v;$++){var k=_-$|0;S=c.words[k]|0,R=f.words[$]|0,x=S*R+st,lt+=x/67108864|0,st=x&67108863}g.words[_]=st|0,p=lt|0}return p!==0?g.words[_]=p|0:g.length--,g._strip()}var ct=function(c,f,g){var E=c.words,S=f.words,R=g.words,x=0,I,p,_,lt=E[0]|0,st=lt&8191,v=lt>>>13,$=E[1]|0,k=$&8191,L=$>>>13,Z=E[2]|0,W=Z&8191,X=Z>>>13,ot=E[3]|0,mt=ot&8191,G=ot>>>13,Tt=E[4]|0,Zt=Tt&8191,Rt=Tt>>>13,Zr=E[5]|0,te=Zr&8191,Dt=Zr>>>13,Re=E[6]|0,Ft=Re&8191,kt=Re>>>13,Ei=E[7]|0,qt=Ei&8191,ee=Ei>>>13,hr=E[8]|0,xt=hr&8191,$t=hr>>>13,qr=E[9]|0,jt=qr&8191,zt=qr>>>13,Br=S[0]|0,Lt=Br&8191,Ht=Br>>>13,kr=S[1]|0,Kt=kr&8191,re=kr>>>13,_i=S[2]|0,ie=_i&8191,Yt=_i>>>13,ti=S[3]|0,se=ti&8191,ne=ti>>>13,Ii=S[4]|0,oe=Ii&8191,Wt=Ii>>>13,Si=S[5]|0,ae=Si&8191,he=Si>>>13,Ur=S[6]|0,ce=Ur&8191,Vt=Ur>>>13,Pi=S[7]|0,ue=Pi&8191,le=Pi>>>13,Mi=S[8]|0,fe=Mi&8191,pe=Mi>>>13,Ci=S[9]|0,de=Ci&8191,Xt=Ci>>>13;g.negative=c.negative^f.negative,g.length=19,I=Math.imul(st,Lt),p=Math.imul(st,Ht),p=p+Math.imul(v,Lt)|0,_=Math.imul(v,Ht);var ei=(x+I|0)+((p&8191)<<13)|0;x=(_+(p>>>13)|0)+(ei>>>26)|0,ei&=67108863,I=Math.imul(k,Lt),p=Math.imul(k,Ht),p=p+Math.imul(L,Lt)|0,_=Math.imul(L,Ht),I=I+Math.imul(st,Kt)|0,p=p+Math.imul(st,re)|0,p=p+Math.imul(v,Kt)|0,_=_+Math.imul(v,re)|0;var ri=(x+I|0)+((p&8191)<<13)|0;x=(_+(p>>>13)|0)+(ri>>>26)|0,ri&=67108863,I=Math.imul(W,Lt),p=Math.imul(W,Ht),p=p+Math.imul(X,Lt)|0,_=Math.imul(X,Ht),I=I+Math.imul(k,Kt)|0,p=p+Math.imul(k,re)|0,p=p+Math.imul(L,Kt)|0,_=_+Math.imul(L,re)|0,I=I+Math.imul(st,ie)|0,p=p+Math.imul(st,Yt)|0,p=p+Math.imul(v,ie)|0,_=_+Math.imul(v,Yt)|0;var ii=(x+I|0)+((p&8191)<<13)|0;x=(_+(p>>>13)|0)+(ii>>>26)|0,ii&=67108863,I=Math.imul(mt,Lt),p=Math.imul(mt,Ht),p=p+Math.imul(G,Lt)|0,_=Math.imul(G,Ht),I=I+Math.imul(W,Kt)|0,p=p+Math.imul(W,re)|0,p=p+Math.imul(X,Kt)|0,_=_+Math.imul(X,re)|0,I=I+Math.imul(k,ie)|0,p=p+Math.imul(k,Yt)|0,p=p+Math.imul(L,ie)|0,_=_+Math.imul(L,Yt)|0,I=I+Math.imul(st,se)|0,p=p+Math.imul(st,ne)|0,p=p+Math.imul(v,se)|0,_=_+Math.imul(v,ne)|0;var si=(x+I|0)+((p&8191)<<13)|0;x=(_+(p>>>13)|0)+(si>>>26)|0,si&=67108863,I=Math.imul(Zt,Lt),p=Math.imul(Zt,Ht),p=p+Math.imul(Rt,Lt)|0,_=Math.imul(Rt,Ht),I=I+Math.imul(mt,Kt)|0,p=p+Math.imul(mt,re)|0,p=p+Math.imul(G,Kt)|0,_=_+Math.imul(G,re)|0,I=I+Math.imul(W,ie)|0,p=p+Math.imul(W,Yt)|0,p=p+Math.imul(X,ie)|0,_=_+Math.imul(X,Yt)|0,I=I+Math.imul(k,se)|0,p=p+Math.imul(k,ne)|0,p=p+Math.imul(L,se)|0,_=_+Math.imul(L,ne)|0,I=I+Math.imul(st,oe)|0,p=p+Math.imul(st,Wt)|0,p=p+Math.imul(v,oe)|0,_=_+Math.imul(v,Wt)|0;var ni=(x+I|0)+((p&8191)<<13)|0;x=(_+(p>>>13)|0)+(ni>>>26)|0,ni&=67108863,I=Math.imul(te,Lt),p=Math.imul(te,Ht),p=p+Math.imul(Dt,Lt)|0,_=Math.imul(Dt,Ht),I=I+Math.imul(Zt,Kt)|0,p=p+Math.imul(Zt,re)|0,p=p+Math.imul(Rt,Kt)|0,_=_+Math.imul(Rt,re)|0,I=I+Math.imul(mt,ie)|0,p=p+Math.imul(mt,Yt)|0,p=p+Math.imul(G,ie)|0,_=_+Math.imul(G,Yt)|0,I=I+Math.imul(W,se)|0,p=p+Math.imul(W,ne)|0,p=p+Math.imul(X,se)|0,_=_+Math.imul(X,ne)|0,I=I+Math.imul(k,oe)|0,p=p+Math.imul(k,Wt)|0,p=p+Math.imul(L,oe)|0,_=_+Math.imul(L,Wt)|0,I=I+Math.imul(st,ae)|0,p=p+Math.imul(st,he)|0,p=p+Math.imul(v,ae)|0,_=_+Math.imul(v,he)|0;var oi=(x+I|0)+((p&8191)<<13)|0;x=(_+(p>>>13)|0)+(oi>>>26)|0,oi&=67108863,I=Math.imul(Ft,Lt),p=Math.imul(Ft,Ht),p=p+Math.imul(kt,Lt)|0,_=Math.imul(kt,Ht),I=I+Math.imul(te,Kt)|0,p=p+Math.imul(te,re)|0,p=p+Math.imul(Dt,Kt)|0,_=_+Math.imul(Dt,re)|0,I=I+Math.imul(Zt,ie)|0,p=p+Math.imul(Zt,Yt)|0,p=p+Math.imul(Rt,ie)|0,_=_+Math.imul(Rt,Yt)|0,I=I+Math.imul(mt,se)|0,p=p+Math.imul(mt,ne)|0,p=p+Math.imul(G,se)|0,_=_+Math.imul(G,ne)|0,I=I+Math.imul(W,oe)|0,p=p+Math.imul(W,Wt)|0,p=p+Math.imul(X,oe)|0,_=_+Math.imul(X,Wt)|0,I=I+Math.imul(k,ae)|0,p=p+Math.imul(k,he)|0,p=p+Math.imul(L,ae)|0,_=_+Math.imul(L,he)|0,I=I+Math.imul(st,ce)|0,p=p+Math.imul(st,Vt)|0,p=p+Math.imul(v,ce)|0,_=_+Math.imul(v,Vt)|0;var Vi=(x+I|0)+((p&8191)<<13)|0;x=(_+(p>>>13)|0)+(Vi>>>26)|0,Vi&=67108863,I=Math.imul(qt,Lt),p=Math.imul(qt,Ht),p=p+Math.imul(ee,Lt)|0,_=Math.imul(ee,Ht),I=I+Math.imul(Ft,Kt)|0,p=p+Math.imul(Ft,re)|0,p=p+Math.imul(kt,Kt)|0,_=_+Math.imul(kt,re)|0,I=I+Math.imul(te,ie)|0,p=p+Math.imul(te,Yt)|0,p=p+Math.imul(Dt,ie)|0,_=_+Math.imul(Dt,Yt)|0,I=I+Math.imul(Zt,se)|0,p=p+Math.imul(Zt,ne)|0,p=p+Math.imul(Rt,se)|0,_=_+Math.imul(Rt,ne)|0,I=I+Math.imul(mt,oe)|0,p=p+Math.imul(mt,Wt)|0,p=p+Math.imul(G,oe)|0,_=_+Math.imul(G,Wt)|0,I=I+Math.imul(W,ae)|0,p=p+Math.imul(W,he)|0,p=p+Math.imul(X,ae)|0,_=_+Math.imul(X,he)|0,I=I+Math.imul(k,ce)|0,p=p+Math.imul(k,Vt)|0,p=p+Math.imul(L,ce)|0,_=_+Math.imul(L,Vt)|0,I=I+Math.imul(st,ue)|0,p=p+Math.imul(st,le)|0,p=p+Math.imul(v,ue)|0,_=_+Math.imul(v,le)|0;var mn=(x+I|0)+((p&8191)<<13)|0;x=(_+(p>>>13)|0)+(mn>>>26)|0,mn&=67108863,I=Math.imul(xt,Lt),p=Math.imul(xt,Ht),p=p+Math.imul($t,Lt)|0,_=Math.imul($t,Ht),I=I+Math.imul(qt,Kt)|0,p=p+Math.imul(qt,re)|0,p=p+Math.imul(ee,Kt)|0,_=_+Math.imul(ee,re)|0,I=I+Math.imul(Ft,ie)|0,p=p+Math.imul(Ft,Yt)|0,p=p+Math.imul(kt,ie)|0,_=_+Math.imul(kt,Yt)|0,I=I+Math.imul(te,se)|0,p=p+Math.imul(te,ne)|0,p=p+Math.imul(Dt,se)|0,_=_+Math.imul(Dt,ne)|0,I=I+Math.imul(Zt,oe)|0,p=p+Math.imul(Zt,Wt)|0,p=p+Math.imul(Rt,oe)|0,_=_+Math.imul(Rt,Wt)|0,I=I+Math.imul(mt,ae)|0,p=p+Math.imul(mt,he)|0,p=p+Math.imul(G,ae)|0,_=_+Math.imul(G,he)|0,I=I+Math.imul(W,ce)|0,p=p+Math.imul(W,Vt)|0,p=p+Math.imul(X,ce)|0,_=_+Math.imul(X,Vt)|0,I=I+Math.imul(k,ue)|0,p=p+Math.imul(k,le)|0,p=p+Math.imul(L,ue)|0,_=_+Math.imul(L,le)|0,I=I+Math.imul(st,fe)|0,p=p+Math.imul(st,pe)|0,p=p+Math.imul(v,fe)|0,_=_+Math.imul(v,pe)|0;var Qi=(x+I|0)+((p&8191)<<13)|0;x=(_+(p>>>13)|0)+(Qi>>>26)|0,Qi&=67108863,I=Math.imul(jt,Lt),p=Math.imul(jt,Ht),p=p+Math.imul(zt,Lt)|0,_=Math.imul(zt,Ht),I=I+Math.imul(xt,Kt)|0,p=p+Math.imul(xt,re)|0,p=p+Math.imul($t,Kt)|0,_=_+Math.imul($t,re)|0,I=I+Math.imul(qt,ie)|0,p=p+Math.imul(qt,Yt)|0,p=p+Math.imul(ee,ie)|0,_=_+Math.imul(ee,Yt)|0,I=I+Math.imul(Ft,se)|0,p=p+Math.imul(Ft,ne)|0,p=p+Math.imul(kt,se)|0,_=_+Math.imul(kt,ne)|0,I=I+Math.imul(te,oe)|0,p=p+Math.imul(te,Wt)|0,p=p+Math.imul(Dt,oe)|0,_=_+Math.imul(Dt,Wt)|0,I=I+Math.imul(Zt,ae)|0,p=p+Math.imul(Zt,he)|0,p=p+Math.imul(Rt,ae)|0,_=_+Math.imul(Rt,he)|0,I=I+Math.imul(mt,ce)|0,p=p+Math.imul(mt,Vt)|0,p=p+Math.imul(G,ce)|0,_=_+Math.imul(G,Vt)|0,I=I+Math.imul(W,ue)|0,p=p+Math.imul(W,le)|0,p=p+Math.imul(X,ue)|0,_=_+Math.imul(X,le)|0,I=I+Math.imul(k,fe)|0,p=p+Math.imul(k,pe)|0,p=p+Math.imul(L,fe)|0,_=_+Math.imul(L,pe)|0,I=I+Math.imul(st,de)|0,p=p+Math.imul(st,Xt)|0,p=p+Math.imul(v,de)|0,_=_+Math.imul(v,Xt)|0;var vn=(x+I|0)+((p&8191)<<13)|0;x=(_+(p>>>13)|0)+(vn>>>26)|0,vn&=67108863,I=Math.imul(jt,Kt),p=Math.imul(jt,re),p=p+Math.imul(zt,Kt)|0,_=Math.imul(zt,re),I=I+Math.imul(xt,ie)|0,p=p+Math.imul(xt,Yt)|0,p=p+Math.imul($t,ie)|0,_=_+Math.imul($t,Yt)|0,I=I+Math.imul(qt,se)|0,p=p+Math.imul(qt,ne)|0,p=p+Math.imul(ee,se)|0,_=_+Math.imul(ee,ne)|0,I=I+Math.imul(Ft,oe)|0,p=p+Math.imul(Ft,Wt)|0,p=p+Math.imul(kt,oe)|0,_=_+Math.imul(kt,Wt)|0,I=I+Math.imul(te,ae)|0,p=p+Math.imul(te,he)|0,p=p+Math.imul(Dt,ae)|0,_=_+Math.imul(Dt,he)|0,I=I+Math.imul(Zt,ce)|0,p=p+Math.imul(Zt,Vt)|0,p=p+Math.imul(Rt,ce)|0,_=_+Math.imul(Rt,Vt)|0,I=I+Math.imul(mt,ue)|0,p=p+Math.imul(mt,le)|0,p=p+Math.imul(G,ue)|0,_=_+Math.imul(G,le)|0,I=I+Math.imul(W,fe)|0,p=p+Math.imul(W,pe)|0,p=p+Math.imul(X,fe)|0,_=_+Math.imul(X,pe)|0,I=I+Math.imul(k,de)|0,p=p+Math.imul(k,Xt)|0,p=p+Math.imul(L,de)|0,_=_+Math.imul(L,Xt)|0;var yn=(x+I|0)+((p&8191)<<13)|0;x=(_+(p>>>13)|0)+(yn>>>26)|0,yn&=67108863,I=Math.imul(jt,ie),p=Math.imul(jt,Yt),p=p+Math.imul(zt,ie)|0,_=Math.imul(zt,Yt),I=I+Math.imul(xt,se)|0,p=p+Math.imul(xt,ne)|0,p=p+Math.imul($t,se)|0,_=_+Math.imul($t,ne)|0,I=I+Math.imul(qt,oe)|0,p=p+Math.imul(qt,Wt)|0,p=p+Math.imul(ee,oe)|0,_=_+Math.imul(ee,Wt)|0,I=I+Math.imul(Ft,ae)|0,p=p+Math.imul(Ft,he)|0,p=p+Math.imul(kt,ae)|0,_=_+Math.imul(kt,he)|0,I=I+Math.imul(te,ce)|0,p=p+Math.imul(te,Vt)|0,p=p+Math.imul(Dt,ce)|0,_=_+Math.imul(Dt,Vt)|0,I=I+Math.imul(Zt,ue)|0,p=p+Math.imul(Zt,le)|0,p=p+Math.imul(Rt,ue)|0,_=_+Math.imul(Rt,le)|0,I=I+Math.imul(mt,fe)|0,p=p+Math.imul(mt,pe)|0,p=p+Math.imul(G,fe)|0,_=_+Math.imul(G,pe)|0,I=I+Math.imul(W,de)|0,p=p+Math.imul(W,Xt)|0,p=p+Math.imul(X,de)|0,_=_+Math.imul(X,Xt)|0;var wn=(x+I|0)+((p&8191)<<13)|0;x=(_+(p>>>13)|0)+(wn>>>26)|0,wn&=67108863,I=Math.imul(jt,se),p=Math.imul(jt,ne),p=p+Math.imul(zt,se)|0,_=Math.imul(zt,ne),I=I+Math.imul(xt,oe)|0,p=p+Math.imul(xt,Wt)|0,p=p+Math.imul($t,oe)|0,_=_+Math.imul($t,Wt)|0,I=I+Math.imul(qt,ae)|0,p=p+Math.imul(qt,he)|0,p=p+Math.imul(ee,ae)|0,_=_+Math.imul(ee,he)|0,I=I+Math.imul(Ft,ce)|0,p=p+Math.imul(Ft,Vt)|0,p=p+Math.imul(kt,ce)|0,_=_+Math.imul(kt,Vt)|0,I=I+Math.imul(te,ue)|0,p=p+Math.imul(te,le)|0,p=p+Math.imul(Dt,ue)|0,_=_+Math.imul(Dt,le)|0,I=I+Math.imul(Zt,fe)|0,p=p+Math.imul(Zt,pe)|0,p=p+Math.imul(Rt,fe)|0,_=_+Math.imul(Rt,pe)|0,I=I+Math.imul(mt,de)|0,p=p+Math.imul(mt,Xt)|0,p=p+Math.imul(G,de)|0,_=_+Math.imul(G,Xt)|0;var xs=(x+I|0)+((p&8191)<<13)|0;x=(_+(p>>>13)|0)+(xs>>>26)|0,xs&=67108863,I=Math.imul(jt,oe),p=Math.imul(jt,Wt),p=p+Math.imul(zt,oe)|0,_=Math.imul(zt,Wt),I=I+Math.imul(xt,ae)|0,p=p+Math.imul(xt,he)|0,p=p+Math.imul($t,ae)|0,_=_+Math.imul($t,he)|0,I=I+Math.imul(qt,ce)|0,p=p+Math.imul(qt,Vt)|0,p=p+Math.imul(ee,ce)|0,_=_+Math.imul(ee,Vt)|0,I=I+Math.imul(Ft,ue)|0,p=p+Math.imul(Ft,le)|0,p=p+Math.imul(kt,ue)|0,_=_+Math.imul(kt,le)|0,I=I+Math.imul(te,fe)|0,p=p+Math.imul(te,pe)|0,p=p+Math.imul(Dt,fe)|0,_=_+Math.imul(Dt,pe)|0,I=I+Math.imul(Zt,de)|0,p=p+Math.imul(Zt,Xt)|0,p=p+Math.imul(Rt,de)|0,_=_+Math.imul(Rt,Xt)|0;var Os=(x+I|0)+((p&8191)<<13)|0;x=(_+(p>>>13)|0)+(Os>>>26)|0,Os&=67108863,I=Math.imul(jt,ae),p=Math.imul(jt,he),p=p+Math.imul(zt,ae)|0,_=Math.imul(zt,he),I=I+Math.imul(xt,ce)|0,p=p+Math.imul(xt,Vt)|0,p=p+Math.imul($t,ce)|0,_=_+Math.imul($t,Vt)|0,I=I+Math.imul(qt,ue)|0,p=p+Math.imul(qt,le)|0,p=p+Math.imul(ee,ue)|0,_=_+Math.imul(ee,le)|0,I=I+Math.imul(Ft,fe)|0,p=p+Math.imul(Ft,pe)|0,p=p+Math.imul(kt,fe)|0,_=_+Math.imul(kt,pe)|0,I=I+Math.imul(te,de)|0,p=p+Math.imul(te,Xt)|0,p=p+Math.imul(Dt,de)|0,_=_+Math.imul(Dt,Xt)|0;var Ts=(x+I|0)+((p&8191)<<13)|0;x=(_+(p>>>13)|0)+(Ts>>>26)|0,Ts&=67108863,I=Math.imul(jt,ce),p=Math.imul(jt,Vt),p=p+Math.imul(zt,ce)|0,_=Math.imul(zt,Vt),I=I+Math.imul(xt,ue)|0,p=p+Math.imul(xt,le)|0,p=p+Math.imul($t,ue)|0,_=_+Math.imul($t,le)|0,I=I+Math.imul(qt,fe)|0,p=p+Math.imul(qt,pe)|0,p=p+Math.imul(ee,fe)|0,_=_+Math.imul(ee,pe)|0,I=I+Math.imul(Ft,de)|0,p=p+Math.imul(Ft,Xt)|0,p=p+Math.imul(kt,de)|0,_=_+Math.imul(kt,Xt)|0;var bn=(x+I|0)+((p&8191)<<13)|0;x=(_+(p>>>13)|0)+(bn>>>26)|0,bn&=67108863,I=Math.imul(jt,ue),p=Math.imul(jt,le),p=p+Math.imul(zt,ue)|0,_=Math.imul(zt,le),I=I+Math.imul(xt,fe)|0,p=p+Math.imul(xt,pe)|0,p=p+Math.imul($t,fe)|0,_=_+Math.imul($t,pe)|0,I=I+Math.imul(qt,de)|0,p=p+Math.imul(qt,Xt)|0,p=p+Math.imul(ee,de)|0,_=_+Math.imul(ee,Xt)|0;var An=(x+I|0)+((p&8191)<<13)|0;x=(_+(p>>>13)|0)+(An>>>26)|0,An&=67108863,I=Math.imul(jt,fe),p=Math.imul(jt,pe),p=p+Math.imul(zt,fe)|0,_=Math.imul(zt,pe),I=I+Math.imul(xt,de)|0,p=p+Math.imul(xt,Xt)|0,p=p+Math.imul($t,de)|0,_=_+Math.imul($t,Xt)|0;var En=(x+I|0)+((p&8191)<<13)|0;x=(_+(p>>>13)|0)+(En>>>26)|0,En&=67108863,I=Math.imul(jt,de),p=Math.imul(jt,Xt),p=p+Math.imul(zt,de)|0,_=Math.imul(zt,Xt);var _n=(x+I|0)+((p&8191)<<13)|0;return x=(_+(p>>>13)|0)+(_n>>>26)|0,_n&=67108863,R[0]=ei,R[1]=ri,R[2]=ii,R[3]=si,R[4]=ni,R[5]=oi,R[6]=Vi,R[7]=mn,R[8]=Qi,R[9]=vn,R[10]=yn,R[11]=wn,R[12]=xs,R[13]=Os,R[14]=Ts,R[15]=bn,R[16]=An,R[17]=En,R[18]=_n,x!==0&&(R[19]=x,g.length++),g};Math.imul||(ct=Y);function at(c,f,g){g.negative=f.negative^c.negative,g.length=c.length+f.length;for(var E=0,S=0,R=0;R<g.length-1;R++){var x=S;S=0;for(var I=E&67108863,p=Math.min(R,f.length-1),_=Math.max(0,R-c.length+1);_<=p;_++){var lt=R-_,st=c.words[lt]|0,v=f.words[_]|0,$=st*v,k=$&67108863;x=x+($/67108864|0)|0,k=k+I|0,I=k&67108863,x=x+(k>>>26)|0,S+=x>>>26,x&=67108863}g.words[R]=I,E=x,x=S}return E!==0?g.words[R]=E:g.length--,g._strip()}function it(c,f,g){return at(c,f,g)}a.prototype.mulTo=function(c,f){var g,E=this.length+c.length;return this.length===10&&c.length===10?g=ct(this,c,f):E<63?g=Y(this,c,f):E<1024?g=at(this,c,f):g=it(this,c,f),g},a.prototype.mul=function(c){var f=new a(null);return f.words=new Array(this.length+c.length),this.mulTo(c,f)},a.prototype.mulf=function(c){var f=new a(null);return f.words=new Array(this.length+c.length),it(this,c,f)},a.prototype.imul=function(c){return this.clone().mulTo(c,this)},a.prototype.imuln=function(c){var f=c<0;f&&(c=-c),s(typeof c=="number"),s(c<67108864);for(var g=0,E=0;E<this.length;E++){var S=(this.words[E]|0)*c,R=(S&67108863)+(g&67108863);g>>=26,g+=S/67108864|0,g+=R>>>26,this.words[E]=R&67108863}return g!==0&&(this.words[E]=g,this.length++),f?this.ineg():this},a.prototype.muln=function(c){return this.clone().imuln(c)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(c){var f=V(c);if(f.length===0)return new a(1);for(var g=this,E=0;E<f.length&&f[E]===0;E++,g=g.sqr());if(++E<f.length)for(var S=g.sqr();E<f.length;E++,S=S.sqr())f[E]!==0&&(g=g.mul(S));return g},a.prototype.iushln=function(c){s(typeof c=="number"&&c>=0);var f=c%26,g=(c-f)/26,E=67108863>>>26-f<<26-f,S;if(f!==0){var R=0;for(S=0;S<this.length;S++){var x=this.words[S]&E,I=(this.words[S]|0)-x<<f;this.words[S]=I|R,R=x>>>26-f}R&&(this.words[S]=R,this.length++)}if(g!==0){for(S=this.length-1;S>=0;S--)this.words[S+g]=this.words[S];for(S=0;S<g;S++)this.words[S]=0;this.length+=g}return this._strip()},a.prototype.ishln=function(c){return s(this.negative===0),this.iushln(c)},a.prototype.iushrn=function(c,f,g){s(typeof c=="number"&&c>=0);var E;f?E=(f-f%26)/26:E=0;var S=c%26,R=Math.min((c-S)/26,this.length),x=67108863^67108863>>>S<<S,I=g;if(E-=R,E=Math.max(0,E),I){for(var p=0;p<R;p++)I.words[p]=this.words[p];I.length=R}if(R!==0)if(this.length>R)for(this.length-=R,p=0;p<this.length;p++)this.words[p]=this.words[p+R];else this.words[0]=0,this.length=1;var _=0;for(p=this.length-1;p>=0&&(_!==0||p>=E);p--){var lt=this.words[p]|0;this.words[p]=_<<26-S|lt>>>S,_=lt&x}return I&&_!==0&&(I.words[I.length++]=_),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},a.prototype.ishrn=function(c,f,g){return s(this.negative===0),this.iushrn(c,f,g)},a.prototype.shln=function(c){return this.clone().ishln(c)},a.prototype.ushln=function(c){return this.clone().iushln(c)},a.prototype.shrn=function(c){return this.clone().ishrn(c)},a.prototype.ushrn=function(c){return this.clone().iushrn(c)},a.prototype.testn=function(c){s(typeof c=="number"&&c>=0);var f=c%26,g=(c-f)/26,E=1<<f;if(this.length<=g)return!1;var S=this.words[g];return!!(S&E)},a.prototype.imaskn=function(c){s(typeof c=="number"&&c>=0);var f=c%26,g=(c-f)/26;if(s(this.negative===0,"imaskn works only with positive numbers"),this.length<=g)return this;if(f!==0&&g++,this.length=Math.min(g,this.length),f!==0){var E=67108863^67108863>>>f<<f;this.words[this.length-1]&=E}return this._strip()},a.prototype.maskn=function(c){return this.clone().imaskn(c)},a.prototype.iaddn=function(c){return s(typeof c=="number"),s(c<67108864),c<0?this.isubn(-c):this.negative!==0?this.length===1&&(this.words[0]|0)<=c?(this.words[0]=c-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(c),this.negative=1,this):this._iaddn(c)},a.prototype._iaddn=function(c){this.words[0]+=c;for(var f=0;f<this.length&&this.words[f]>=67108864;f++)this.words[f]-=67108864,f===this.length-1?this.words[f+1]=1:this.words[f+1]++;return this.length=Math.max(this.length,f+1),this},a.prototype.isubn=function(c){if(s(typeof c=="number"),s(c<67108864),c<0)return this.iaddn(-c);if(this.negative!==0)return this.negative=0,this.iaddn(c),this.negative=1,this;if(this.words[0]-=c,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var f=0;f<this.length&&this.words[f]<0;f++)this.words[f]+=67108864,this.words[f+1]-=1;return this._strip()},a.prototype.addn=function(c){return this.clone().iaddn(c)},a.prototype.subn=function(c){return this.clone().isubn(c)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(c,f,g){var E=c.length+g,S;this._expand(E);var R,x=0;for(S=0;S<c.length;S++){R=(this.words[S+g]|0)+x;var I=(c.words[S]|0)*f;R-=I&67108863,x=(R>>26)-(I/67108864|0),this.words[S+g]=R&67108863}for(;S<this.length-g;S++)R=(this.words[S+g]|0)+x,x=R>>26,this.words[S+g]=R&67108863;if(x===0)return this._strip();for(s(x===-1),x=0,S=0;S<this.length;S++)R=-(this.words[S]|0)+x,x=R>>26,this.words[S]=R&67108863;return this.negative=1,this._strip()},a.prototype._wordDiv=function(c,f){var g=this.length-c.length,E=this.clone(),S=c,R=S.words[S.length-1]|0,x=this._countBits(R);g=26-x,g!==0&&(S=S.ushln(g),E.iushln(g),R=S.words[S.length-1]|0);var I=E.length-S.length,p;if(f!=="mod"){p=new a(null),p.length=I+1,p.words=new Array(p.length);for(var _=0;_<p.length;_++)p.words[_]=0}var lt=E.clone()._ishlnsubmul(S,1,I);lt.negative===0&&(E=lt,p&&(p.words[I]=1));for(var st=I-1;st>=0;st--){var v=(E.words[S.length+st]|0)*67108864+(E.words[S.length+st-1]|0);for(v=Math.min(v/R|0,67108863),E._ishlnsubmul(S,v,st);E.negative!==0;)v--,E.negative=0,E._ishlnsubmul(S,1,st),E.isZero()||(E.negative^=1);p&&(p.words[st]=v)}return p&&p._strip(),E._strip(),f!=="div"&&g!==0&&E.iushrn(g),{div:p||null,mod:E}},a.prototype.divmod=function(c,f,g){if(s(!c.isZero()),this.isZero())return{div:new a(0),mod:new a(0)};var E,S,R;return this.negative!==0&&c.negative===0?(R=this.neg().divmod(c,f),f!=="mod"&&(E=R.div.neg()),f!=="div"&&(S=R.mod.neg(),g&&S.negative!==0&&S.iadd(c)),{div:E,mod:S}):this.negative===0&&c.negative!==0?(R=this.divmod(c.neg(),f),f!=="mod"&&(E=R.div.neg()),{div:E,mod:R.mod}):this.negative&c.negative?(R=this.neg().divmod(c.neg(),f),f!=="div"&&(S=R.mod.neg(),g&&S.negative!==0&&S.isub(c)),{div:R.div,mod:S}):c.length>this.length||this.cmp(c)<0?{div:new a(0),mod:this}:c.length===1?f==="div"?{div:this.divn(c.words[0]),mod:null}:f==="mod"?{div:null,mod:new a(this.modrn(c.words[0]))}:{div:this.divn(c.words[0]),mod:new a(this.modrn(c.words[0]))}:this._wordDiv(c,f)},a.prototype.div=function(c){return this.divmod(c,"div",!1).div},a.prototype.mod=function(c){return this.divmod(c,"mod",!1).mod},a.prototype.umod=function(c){return this.divmod(c,"mod",!0).mod},a.prototype.divRound=function(c){var f=this.divmod(c);if(f.mod.isZero())return f.div;var g=f.div.negative!==0?f.mod.isub(c):f.mod,E=c.ushrn(1),S=c.andln(1),R=g.cmp(E);return R<0||S===1&&R===0?f.div:f.div.negative!==0?f.div.isubn(1):f.div.iaddn(1)},a.prototype.modrn=function(c){var f=c<0;f&&(c=-c),s(c<=67108863);for(var g=(1<<26)%c,E=0,S=this.length-1;S>=0;S--)E=(g*E+(this.words[S]|0))%c;return f?-E:E},a.prototype.modn=function(c){return this.modrn(c)},a.prototype.idivn=function(c){var f=c<0;f&&(c=-c),s(c<=67108863);for(var g=0,E=this.length-1;E>=0;E--){var S=(this.words[E]|0)+g*67108864;this.words[E]=S/c|0,g=S%c}return this._strip(),f?this.ineg():this},a.prototype.divn=function(c){return this.clone().idivn(c)},a.prototype.egcd=function(c){s(c.negative===0),s(!c.isZero());var f=this,g=c.clone();f.negative!==0?f=f.umod(c):f=f.clone();for(var E=new a(1),S=new a(0),R=new a(0),x=new a(1),I=0;f.isEven()&&g.isEven();)f.iushrn(1),g.iushrn(1),++I;for(var p=g.clone(),_=f.clone();!f.isZero();){for(var lt=0,st=1;!(f.words[0]&st)&&lt<26;++lt,st<<=1);if(lt>0)for(f.iushrn(lt);lt-- >0;)(E.isOdd()||S.isOdd())&&(E.iadd(p),S.isub(_)),E.iushrn(1),S.iushrn(1);for(var v=0,$=1;!(g.words[0]&$)&&v<26;++v,$<<=1);if(v>0)for(g.iushrn(v);v-- >0;)(R.isOdd()||x.isOdd())&&(R.iadd(p),x.isub(_)),R.iushrn(1),x.iushrn(1);f.cmp(g)>=0?(f.isub(g),E.isub(R),S.isub(x)):(g.isub(f),R.isub(E),x.isub(S))}return{a:R,b:x,gcd:g.iushln(I)}},a.prototype._invmp=function(c){s(c.negative===0),s(!c.isZero());var f=this,g=c.clone();f.negative!==0?f=f.umod(c):f=f.clone();for(var E=new a(1),S=new a(0),R=g.clone();f.cmpn(1)>0&&g.cmpn(1)>0;){for(var x=0,I=1;!(f.words[0]&I)&&x<26;++x,I<<=1);if(x>0)for(f.iushrn(x);x-- >0;)E.isOdd()&&E.iadd(R),E.iushrn(1);for(var p=0,_=1;!(g.words[0]&_)&&p<26;++p,_<<=1);if(p>0)for(g.iushrn(p);p-- >0;)S.isOdd()&&S.iadd(R),S.iushrn(1);f.cmp(g)>=0?(f.isub(g),E.isub(S)):(g.isub(f),S.isub(E))}var lt;return f.cmpn(1)===0?lt=E:lt=S,lt.cmpn(0)<0&&lt.iadd(c),lt},a.prototype.gcd=function(c){if(this.isZero())return c.abs();if(c.isZero())return this.abs();var f=this.clone(),g=c.clone();f.negative=0,g.negative=0;for(var E=0;f.isEven()&&g.isEven();E++)f.iushrn(1),g.iushrn(1);do{for(;f.isEven();)f.iushrn(1);for(;g.isEven();)g.iushrn(1);var S=f.cmp(g);if(S<0){var R=f;f=g,g=R}else if(S===0||g.cmpn(1)===0)break;f.isub(g)}while(!0);return g.iushln(E)},a.prototype.invm=function(c){return this.egcd(c).a.umod(c)},a.prototype.isEven=function(){return(this.words[0]&1)===0},a.prototype.isOdd=function(){return(this.words[0]&1)===1},a.prototype.andln=function(c){return this.words[0]&c},a.prototype.bincn=function(c){s(typeof c=="number");var f=c%26,g=(c-f)/26,E=1<<f;if(this.length<=g)return this._expand(g+1),this.words[g]|=E,this;for(var S=E,R=g;S!==0&&R<this.length;R++){var x=this.words[R]|0;x+=S,S=x>>>26,x&=67108863,this.words[R]=x}return S!==0&&(this.words[R]=S,this.length++),this},a.prototype.isZero=function(){return this.length===1&&this.words[0]===0},a.prototype.cmpn=function(c){var f=c<0;if(this.negative!==0&&!f)return-1;if(this.negative===0&&f)return 1;this._strip();var g;if(this.length>1)g=1;else{f&&(c=-c),s(c<=67108863,"Number is too big");var E=this.words[0]|0;g=E===c?0:E<c?-1:1}return this.negative!==0?-g|0:g},a.prototype.cmp=function(c){if(this.negative!==0&&c.negative===0)return-1;if(this.negative===0&&c.negative!==0)return 1;var f=this.ucmp(c);return this.negative!==0?-f|0:f},a.prototype.ucmp=function(c){if(this.length>c.length)return 1;if(this.length<c.length)return-1;for(var f=0,g=this.length-1;g>=0;g--){var E=this.words[g]|0,S=c.words[g]|0;if(E!==S){E<S?f=-1:E>S&&(f=1);break}}return f},a.prototype.gtn=function(c){return this.cmpn(c)===1},a.prototype.gt=function(c){return this.cmp(c)===1},a.prototype.gten=function(c){return this.cmpn(c)>=0},a.prototype.gte=function(c){return this.cmp(c)>=0},a.prototype.ltn=function(c){return this.cmpn(c)===-1},a.prototype.lt=function(c){return this.cmp(c)===-1},a.prototype.lten=function(c){return this.cmpn(c)<=0},a.prototype.lte=function(c){return this.cmp(c)<=0},a.prototype.eqn=function(c){return this.cmpn(c)===0},a.prototype.eq=function(c){return this.cmp(c)===0},a.red=function(c){return new yt(c)},a.prototype.toRed=function(c){return s(!this.red,"Already a number in reduction context"),s(this.negative===0,"red works only with positives"),c.convertTo(this)._forceRed(c)},a.prototype.fromRed=function(){return s(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(c){return this.red=c,this},a.prototype.forceRed=function(c){return s(!this.red,"Already a number in reduction context"),this._forceRed(c)},a.prototype.redAdd=function(c){return s(this.red,"redAdd works only with red numbers"),this.red.add(this,c)},a.prototype.redIAdd=function(c){return s(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,c)},a.prototype.redSub=function(c){return s(this.red,"redSub works only with red numbers"),this.red.sub(this,c)},a.prototype.redISub=function(c){return s(this.red,"redISub works only with red numbers"),this.red.isub(this,c)},a.prototype.redShl=function(c){return s(this.red,"redShl works only with red numbers"),this.red.shl(this,c)},a.prototype.redMul=function(c){return s(this.red,"redMul works only with red numbers"),this.red._verify2(this,c),this.red.mul(this,c)},a.prototype.redIMul=function(c){return s(this.red,"redMul works only with red numbers"),this.red._verify2(this,c),this.red.imul(this,c)},a.prototype.redSqr=function(){return s(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return s(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return s(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return s(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return s(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(c){return s(this.red&&!c.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,c)};var rt={k256:null,p224:null,p192:null,p25519:null};function ht(c,f){this.name=c,this.p=new a(f,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}ht.prototype._tmp=function(){var c=new a(null);return c.words=new Array(Math.ceil(this.n/13)),c},ht.prototype.ireduce=function(c){var f=c,g;do this.split(f,this.tmp),f=this.imulK(f),f=f.iadd(this.tmp),g=f.bitLength();while(g>this.n);var E=g<this.n?-1:f.ucmp(this.p);return E===0?(f.words[0]=0,f.length=1):E>0?f.isub(this.p):f.strip!==void 0?f.strip():f._strip(),f},ht.prototype.split=function(c,f){c.iushrn(this.n,0,f)},ht.prototype.imulK=function(c){return c.imul(this.k)};function gt(){ht.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}o(gt,ht),gt.prototype.split=function(c,f){for(var g=4194303,E=Math.min(c.length,9),S=0;S<E;S++)f.words[S]=c.words[S];if(f.length=E,c.length<=9){c.words[0]=0,c.length=1;return}var R=c.words[9];for(f.words[f.length++]=R&g,S=10;S<c.length;S++){var x=c.words[S]|0;c.words[S-10]=(x&g)<<4|R>>>22,R=x}R>>>=22,c.words[S-10]=R,R===0&&c.length>10?c.length-=10:c.length-=9},gt.prototype.imulK=function(c){c.words[c.length]=0,c.words[c.length+1]=0,c.length+=2;for(var f=0,g=0;g<c.length;g++){var E=c.words[g]|0;f+=E*977,c.words[g]=f&67108863,f=E*64+(f/67108864|0)}return c.words[c.length-1]===0&&(c.length--,c.words[c.length-1]===0&&c.length--),c};function ut(){ht.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}o(ut,ht);function Ot(){ht.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}o(Ot,ht);function Ae(){ht.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}o(Ae,ht),Ae.prototype.imulK=function(c){for(var f=0,g=0;g<c.length;g++){var E=(c.words[g]|0)*19+f,S=E&67108863;E>>>=26,c.words[g]=S,f=E}return f!==0&&(c.words[c.length++]=f),c},a._prime=function(c){if(rt[c])return rt[c];var f;if(c==="k256")f=new gt;else if(c==="p224")f=new ut;else if(c==="p192")f=new Ot;else if(c==="p25519")f=new Ae;else throw new Error("Unknown prime "+c);return rt[c]=f,f};function yt(c){if(typeof c=="string"){var f=a._prime(c);this.m=f.p,this.prime=f}else s(c.gtn(1),"modulus must be greater than 1"),this.m=c,this.prime=null}yt.prototype._verify1=function(c){s(c.negative===0,"red works only with positives"),s(c.red,"red works only with red numbers")},yt.prototype._verify2=function(c,f){s((c.negative|f.negative)===0,"red works only with positives"),s(c.red&&c.red===f.red,"red works only with red numbers")},yt.prototype.imod=function(c){return this.prime?this.prime.ireduce(c)._forceRed(this):(C(c,c.umod(this.m)._forceRed(this)),c)},yt.prototype.neg=function(c){return c.isZero()?c.clone():this.m.sub(c)._forceRed(this)},yt.prototype.add=function(c,f){this._verify2(c,f);var g=c.add(f);return g.cmp(this.m)>=0&&g.isub(this.m),g._forceRed(this)},yt.prototype.iadd=function(c,f){this._verify2(c,f);var g=c.iadd(f);return g.cmp(this.m)>=0&&g.isub(this.m),g},yt.prototype.sub=function(c,f){this._verify2(c,f);var g=c.sub(f);return g.cmpn(0)<0&&g.iadd(this.m),g._forceRed(this)},yt.prototype.isub=function(c,f){this._verify2(c,f);var g=c.isub(f);return g.cmpn(0)<0&&g.iadd(this.m),g},yt.prototype.shl=function(c,f){return this._verify1(c),this.imod(c.ushln(f))},yt.prototype.imul=function(c,f){return this._verify2(c,f),this.imod(c.imul(f))},yt.prototype.mul=function(c,f){return this._verify2(c,f),this.imod(c.mul(f))},yt.prototype.isqr=function(c){return this.imul(c,c.clone())},yt.prototype.sqr=function(c){return this.mul(c,c)},yt.prototype.sqrt=function(c){if(c.isZero())return c.clone();var f=this.m.andln(3);if(s(f%2===1),f===3){var g=this.m.add(new a(1)).iushrn(2);return this.pow(c,g)}for(var E=this.m.subn(1),S=0;!E.isZero()&&E.andln(1)===0;)S++,E.iushrn(1);s(!E.isZero());var R=new a(1).toRed(this),x=R.redNeg(),I=this.m.subn(1).iushrn(1),p=this.m.bitLength();for(p=new a(2*p*p).toRed(this);this.pow(p,I).cmp(x)!==0;)p.redIAdd(x);for(var _=this.pow(p,E),lt=this.pow(c,E.addn(1).iushrn(1)),st=this.pow(c,E),v=S;st.cmp(R)!==0;){for(var $=st,k=0;$.cmp(R)!==0;k++)$=$.redSqr();s(k<v);var L=this.pow(_,new a(1).iushln(v-k-1));lt=lt.redMul(L),_=L.redSqr(),st=st.redMul(_),v=k}return lt},yt.prototype.invm=function(c){var f=c._invmp(this.m);return f.negative!==0?(f.negative=0,this.imod(f).redNeg()):this.imod(f)},yt.prototype.pow=function(c,f){if(f.isZero())return new a(1).toRed(this);if(f.cmpn(1)===0)return c.clone();var g=4,E=new Array(1<<g);E[0]=new a(1).toRed(this),E[1]=c;for(var S=2;S<E.length;S++)E[S]=this.mul(E[S-1],c);var R=E[0],x=0,I=0,p=f.bitLength()%26;for(p===0&&(p=26),S=f.length-1;S>=0;S--){for(var _=f.words[S],lt=p-1;lt>=0;lt--){var st=_>>lt&1;if(R!==E[0]&&(R=this.sqr(R)),st===0&&x===0){I=0;continue}x<<=1,x|=st,I++,!(I!==g&&(S!==0||lt!==0))&&(R=this.mul(R,E[x]),I=0,x=0)}p=26}return R},yt.prototype.convertTo=function(c){var f=c.umod(this.m);return f===c?f.clone():f},yt.prototype.convertFrom=function(c){var f=c.clone();return f.red=null,f},a.mont=function(c){return new Jt(c)};function Jt(c){yt.call(this,c),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}o(Jt,yt),Jt.prototype.convertTo=function(c){return this.imod(c.ushln(this.shift))},Jt.prototype.convertFrom=function(c){var f=this.imod(c.mul(this.rinv));return f.red=null,f},Jt.prototype.imul=function(c,f){if(c.isZero()||f.isZero())return c.words[0]=0,c.length=1,c;var g=c.imul(f),E=g.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),S=g.isub(E).iushrn(this.shift),R=S;return S.cmp(this.m)>=0?R=S.isub(this.m):S.cmpn(0)<0&&(R=S.iadd(this.m)),R._forceRed(this)},Jt.prototype.mul=function(c,f){if(c.isZero()||f.isZero())return new a(0)._forceRed(this);var g=c.mul(f),E=g.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),S=g.isub(E).iushrn(this.shift),R=S;return S.cmp(this.m)>=0?R=S.isub(this.m):S.cmpn(0)<0&&(R=S.iadd(this.m)),R._forceRed(this)},Jt.prototype.invm=function(c){var f=this.imod(c._invmp(this.m).mul(this.r2));return f._forceRed(this)}})(i,md)})(bd);var bt=bd.exports;const Ad="bignumber/5.7.0";var fa=bt.BN;const ji=new Ue(Ad),Uh={},Tf=9007199254740991;function y2(i){return i!=null&&(Ze.isBigNumber(i)||typeof i=="number"&&i%1===0||typeof i=="string"&&!!i.match(/^-?[0-9]+$/)||vr(i)||typeof i=="bigint"||un(i))}let Df=!1,Ze=class Vr{constructor(t,e){t!==Uh&&ji.throwError("cannot call constructor directly; use BigNumber.from",Ue.errors.UNSUPPORTED_OPERATION,{operation:"new (BigNumber)"}),this._hex=e,this._isBigNumber=!0,Object.freeze(this)}fromTwos(t){return sr(Mt(this).fromTwos(t))}toTwos(t){return sr(Mt(this).toTwos(t))}abs(){return this._hex[0]==="-"?Vr.from(this._hex.substring(1)):this}add(t){return sr(Mt(this).add(Mt(t)))}sub(t){return sr(Mt(this).sub(Mt(t)))}div(t){return Vr.from(t).isZero()&&Cr("division-by-zero","div"),sr(Mt(this).div(Mt(t)))}mul(t){return sr(Mt(this).mul(Mt(t)))}mod(t){const e=Mt(t);return e.isNeg()&&Cr("division-by-zero","mod"),sr(Mt(this).umod(e))}pow(t){const e=Mt(t);return e.isNeg()&&Cr("negative-power","pow"),sr(Mt(this).pow(e))}and(t){const e=Mt(t);return(this.isNegative()||e.isNeg())&&Cr("unbound-bitwise-result","and"),sr(Mt(this).and(e))}or(t){const e=Mt(t);return(this.isNegative()||e.isNeg())&&Cr("unbound-bitwise-result","or"),sr(Mt(this).or(e))}xor(t){const e=Mt(t);return(this.isNegative()||e.isNeg())&&Cr("unbound-bitwise-result","xor"),sr(Mt(this).xor(e))}mask(t){return(this.isNegative()||t<0)&&Cr("negative-width","mask"),sr(Mt(this).maskn(t))}shl(t){return(this.isNegative()||t<0)&&Cr("negative-width","shl"),sr(Mt(this).shln(t))}shr(t){return(this.isNegative()||t<0)&&Cr("negative-width","shr"),sr(Mt(this).shrn(t))}eq(t){return Mt(this).eq(Mt(t))}lt(t){return Mt(this).lt(Mt(t))}lte(t){return Mt(this).lte(Mt(t))}gt(t){return Mt(this).gt(Mt(t))}gte(t){return Mt(this).gte(Mt(t))}isNegative(){return this._hex[0]==="-"}isZero(){return Mt(this).isZero()}toNumber(){try{return Mt(this).toNumber()}catch{Cr("overflow","toNumber",this.toString())}return null}toBigInt(){try{return BigInt(this.toString())}catch{}return ji.throwError("this platform does not support BigInt",Ue.errors.UNSUPPORTED_OPERATION,{value:this.toString()})}toString(){return arguments.length>0&&(arguments[0]===10?Df||(Df=!0,ji.warn("BigNumber.toString does not accept any parameters; base-10 is assumed")):arguments[0]===16?ji.throwError("BigNumber.toString does not accept any parameters; use bigNumber.toHexString()",Ue.errors.UNEXPECTED_ARGUMENT,{}):ji.throwError("BigNumber.toString does not accept parameters",Ue.errors.UNEXPECTED_ARGUMENT,{})),Mt(this).toString(10)}toHexString(){return this._hex}toJSON(t){return{type:"BigNumber",hex:this.toHexString()}}static from(t){if(t instanceof Vr)return t;if(typeof t=="string")return t.match(/^-?0x[0-9a-f]+$/i)?new Vr(Uh,to(t)):t.match(/^-?[0-9]+$/)?new Vr(Uh,to(new fa(t))):ji.throwArgumentError("invalid BigNumber string","value",t);if(typeof t=="number")return t%1&&Cr("underflow","BigNumber.from",t),(t>=Tf||t<=-Tf)&&Cr("overflow","BigNumber.from",t),Vr.from(String(t));const e=t;if(typeof e=="bigint")return Vr.from(e.toString());if(un(e))return Vr.from(Je(e));if(e)if(e.toHexString){const s=e.toHexString();if(typeof s=="string")return Vr.from(s)}else{let s=e._hex;if(s==null&&e.type==="BigNumber"&&(s=e.hex),typeof s=="string"&&(vr(s)||s[0]==="-"&&vr(s.substring(1))))return Vr.from(s)}return ji.throwArgumentError("invalid BigNumber value","value",t)}static isBigNumber(t){return!!(t&&t._isBigNumber)}};function to(i){if(typeof i!="string")return to(i.toString(16));if(i[0]==="-")return i=i.substring(1),i[0]==="-"&&ji.throwArgumentError("invalid hex","value",i),i=to(i),i==="0x00"?i:"-"+i;if(i.substring(0,2)!=="0x"&&(i="0x"+i),i==="0x")return"0x00";for(i.length%2&&(i="0x0"+i.substring(2));i.length>4&&i.substring(0,4)==="0x00";)i="0x"+i.substring(4);return i}function sr(i){return Ze.from(to(i))}function Mt(i){const t=Ze.from(i).toHexString();return t[0]==="-"?new fa("-"+t.substring(3),16):new fa(t.substring(2),16)}function Cr(i,t,e){const s={fault:i,operation:t};return e!=null&&(s.value=e),ji.throwError(i,Ue.errors.NUMERIC_FAULT,s)}function w2(i){return new fa(i,36).toString(16)}const Ye=new Ue(Ad),Yn={},Ed=Ze.from(0),_d=Ze.from(-1);function Id(i,t,e,s){const o={fault:t,operation:e};return s!==void 0&&(o.value=s),Ye.throwError(i,Ue.errors.NUMERIC_FAULT,o)}let Wn="0";for(;Wn.length<256;)Wn+=Wn;function qc(i){if(typeof i!="number")try{i=Ze.from(i).toNumber()}catch{}return typeof i=="number"&&i>=0&&i<=256&&!(i%1)?"1"+Wn.substring(0,i):Ye.throwArgumentError("invalid decimal size","decimals",i)}function $h(i,t){t==null&&(t=0);const e=qc(t);i=Ze.from(i);const s=i.lt(Ed);s&&(i=i.mul(_d));let o=i.mod(e).toString();for(;o.length<e.length-1;)o="0"+o;o=o.match(/^([0-9]*[1-9]|0)(0*)/)[1];const a=i.div(e).toString();return e.length===1?i=a:i=a+"."+o,s&&(i="-"+i),i}function ki(i,t){t==null&&(t=0);const e=qc(t);(typeof i!="string"||!i.match(/^-?[0-9.]+$/))&&Ye.throwArgumentError("invalid decimal value","value",i);const s=i.substring(0,1)==="-";s&&(i=i.substring(1)),i==="."&&Ye.throwArgumentError("missing value","value",i);const o=i.split(".");o.length>2&&Ye.throwArgumentError("too many decimal points","value",i);let a=o[0],u=o[1];for(a||(a="0"),u||(u="0");u[u.length-1]==="0";)u=u.substring(0,u.length-1);for(u.length>e.length-1&&Id("fractional component exceeds decimals","underflow","parseFixed"),u===""&&(u="0");u.length<e.length-1;)u+="0";const d=Ze.from(a),y=Ze.from(u);let b=d.mul(e).add(y);return s&&(b=b.mul(_d)),b}let jh=class dc{constructor(t,e,s,o){t!==Yn&&Ye.throwError("cannot use FixedFormat constructor; use FixedFormat.from",Ue.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.signed=e,this.width=s,this.decimals=o,this.name=(e?"":"u")+"fixed"+String(s)+"x"+String(o),this._multiplier=qc(o),Object.freeze(this)}static from(t){if(t instanceof dc)return t;typeof t=="number"&&(t=`fixed128x${t}`);let e=!0,s=128,o=18;if(typeof t=="string"){if(t!=="fixed")if(t==="ufixed")e=!1;else{const a=t.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);a||Ye.throwArgumentError("invalid fixed format","format",t),e=a[1]!=="u",s=parseInt(a[2]),o=parseInt(a[3])}}else if(t){const a=(u,d,y)=>t[u]==null?y:(typeof t[u]!==d&&Ye.throwArgumentError("invalid fixed format ("+u+" not "+d+")","format."+u,t[u]),t[u]);e=a("signed","boolean",e),s=a("width","number",s),o=a("decimals","number",o)}return s%8&&Ye.throwArgumentError("invalid fixed format width (not byte aligned)","format.width",s),o>80&&Ye.throwArgumentError("invalid fixed format (decimals too large)","format.decimals",o),new dc(Yn,e,s,o)}},Sd=class Ge{constructor(t,e,s,o){t!==Yn&&Ye.throwError("cannot use FixedNumber constructor; use FixedNumber.from",Ue.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.format=o,this._hex=e,this._value=s,this._isFixedNumber=!0,Object.freeze(this)}_checkFormat(t){this.format.name!==t.format.name&&Ye.throwArgumentError("incompatible format; use fixedNumber.toFormat","other",t)}addUnsafe(t){this._checkFormat(t);const e=ki(this._value,this.format.decimals),s=ki(t._value,t.format.decimals);return Ge.fromValue(e.add(s),this.format.decimals,this.format)}subUnsafe(t){this._checkFormat(t);const e=ki(this._value,this.format.decimals),s=ki(t._value,t.format.decimals);return Ge.fromValue(e.sub(s),this.format.decimals,this.format)}mulUnsafe(t){this._checkFormat(t);const e=ki(this._value,this.format.decimals),s=ki(t._value,t.format.decimals);return Ge.fromValue(e.mul(s).div(this.format._multiplier),this.format.decimals,this.format)}divUnsafe(t){this._checkFormat(t);const e=ki(this._value,this.format.decimals),s=ki(t._value,t.format.decimals);return Ge.fromValue(e.mul(this.format._multiplier).div(s),this.format.decimals,this.format)}floor(){const t=this.toString().split(".");t.length===1&&t.push("0");let e=Ge.from(t[0],this.format);const s=!t[1].match(/^(0*)$/);return this.isNegative()&&s&&(e=e.subUnsafe(Ff.toFormat(e.format))),e}ceiling(){const t=this.toString().split(".");t.length===1&&t.push("0");let e=Ge.from(t[0],this.format);const s=!t[1].match(/^(0*)$/);return!this.isNegative()&&s&&(e=e.addUnsafe(Ff.toFormat(e.format))),e}round(t){t==null&&(t=0);const e=this.toString().split(".");if(e.length===1&&e.push("0"),(t<0||t>80||t%1)&&Ye.throwArgumentError("invalid decimal count","decimals",t),e[1].length<=t)return this;const s=Ge.from("1"+Wn.substring(0,t),this.format),o=b2.toFormat(this.format);return this.mulUnsafe(s).addUnsafe(o).floor().divUnsafe(s)}isZero(){return this._value==="0.0"||this._value==="0"}isNegative(){return this._value[0]==="-"}toString(){return this._value}toHexString(t){if(t==null)return this._hex;t%8&&Ye.throwArgumentError("invalid byte width","width",t);const e=Ze.from(this._hex).fromTwos(this.format.width).toTwos(t).toHexString();return mi(e,t/8)}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(t){return Ge.fromString(this._value,t)}static fromValue(t,e,s){return s==null&&e!=null&&!y2(e)&&(s=e,e=null),e==null&&(e=0),s==null&&(s="fixed"),Ge.fromString($h(t,e),jh.from(s))}static fromString(t,e){e==null&&(e="fixed");const s=jh.from(e),o=ki(t,s.decimals);!s.signed&&o.lt(Ed)&&Id("unsigned value cannot be negative","overflow","value",t);let a=null;s.signed?a=o.toTwos(s.width).toHexString():(a=o.toHexString(),a=mi(a,s.width/8));const u=$h(o,s.decimals);return new Ge(Yn,a,u,s)}static fromBytes(t,e){e==null&&(e="fixed");const s=jh.from(e);if(Ie(t).length>s.width/8)throw new Error("overflow");let o=Ze.from(t);s.signed&&(o=o.fromTwos(s.width));const a=o.toTwos((s.signed?0:1)+s.width).toHexString(),u=$h(o,s.decimals);return new Ge(Yn,a,u,s)}static from(t,e){if(typeof t=="string")return Ge.fromString(t,e);if(un(t))return Ge.fromBytes(t,e);try{return Ge.fromValue(t,0,e)}catch(s){if(s.code!==Ue.errors.INVALID_ARGUMENT)throw s}return Ye.throwArgumentError("invalid FixedNumber value","value",t)}static isFixedNumber(t){return!!(t&&t._isFixedNumber)}};const Ff=Sd.from(1),b2=Sd.from("0.5"),A2="strings/5.7.0",E2=new Ue(A2);var pa;(function(i){i.current="",i.NFC="NFC",i.NFD="NFD",i.NFKC="NFKC",i.NFKD="NFKD"})(pa||(pa={}));var qf;(function(i){i.UNEXPECTED_CONTINUE="unexpected continuation byte",i.BAD_PREFIX="bad codepoint prefix",i.OVERRUN="string overrun",i.MISSING_CONTINUE="missing continuation byte",i.OUT_OF_RANGE="out of UTF-8 range",i.UTF16_SURROGATE="UTF-16 surrogate",i.OVERLONG="overlong representation"})(qf||(qf={}));function zh(i,t=pa.current){t!=pa.current&&(E2.checkNormalize(),i=i.normalize(t));let e=[];for(let s=0;s<i.length;s++){const o=i.charCodeAt(s);if(o<128)e.push(o);else if(o<2048)e.push(o>>6|192),e.push(o&63|128);else if((o&64512)==55296){s++;const a=i.charCodeAt(s);if(s>=i.length||(a&64512)!==56320)throw new Error("invalid utf-8 string");const u=65536+((o&1023)<<10)+(a&1023);e.push(u>>18|240),e.push(u>>12&63|128),e.push(u>>6&63|128),e.push(u&63|128)}else e.push(o>>12|224),e.push(o>>6&63|128),e.push(o&63|128)}return Ie(e)}function _2(i){if(i.length%4!==0)throw new Error("bad data");let t=[];for(let e=0;e<i.length;e+=4)t.push(parseInt(i.substring(e,e+4),16));return t}function Lh(i,t){t||(t=function(o){return[parseInt(o,16)]});let e=0,s={};return i.split(",").forEach(o=>{let a=o.split(":");e+=parseInt(a[0],16),s[e]=t(a[1])}),s}function Bf(i){let t=0;return i.split(",").map(e=>{let s=e.split("-");s.length===1?s[1]="0":s[1]===""&&(s[1]="1");let o=t+parseInt(s[0],16);return t=parseInt(s[1],16),{l:o,h:t}})}Bf("221,13-1b,5f-,40-10,51-f,11-3,3-3,2-2,2-4,8,2,15,2d,28-8,88,48,27-,3-5,11-20,27-,8,28,3-5,12,18,b-a,1c-4,6-16,2-d,2-2,2,1b-4,17-9,8f-,10,f,1f-2,1c-34,33-14e,4,36-,13-,6-2,1a-f,4,9-,3-,17,8,2-2,5-,2,8-,3-,4-8,2-3,3,6-,16-6,2-,7-3,3-,17,8,3,3,3-,2,6-3,3-,4-a,5,2-6,10-b,4,8,2,4,17,8,3,6-,b,4,4-,2-e,2-4,b-10,4,9-,3-,17,8,3-,5-,9-2,3-,4-7,3-3,3,4-3,c-10,3,7-2,4,5-2,3,2,3-2,3-2,4-2,9,4-3,6-2,4,5-8,2-e,d-d,4,9,4,18,b,6-3,8,4,5-6,3-8,3-3,b-11,3,9,4,18,b,6-3,8,4,5-6,3-6,2,3-3,b-11,3,9,4,18,11-3,7-,4,5-8,2-7,3-3,b-11,3,13-2,19,a,2-,8-2,2-3,7,2,9-11,4-b,3b-3,1e-24,3,2-,3,2-,2-5,5,8,4,2,2-,3,e,4-,6,2,7-,b-,3-21,49,23-5,1c-3,9,25,10-,2-2f,23,6,3,8-2,5-5,1b-45,27-9,2a-,2-3,5b-4,45-4,53-5,8,40,2,5-,8,2,5-,28,2,5-,20,2,5-,8,2,5-,8,8,18,20,2,5-,8,28,14-5,1d-22,56-b,277-8,1e-2,52-e,e,8-a,18-8,15-b,e,4,3-b,5e-2,b-15,10,b-5,59-7,2b-555,9d-3,5b-5,17-,7-,27-,7-,9,2,2,2,20-,36,10,f-,7,14-,4,a,54-3,2-6,6-5,9-,1c-10,13-1d,1c-14,3c-,10-6,32-b,240-30,28-18,c-14,a0,115-,3,66-,b-76,5,5-,1d,24,2,5-2,2,8-,35-2,19,f-10,1d-3,311-37f,1b,5a-b,d7-19,d-3,41,57-,68-4,29-3,5f,29-37,2e-2,25-c,2c-2,4e-3,30,78-3,64-,20,19b7-49,51a7-59,48e-2,38-738,2ba5-5b,222f-,3c-94,8-b,6-4,1b,6,2,3,3,6d-20,16e-f,41-,37-7,2e-2,11-f,5-b,18-,b,14,5-3,6,88-,2,bf-2,7-,7-,7-,4-2,8,8-9,8-2ff,20,5-b,1c-b4,27-,27-cbb1,f7-9,28-2,b5-221,56,48,3-,2-,3-,5,d,2,5,3,42,5-,9,8,1d,5,6,2-2,8,153-3,123-3,33-27fd,a6da-5128,21f-5df,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3,2-1d,61-ff7d"),"ad,34f,1806,180b,180c,180d,200b,200c,200d,2060,feff".split(",").map(i=>parseInt(i,16)),Lh("b5:3bc,c3:ff,7:73,2:253,5:254,3:256,1:257,5:259,1:25b,3:260,1:263,2:269,1:268,5:26f,1:272,2:275,7:280,3:283,5:288,3:28a,1:28b,5:292,3f:195,1:1bf,29:19e,125:3b9,8b:3b2,1:3b8,1:3c5,3:3c6,1:3c0,1a:3ba,1:3c1,1:3c3,2:3b8,1:3b5,1bc9:3b9,1c:1f76,1:1f77,f:1f7a,1:1f7b,d:1f78,1:1f79,1:1f7c,1:1f7d,107:63,5:25b,4:68,1:68,1:68,3:69,1:69,1:6c,3:6e,4:70,1:71,1:72,1:72,1:72,7:7a,2:3c9,2:7a,2:6b,1:e5,1:62,1:63,3:65,1:66,2:6d,b:3b3,1:3c0,6:64,1b574:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3"),Lh("179:1,2:1,2:1,5:1,2:1,a:4f,a:1,8:1,2:1,2:1,3:1,5:1,3:1,4:1,2:1,3:1,4:1,8:2,1:1,2:2,1:1,2:2,27:2,195:26,2:25,1:25,1:25,2:40,2:3f,1:3f,33:1,11:-6,1:-9,1ac7:-3a,6d:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,b:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,c:-8,2:-8,2:-8,2:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,49:-8,1:-8,1:-4a,1:-4a,d:-56,1:-56,1:-56,1:-56,d:-8,1:-8,f:-8,1:-8,3:-7"),Lh("df:00730073,51:00690307,19:02BC006E,a7:006A030C,18a:002003B9,16:03B903080301,20:03C503080301,1d7:05650582,190f:00680331,1:00740308,1:0077030A,1:0079030A,1:006102BE,b6:03C50313,2:03C503130300,2:03C503130301,2:03C503130342,2a:1F0003B9,1:1F0103B9,1:1F0203B9,1:1F0303B9,1:1F0403B9,1:1F0503B9,1:1F0603B9,1:1F0703B9,1:1F0003B9,1:1F0103B9,1:1F0203B9,1:1F0303B9,1:1F0403B9,1:1F0503B9,1:1F0603B9,1:1F0703B9,1:1F2003B9,1:1F2103B9,1:1F2203B9,1:1F2303B9,1:1F2403B9,1:1F2503B9,1:1F2603B9,1:1F2703B9,1:1F2003B9,1:1F2103B9,1:1F2203B9,1:1F2303B9,1:1F2403B9,1:1F2503B9,1:1F2603B9,1:1F2703B9,1:1F6003B9,1:1F6103B9,1:1F6203B9,1:1F6303B9,1:1F6403B9,1:1F6503B9,1:1F6603B9,1:1F6703B9,1:1F6003B9,1:1F6103B9,1:1F6203B9,1:1F6303B9,1:1F6403B9,1:1F6503B9,1:1F6603B9,1:1F6703B9,3:1F7003B9,1:03B103B9,1:03AC03B9,2:03B10342,1:03B1034203B9,5:03B103B9,6:1F7403B9,1:03B703B9,1:03AE03B9,2:03B70342,1:03B7034203B9,5:03B703B9,6:03B903080300,1:03B903080301,3:03B90342,1:03B903080342,b:03C503080300,1:03C503080301,1:03C10313,2:03C50342,1:03C503080342,b:1F7C03B9,1:03C903B9,1:03CE03B9,2:03C90342,1:03C9034203B9,5:03C903B9,ac:00720073,5b:00B00063,6:00B00066,d:006E006F,a:0073006D,1:00740065006C,1:0074006D,124f:006800700061,2:00610075,2:006F0076,b:00700061,1:006E0061,1:03BC0061,1:006D0061,1:006B0061,1:006B0062,1:006D0062,1:00670062,3:00700066,1:006E0066,1:03BC0066,4:0068007A,1:006B0068007A,1:006D0068007A,1:00670068007A,1:00740068007A,15:00700061,1:006B00700061,1:006D00700061,1:006700700061,8:00700076,1:006E0076,1:03BC0076,1:006D0076,1:006B0076,1:006D0076,1:00700077,1:006E0077,1:03BC0077,1:006D0077,1:006B0077,1:006D0077,1:006B03C9,1:006D03C9,2:00620071,3:00632215006B0067,1:0063006F002E,1:00640062,1:00670079,2:00680070,2:006B006B,1:006B006D,9:00700068,2:00700070006D,1:00700072,2:00730076,1:00770062,c723:00660066,1:00660069,1:0066006C,1:006600660069,1:00660066006C,1:00730074,1:00730074,d:05740576,1:05740565,1:0574056B,1:057E0576,1:0574056D",_2),Bf("80-20,2a0-,39c,32,f71,18e,7f2-f,19-7,30-4,7-5,f81-b,5,a800-20ff,4d1-1f,110,fa-6,d174-7,2e84-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,2,1f-5f,ff7f-20001");function I2(i){i=atob(i);const t=[];for(let e=0;e<i.length;e++)t.push(i.charCodeAt(e));return Ie(t)}function Pd(i,t){t==null&&(t=1);const e=[],s=e.forEach,o=function(a,u){s.call(a,function(d){u>0&&Array.isArray(d)?o(d,u-1):e.push(d)})};return o(i,t),e}function S2(i){const t={};for(let e=0;e<i.length;e++){const s=i[e];t[s[0]]=s[1]}return t}function P2(i){let t=0;function e(){return i[t++]<<8|i[t++]}let s=e(),o=1,a=[0,1];for(let rt=1;rt<s;rt++)a.push(o+=e());let u=e(),d=t;t+=u;let y=0,b=0;function C(){return y==0&&(b=b<<8|i[t++],y=8),b>>--y&1}const P=31,O=Math.pow(2,P),F=O>>>1,q=F>>1,H=O-1;let V=0;for(let rt=0;rt<P;rt++)V=V<<1|C();let Y=[],ct=0,at=O;for(;;){let rt=Math.floor(((V-ct+1)*o-1)/at),ht=0,gt=s;for(;gt-ht>1;){let Ae=ht+gt>>>1;rt<a[Ae]?gt=Ae:ht=Ae}if(ht==0)break;Y.push(ht);let ut=ct+Math.floor(at*a[ht]/o),Ot=ct+Math.floor(at*a[ht+1]/o)-1;for(;!((ut^Ot)&F);)V=V<<1&H|C(),ut=ut<<1&H,Ot=Ot<<1&H|1;for(;ut&~Ot&q;)V=V&F|V<<1&H>>>1|C(),ut=ut<<1^F,Ot=(Ot^F)<<1|F|1;ct=ut,at=1+Ot-ut}let it=s-4;return Y.map(rt=>{switch(rt-it){case 3:return it+65792+(i[d++]<<16|i[d++]<<8|i[d++]);case 2:return it+256+(i[d++]<<8|i[d++]);case 1:return it+i[d++];default:return rt-1}})}function M2(i){let t=0;return()=>i[t++]}function C2(i){return M2(P2(i))}function R2(i){return i&1?~i>>1:i>>1}function N2(i,t){let e=Array(i);for(let s=0;s<i;s++)e[s]=1+t();return e}function kf(i,t){let e=Array(i);for(let s=0,o=-1;s<i;s++)e[s]=o+=1+t();return e}function x2(i,t){let e=Array(i);for(let s=0,o=0;s<i;s++)e[s]=o+=R2(t());return e}function da(i,t){let e=kf(i(),i),s=i(),o=kf(s,i),a=N2(s,i);for(let u=0;u<s;u++)for(let d=0;d<a[u];d++)e.push(o[u]+d);return t?e.map(u=>t[u]):e}function O2(i){let t=[];for(;;){let e=i();if(e==0)break;t.push(D2(e,i))}for(;;){let e=i()-1;if(e<0)break;t.push(F2(e,i))}return S2(Pd(t))}function T2(i){let t=[];for(;;){let e=i();if(e==0)break;t.push(e)}return t}function Md(i,t,e){let s=Array(i).fill(void 0).map(()=>[]);for(let o=0;o<t;o++)x2(i,e).forEach((a,u)=>s[u].push(a));return s}function D2(i,t){let e=1+t(),s=t(),o=T2(t),a=Md(o.length,1+i,t);return Pd(a.map((u,d)=>{const y=u[0],b=u.slice(1);return Array(o[d]).fill(void 0).map((C,P)=>{let O=P*s;return[y+P*e,b.map(F=>F+O)]})}))}function F2(i,t){let e=1+t();return Md(e,1+i,t).map(s=>[s[0],s.slice(1)])}function q2(i){let t=da(i).sort((s,o)=>s-o);return e();function e(){let s=[];for(;;){let b=da(i,t);if(b.length==0)break;s.push({set:new Set(b),node:e()})}s.sort((b,C)=>C.set.size-b.set.size);let o=i(),a=o%3;o=o/3|0;let u=!!(o&1);o>>=1;let d=o==1,y=o==2;return{branches:s,valid:a,fe0f:u,save:d,check:y}}}function B2(){return C2(I2("AEQF2AO2DEsA2wIrAGsBRABxAN8AZwCcAEwAqgA0AGwAUgByADcATAAVAFYAIQAyACEAKAAYAFgAGwAjABQAMAAmADIAFAAfABQAKwATACoADgAbAA8AHQAYABoAGQAxADgALAAoADwAEwA9ABMAGgARAA4ADwAWABMAFgAIAA8AHgQXBYMA5BHJAS8JtAYoAe4AExozi0UAH21tAaMnBT8CrnIyhrMDhRgDygIBUAEHcoFHUPe8AXBjAewCjgDQR8IICIcEcQLwATXCDgzvHwBmBoHNAqsBdBcUAykgDhAMShskMgo8AY8jqAQfAUAfHw8BDw87MioGlCIPBwZCa4ELatMAAMspJVgsDl8AIhckSg8XAHdvTwBcIQEiDT4OPhUqbyECAEoAS34Aej8Ybx83JgT/Xw8gHxZ/7w8RICxPHA9vBw+Pfw8PHwAPFv+fAsAvCc8vEr8ivwD/EQ8Bol8OEBa/A78hrwAPCU8vESNvvwWfHwNfAVoDHr+ZAAED34YaAdJPAK7PLwSEgDLHAGo1Pz8Pvx9fUwMrpb8O/58VTzAPIBoXIyQJNF8hpwIVAT8YGAUADDNBaX3RAMomJCg9EhUeA29MABsZBTMNJipjOhc19gcIDR8bBwQHEggCWi6DIgLuAQYA+BAFCha3A5XiAEsqM7UFFgFLhAMjFTMYE1Klnw74nRVBG/ASCm0BYRN/BrsU3VoWy+S0vV8LQx+vN8gF2AC2AK5EAWwApgYDKmAAroQ0NDQ0AT+OCg7wAAIHRAbpNgVcBV0APTA5BfbPFgMLzcYL/QqqA82eBALKCjQCjqYCht0/k2+OAsXQAoP3ASTKDgDw6ACKAUYCMpIKJpRaAE4A5womABzZvs0REEKiACIQAd5QdAECAj4Ywg/wGqY2AVgAYADYvAoCGAEubA0gvAY2ALAAbpbvqpyEAGAEpgQAJgAG7gAgAEACmghUFwCqAMpAINQIwC4DthRAAPcycKgApoIdABwBfCisABoATwBqASIAvhnSBP8aH/ECeAKXAq40NjgDBTwFYQU6AXs3oABgAD4XNgmcCY1eCl5tIFZeUqGgyoNHABgAEQAaABNwWQAmABMATPMa3T34ADldyprmM1M2XociUQgLzvwAXT3xABgAEQAaABNwIGFAnADD8AAgAD4BBJWzaCcIAIEBFMAWwKoAAdq9BWAF5wLQpALEtQAKUSGkahR4GnJM+gsAwCgeFAiUAECQ0BQuL8AAIAAAADKeIheclvFqQAAETr4iAMxIARMgAMIoHhQIAn0E0pDQFC4HhznoAAAAIAI2C0/4lvFqQAAETgBJJwYCAy4ABgYAFAA8MBKYEH4eRhTkAjYeFcgACAYAeABsOqyQ5gRwDayqugEgaIIAtgoACgDmEABmBAWGme5OBJJA2m4cDeoAmITWAXwrMgOgAGwBCh6CBXYF1Tzg1wKAAFdiuABRAFwAXQBsAG8AdgBrAHYAbwCEAHEwfxQBVE5TEQADVFhTBwBDANILAqcCzgLTApQCrQL6vAAMAL8APLhNBKkE6glGKTAU4Dr4N2EYEwBCkABKk8rHAbYBmwIoAiU4Ajf/Aq4CowCAANIChzgaNBsCsTgeODcFXrgClQKdAqQBiQGYAqsCsjTsNHsfNPA0ixsAWTWiOAMFPDQSNCk2BDZHNow2TTZUNhk28Jk9VzI3QkEoAoICoQKwAqcAQAAxBV4FXbS9BW47YkIXP1ciUqs05DS/FwABUwJW11e6nHuYZmSh/RAYA8oMKvZ8KASoUAJYWAJ6ILAsAZSoqjpgA0ocBIhmDgDWAAawRDQoAAcuAj5iAHABZiR2AIgiHgCaAU68ACxuHAG0ygM8MiZIAlgBdF4GagJqAPZOHAMuBgoATkYAsABiAHgAMLoGDPj0HpKEBAAOJgAuALggTAHWAeAMEDbd20Uege0ADwAWADkAQgA9OHd+2MUQZBBhBgNNDkxxPxUQArEPqwvqERoM1irQ090ANK4H8ANYB/ADWANYB/AH8ANYB/ADWANYA1gDWBwP8B/YxRBkD00EcgWTBZAE2wiIJk4RhgctCNdUEnQjHEwDSgEBIypJITuYMxAlR0wRTQgIATZHbKx9PQNMMbBU+pCnA9AyVDlxBgMedhKlAC8PeCE1uk6DekxxpQpQT7NX9wBFBgASqwAS5gBJDSgAUCwGPQBI4zTYABNGAE2bAE3KAExdGABKaAbgAFBXAFCOAFBJABI2SWdObALDOq0//QomCZhvwHdTBkIQHCemEPgMNAG2ATwN7kvZBPIGPATKH34ZGg/OlZ0Ipi3eDO4m5C6igFsj9iqEBe5L9TzeC05RaQ9aC2YJ5DpkgU8DIgEOIowK3g06CG4Q9ArKbA3mEUYHOgPWSZsApgcCCxIdNhW2JhFirQsKOXgG/Br3C5AmsBMqev0F1BoiBk4BKhsAANAu6IWxWjJcHU9gBgQLJiPIFKlQIQ0mQLh4SRocBxYlqgKSQ3FKiFE3HpQh9zw+DWcuFFF9B/Y8BhlQC4I8n0asRQ8R0z6OPUkiSkwtBDaALDAnjAnQD4YMunxzAVoJIgmyDHITMhEYN8YIOgcaLpclJxYIIkaWYJsE+KAD9BPSAwwFQAlCBxQDthwuEy8VKgUOgSXYAvQ21i60ApBWgQEYBcwPJh/gEFFH4Q7qCJwCZgOEJewALhUiABginAhEZABgj9lTBi7MCMhqbSN1A2gU6GIRdAeSDlgHqBw0FcAc4nDJXgyGCSiksAlcAXYJmgFgBOQICjVcjKEgQmdUi1kYnCBiQUBd/QIyDGYVoES+h3kCjA9sEhwBNgF0BzoNAgJ4Ee4RbBCWCOyGBTW2M/k6JgRQIYQgEgooA1BszwsoJvoM+WoBpBJjAw00PnfvZ6xgtyUX/gcaMsZBYSHyC5NPzgydGsIYQ1QvGeUHwAP0GvQn60FYBgADpAQUOk4z7wS+C2oIjAlAAEoOpBgH2BhrCnKM0QEyjAG4mgNYkoQCcJAGOAcMAGgMiAV65gAeAqgIpAAGANADWAA6Aq4HngAaAIZCAT4DKDABIuYCkAOUCDLMAZYwAfQqBBzEDBYA+DhuSwLDsgKAa2ajBd5ZAo8CSjYBTiYEBk9IUgOwcuIA3ABMBhTgSAEWrEvMG+REAeBwLADIAPwABjYHBkIBzgH0bgC4AWALMgmjtLYBTuoqAIQAFmwB2AKKAN4ANgCA8gFUAE4FWvoF1AJQSgESMhksWGIBvAMgATQBDgB6BsyOpsoIIARuB9QCEBwV4gLvLwe2AgMi4BPOQsYCvd9WADIXUu5eZwqoCqdeaAC0YTQHMnM9UQAPH6k+yAdy/BZIiQImSwBQ5gBQQzSaNTFWSTYBpwGqKQK38AFtqwBI/wK37gK3rQK3sAK6280C0gK33AK3zxAAUEIAUD9SklKDArekArw5AEQAzAHCO147WTteO1k7XjtZO147WTteO1kDmChYI03AVU0oJqkKbV9GYewMpw3VRMk6ShPcYFJgMxPJLbgUwhXPJVcZPhq9JwYl5VUKDwUt1GYxCC00dhe9AEApaYNCY4ceMQpMHOhTklT5LRwAskujM7ANrRsWREEFSHXuYisWDwojAmSCAmJDXE6wXDchAqH4AmiZAmYKAp+FOBwMAmY8AmYnBG8EgAN/FAN+kzkHOXgYOYM6JCQCbB4CMjc4CwJtyAJtr/CLADRoRiwBaADfAOIASwYHmQyOAP8MwwAOtgJ3MAJ2o0ACeUxEAni7Hl3cRa9G9AJ8QAJ6yQJ9CgJ88UgBSH5kJQAsFklZSlwWGErNAtECAtDNSygDiFADh+dExpEzAvKiXQQDA69Lz0wuJgTQTU1NsAKLQAKK2cIcCB5EaAa4Ao44Ao5dQZiCAo7aAo5deVG1UzYLUtVUhgKT/AKTDQDqAB1VH1WwVdEHLBwplocy4nhnRTw6ApegAu+zWCKpAFomApaQApZ9nQCqWa1aCoJOADwClrYClk9cRVzSApnMApllXMtdCBoCnJw5wzqeApwXAp+cAp65iwAeEDIrEAKd8gKekwC2PmE1YfACntQCoG8BqgKeoCACnk+mY8lkKCYsAiewAiZ/AqD8AqBN2AKmMAKlzwKoAAB+AqfzaH1osgAESmodatICrOQCrK8CrWgCrQMCVx4CVd0CseLYAx9PbJgCsr4OArLpGGzhbWRtSWADJc4Ctl08QG6RAylGArhfArlIFgK5K3hwN3DiAr0aAy2zAzISAr6JcgMDM3ICvhtzI3NQAsPMAsMFc4N0TDZGdOEDPKgDPJsDPcACxX0CxkgCxhGKAshqUgLIRQLJUALJLwJkngLd03h6YniveSZL0QMYpGcDAmH1GfSVJXsMXpNevBICz2wCz20wTFTT9BSgAMeuAs90ASrrA04TfkwGAtwoAtuLAtJQA1JdA1NgAQIDVY2AikABzBfuYUZ2AILPg44C2sgC2d+EEYRKpz0DhqYAMANkD4ZyWvoAVgLfZgLeuXR4AuIw7RUB8zEoAfScAfLTiALr9ALpcXoAAur6AurlAPpIAboC7ooC652Wq5cEAu5AA4XhmHpw4XGiAvMEAGoDjheZlAL3FAORbwOSiAL3mQL52gL4Z5odmqy8OJsfA52EAv77ARwAOp8dn7QDBY4DpmsDptoA0sYDBmuhiaIGCgMMSgFgASACtgNGAJwEgLpoBgC8BGzAEowcggCEDC6kdjoAJAM0C5IKRoABZCgiAIzw3AYBLACkfng9ogigkgNmWAN6AEQCvrkEVqTGAwCsBRbAA+4iQkMCHR072jI2PTbUNsk2RjY5NvA23TZKNiU3EDcZN5I+RTxDRTBCJkK5VBYKFhZfwQCWygU3AJBRHpu+OytgNxa61A40GMsYjsn7BVwFXQVcBV0FaAVdBVwFXQVcBV0FXAVdBVwFXUsaCNyKAK4AAQUHBwKU7oICoW1e7jAEzgPxA+YDwgCkBFDAwADABKzAAOxFLhitA1UFTDeyPkM+bj51QkRCuwTQWWQ8X+0AWBYzsACNA8xwzAGm7EZ/QisoCTAbLDs6fnLfb8H2GccsbgFw13M1HAVkBW/Jxsm9CNRO8E8FDD0FBQw9FkcClOYCoMFegpDfADgcMiA2AJQACB8AsigKAIzIEAJKeBIApY5yPZQIAKQiHb4fvj5BKSRPQrZCOz0oXyxgOywfKAnGbgMClQaCAkILXgdeCD9IIGUgQj5fPoY+dT52Ao5CM0dAX9BTVG9SDzFwWTQAbxBzJF/lOEIQQglCCkKJIAls5AcClQICoKPMODEFxhi6KSAbiyfIRrMjtCgdWCAkPlFBIitCsEJRzAbMAV/OEyQzDg0OAQQEJ36i328/Mk9AybDJsQlq3tDRApUKAkFzXf1d/j9uALYP6hCoFgCTGD8kPsFKQiobrm0+zj0KSD8kPnVCRBwMDyJRTHFgMTJa5rwXQiQ2YfI/JD7BMEJEHGINTw4TOFlIRzwJO0icMQpyPyQ+wzJCRBv6DVgnKB01NgUKj2bwYzMqCoBkznBgEF+zYDIocwRIX+NgHj4HICNfh2C4CwdwFWpTG/lgUhYGAwRfv2Ts8mAaXzVgml/XYIJfuWC4HI1gUF9pYJZgMR6ilQHMAOwLAlDRefC0in4AXAEJA6PjCwc0IamOANMMCAECRQDFNRTZBgd+CwQlRA+r6+gLBDEFBnwUBXgKATIArwAGRAAHA3cDdAN2A3kDdwN9A3oDdQN7A30DfAN4A3oDfQAYEAAlAtYASwMAUAFsAHcKAHcAmgB3AHUAdQB2AHVu8UgAygDAAHcAdQB1AHYAdQALCgB3AAsAmgB3AAsCOwB3AAtu8UgAygDAAHgKAJoAdwB3AHUAdQB2AHUAeAB1AHUAdgB1bvFIAMoAwAALCgCaAHcACwB3AAsCOwB3AAtu8UgAygDAAH4ACwGgALcBpwC6AahdAu0COwLtbvFIAMoAwAALCgCaAu0ACwLtAAsCOwLtAAtu8UgAygDAA24ACwNvAAu0VsQAAzsAABCkjUIpAAsAUIusOggWcgMeBxVsGwL67U/2HlzmWOEeOgALASvuAAseAfpKUpnpGgYJDCIZM6YyARUE9ThqAD5iXQgnAJYJPnOzw0ZAEZxEKsIAkA4DhAHnTAIDxxUDK0lxCQlPYgIvIQVYJQBVqE1GakUAKGYiDToSBA1EtAYAXQJYAIF8GgMHRyAAIAjOe9YncekRAA0KACUrjwE7Ayc6AAYWAqaiKG4McEcqANoN3+Mg9TwCBhIkuCny+JwUQ29L008JluRxu3K+oAdqiHOqFH0AG5SUIfUJ5SxCGfxdipRzqTmT4V5Zb+r1Uo4Vm+NqSSEl2mNvR2JhIa8SpYO6ntdwFXHCWTCK8f2+Hxo7uiG3drDycAuKIMP5bhi06ACnqArH1rz4Rqg//lm6SgJGEVbF9xJHISaR6HxqxSnkw6shDnelHKNEfGUXSJRJ1GcsmtJw25xrZMDK9gXSm1/YMkdX4/6NKYOdtk/NQ3/NnDASjTc3fPjIjW/5sVfVObX2oTDWkr1dF9f3kxBsD3/3aQO8hPfRz+e0uEiJqt1161griu7gz8hDDwtpy+F+BWtefnKHZPAxcZoWbnznhJpy0e842j36bcNzGnIEusgGX0a8ZxsnjcSsPDZ09yZ36fCQbriHeQ72JRMILNl6ePPf2HWoVwgWAm1fb3V2sAY0+B6rAXqSwPBgseVmoqsBTSrm91+XasMYYySI8eeRxH3ZvHkMz3BQ5aJ3iUVbYPNM3/7emRtjlsMgv/9VyTsyt/mK+8fgWeT6SoFaclXqn42dAIsvAarF5vNNWHzKSkKQ/8Hfk5ZWK7r9yliOsooyBjRhfkHP4Q2DkWXQi6FG/9r/IwbmkV5T7JSopHKn1pJwm9tb5Ot0oyN1Z2mPpKXHTxx2nlK08fKk1hEYA8WgVVWL5lgx0iTv+KdojJeU23ZDjmiubXOxVXJKKi2Wjuh2HLZOFLiSC7Tls5SMh4f+Pj6xUSrNjFqLGehRNB8lC0QSLNmkJJx/wSG3MnjE9T1CkPwJI0wH2lfzwETIiVqUxg0dfu5q39Gt+hwdcxkhhNvQ4TyrBceof3Mhs/IxFci1HmHr4FMZgXEEczPiGCx0HRwzAqDq2j9AVm1kwN0mRVLWLylgtoPNapF5cY4Y1wJh/e0BBwZj44YgZrDNqvD/9Hv7GFYdUQeDJuQ3EWI4HaKqavU1XjC/n41kT4L79kqGq0kLhdTZvgP3TA3fS0ozVz+5piZsoOtIvBUFoMKbNcmBL6YxxaUAusHB38XrS8dQMnQwJfUUkpRoGr5AUeWicvBTzyK9g77+yCkf5PAysL7r/JjcZgrbvRpMW9iyaxZvKO6ceZN2EwIxKwVFPuvFuiEPGCoagbMo+SpydLrXqBzNCDGFCrO/rkcwa2xhokQZ5CdZ0AsU3JfSqJ6n5I14YA+P/uAgfhPU84Tlw7cEFfp7AEE8ey4sP12PTt4Cods1GRgDOB5xvyiR5m+Bx8O5nBCNctU8BevfV5A08x6RHd5jcwPTMDSZJOedIZ1cGQ704lxbAzqZOP05ZxaOghzSdvFBHYqomATARyAADK4elP8Ly3IrUZKfWh23Xy20uBUmLS4Pfagu9+oyVa2iPgqRP3F2CTUsvJ7+RYnN8fFZbU/HVvxvcFFDKkiTqV5UBZ3Gz54JAKByi9hkKMZJvuGgcSYXFmw08UyoQyVdfTD1/dMkCHXcTGAKeROgArsvmRrQTLUOXioOHGK2QkjHuoYFgXciZoTJd6Fs5q1QX1G+p/e26hYsEf7QZD1nnIyl/SFkNtYYmmBhpBrxl9WbY0YpHWRuw2Ll/tj9mD8P4snVzJl4F9J+1arVeTb9E5r2ILH04qStjxQNwn3m4YNqxmaNbLAqW2TN6LidwuJRqS+NXbtqxoeDXpxeGWmxzSkWxjkyCkX4NQRme6q5SAcC+M7+9ETfA/EwrzQajKakCwYyeunP6ZFlxU2oMEn1Pz31zeStW74G406ZJFCl1wAXIoUKkWotYEpOuXB1uVNxJ63dpJEqfxBeptwIHNrPz8BllZoIcBoXwgfJ+8VAUnVPvRvexnw0Ma/WiGYuJO5y8QTvEYBigFmhUxY5RqzE8OcywN/8m4UYrlaniJO75XQ6KSo9+tWHlu+hMi0UVdiKQp7NelnoZUzNaIyBPVeOwK6GNp+FfHuPOoyhaWuNvTYFkvxscMQWDh+zeFCFkgwbXftiV23ywJ4+uwRqmg9k3KzwIQpzppt8DBBOMbrqwQM5Gb05sEwdKzMiAqOloaA/lr0KA+1pr0/+HiWoiIjHA/wir2nIuS3PeU/ji3O6ZwoxcR1SZ9FhtLC5S0FIzFhbBWcGVP/KpxOPSiUoAdWUpqKH++6Scz507iCcxYI6rdMBICPJZea7OcmeFw5mObJSiqpjg2UoWNIs+cFhyDSt6geV5qgi3FunmwwDoGSMgerFOZGX1m0dMCYo5XOruxO063dwENK9DbnVM9wYFREzh4vyU1WYYJ/LRRp6oxgjqP/X5a8/4Af6p6NWkQferzBmXme0zY/4nwMJm/wd1tIqSwGz+E3xPEAOoZlJit3XddD7/BT1pllzOx+8bmQtANQ/S6fZexc6qi3W+Q2xcmXTUhuS5mpHQRvcxZUN0S5+PL9lXWUAaRZhEH8hTdAcuNMMCuVNKTEGtSUKNi3O6KhSaTzck8csZ2vWRZ+d7mW8c4IKwXIYd25S/zIftPkwPzufjEvOHWVD1m+FjpDVUTV0DGDuHj6QnaEwLu/dEgdLQOg9E1Sro9XHJ8ykLAwtPu+pxqKDuFexqON1sKQm7rwbE1E68UCfA/erovrTCG+DBSNg0l4goDQvZN6uNlbyLpcZAwj2UclycvLpIZMgv4yRlpb3YuMftozorbcGVHt/VeDV3+Fdf1TP0iuaCsPi2G4XeGhsyF1ubVDxkoJhmniQ0/jSg/eYML9KLfnCFgISWkp91eauR3IQvED0nAPXK+6hPCYs+n3+hCZbiskmVMG2da+0EsZPonUeIY8EbfusQXjsK/eFDaosbPjEfQS0RKG7yj5GG69M7MeO1HmiUYocgygJHL6M1qzUDDwUSmr99V7Sdr2F3JjQAJY+F0yH33Iv3+C9M38eML7gTgmNu/r2bUMiPvpYbZ6v1/IaESirBHNa7mPKn4dEmYg7v/+HQgPN1G79jBQ1+soydfDC2r+h2Bl/KIc5KjMK7OH6nb1jLsNf0EHVe2KBiE51ox636uyG6Lho0t3J34L5QY/ilE3mikaF4HKXG1mG1rCevT1Vv6GavltxoQe/bMrpZvRggnBxSEPEeEzkEdOxTnPXHVjUYdw8JYvjB/o7Eegc3Ma+NUxLLnsK0kJlinPmUHzHGtrk5+CAbVzFOBqpyy3QVUnzTDfC/0XD94/okH+OB+i7g9lolhWIjSnfIb+Eq43ZXOWmwvjyV/qqD+t0e+7mTEM74qP/Ozt8nmC7mRpyu63OB4KnUzFc074SqoyPUAgM+/TJGFo6T44EHnQU4X4z6qannVqgw/U7zCpwcmXV1AubIrvOmkKHazJAR55ePjp5tLBsN8vAqs3NAHdcEHOR2xQ0lsNAFzSUuxFQCFYvXLZJdOj9p4fNq6p0HBGUik2YzaI4xySy91KzhQ0+q1hjxvImRwPRf76tChlRkhRCi74NXZ9qUNeIwP+s5p+3m5nwPdNOHgSLD79n7O9m1n1uDHiMntq4nkYwV5OZ1ENbXxFd4PgrlvavZsyUO4MqYlqqn1O8W/I1dEZq5dXhrbETLaZIbC2Kj/Aa/QM+fqUOHdf0tXAQ1huZ3cmWECWSXy/43j35+Mvq9xws7JKseriZ1pEWKc8qlzNrGPUGcVgOa9cPJYIJsGnJTAUsEcDOEVULO5x0rXBijc1lgXEzQQKhROf8zIV82w8eswc78YX11KYLWQRcgHNJElBxfXr72lS2RBSl07qTKorO2uUDZr3sFhYsvnhLZn0A94KRzJ/7DEGIAhW5ZWFpL8gEwu1aLA9MuWZzNwl8Oze9Y+bX+v9gywRVnoB5I/8kXTXU3141yRLYrIOOz6SOnyHNy4SieqzkBXharjfjqq1q6tklaEbA8Qfm2DaIPs7OTq/nvJBjKfO2H9bH2cCMh1+5gspfycu8f/cuuRmtDjyqZ7uCIMyjdV3a+p3fqmXsRx4C8lujezIFHnQiVTXLXuI1XrwN3+siYYj2HHTvESUx8DlOTXpak9qFRK+L3mgJ1WsD7F4cu1aJoFoYQnu+wGDMOjJM3kiBQWHCcvhJ/HRdxodOQp45YZaOTA22Nb4XKCVxqkbwMYFhzYQYIAnCW8FW14uf98jhUG2zrKhQQ0q0CEq0t5nXyvUyvR8DvD69LU+g3i+HFWQMQ8PqZuHD+sNKAV0+M6EJC0szq7rEr7B5bQ8BcNHzvDMc9eqB5ZCQdTf80Obn4uzjwpYU7SISdtV0QGa9D3Wrh2BDQtpBKxaNFV+/Cy2P/Sv+8s7Ud0Fd74X4+o/TNztWgETUapy+majNQ68Lq3ee0ZO48VEbTZYiH1Co4OlfWef82RWeyUXo7woM03PyapGfikTnQinoNq5z5veLpeMV3HCAMTaZmA1oGLAn7XS3XYsz+XK7VMQsc4XKrmDXOLU/pSXVNUq8dIqTba///3x6LiLS6xs1xuCAYSfcQ3+rQgmu7uvf3THKt5Ooo97TqcbRqxx7EASizaQCBQllG/rYxVapMLgtLbZS64w1MDBMXX+PQpBKNwqUKOf2DDRDUXQf9EhOS0Qj4nTmlA8dzSLz/G1d+Ud8MTy/6ghhdiLpeerGY/UlDOfiuqFsMUU5/UYlP+BAmgRLuNpvrUaLlVkrqDievNVEAwF+4CoM1MZTmjxjJMsKJq+u8Zd7tNCUFy6LiyYXRJQ4VyvEQFFaCGKsxIwQkk7EzZ6LTJq2hUuPhvAW+gQnSG6J+MszC+7QCRHcnqDdyNRJ6T9xyS87A6MDutbzKGvGktpbXqtzWtXb9HsfK2cBMomjN9a4y+TaJLnXxAeX/HWzmf4cR4vALt/P4w4qgKY04ml4ZdLOinFYS6cup3G/1ie4+t1eOnpBNlqGqs75ilzkT4+DsZQxNvaSKJ//6zIbbk/M7LOhFmRc/1R+kBtz7JFGdZm/COotIdvQoXpTqP/1uqEUmCb/QWoGLMwO5ANcHzxdY48IGP5+J+zKOTBFZ4Pid+GTM+Wq12MV/H86xEJptBa6T+p3kgpwLedManBHC2GgNrFpoN2xnrMz9WFWX/8/ygSBkavq2Uv7FdCsLEYLu9LLIvAU0bNRDtzYl+/vXmjpIvuJFYjmI0im6QEYqnIeMsNjXG4vIutIGHijeAG/9EDBozKV5cldkHbLxHh25vT+ZEzbhXlqvpzKJwcEgfNwLAKFeo0/pvEE10XDB+EXRTXtSzJozQKFFAJhMxYkVaCW+E9AL7tMeU8acxidHqzb6lX4691UsDpy/LLRmT+epgW56+5Cw8tB4kMUv6s9lh3eRKbyGs+H/4mQMaYzPTf2OOdokEn+zzgvoD3FqNKk8QqGAXVsqcGdXrT62fSPkR2vROFi68A6se86UxRUk4cajfPyCC4G5wDhD+zNq4jodQ4u4n/m37Lr36n4LIAAsVr02dFi9AiwA81MYs2rm4eDlDNmdMRvEKRHfBwW5DdMNp0jPFZMeARqF/wL4XBfd+EMLBfMzpH5GH6NaW+1vrvMdg+VxDzatk3MXgO3ro3P/DpcC6+Mo4MySJhKJhSR01SGGGp5hPWmrrUgrv3lDnP+HhcI3nt3YqBoVAVTBAQT5iuhTg8nvPtd8ZeYj6w1x6RqGUBrSku7+N1+BaasZvjTk64RoIDlL8brpEcJx3OmY7jLoZsswdtmhfC/G21llXhITOwmvRDDeTTPbyASOa16cF5/A1fZAidJpqju3wYAy9avPR1ya6eNp9K8XYrrtuxlqi+bDKwlfrYdR0RRiKRVTLOH85+ZY7XSmzRpfZBJjaTa81VDcJHpZnZnSQLASGYW9l51ZV/h7eVzTi3Hv6hUsgc/51AqJRTkpbFVLXXszoBL8nBX0u/0jBLT8nH+fJePbrwURT58OY+UieRjd1vs04w0VG5VN2U6MoGZkQzKN/ptz0Q366dxoTGmj7i1NQGHi9GgnquXFYdrCfZBmeb7s0T6yrdlZH5cZuwHFyIJ/kAtGsTg0xH5taAAq44BAk1CPk9KVVbqQzrCUiFdF/6gtlPQ8bHHc1G1W92MXGZ5HEHftyLYs8mbD/9xYRUWkHmlM0zC2ilJlnNgV4bfALpQghxOUoZL7VTqtCHIaQSXm+YUMnpkXybnV+A6xlm2CVy8fn0Xlm2XRa0+zzOa21JWWmixfiPMSCZ7qA4rS93VN3pkpF1s5TonQjisHf7iU9ZGvUPOAKZcR1pbeVf/Ul7OhepGCaId9wOtqo7pJ7yLcBZ0pFkOF28y4zEI/kcUNmutBHaQpBdNM8vjCS6HZRokkeo88TBAjGyG7SR+6vUgTcyK9Imalj0kuxz0wmK+byQU11AiJFk/ya5dNduRClcnU64yGu/ieWSeOos1t3ep+RPIWQ2pyTYVbZltTbsb7NiwSi3AV+8KLWk7LxCnfZUetEM8ThnsSoGH38/nyAwFguJp8FjvlHtcWZuU4hPva0rHfr0UhOOJ/F6vS62FW7KzkmRll2HEc7oUq4fyi5T70Vl7YVIfsPHUCdHesf9Lk7WNVWO75JDkYbMI8TOW8JKVtLY9d6UJRITO8oKo0xS+o99Yy04iniGHAaGj88kEWgwv0OrHdY/nr76DOGNS59hXCGXzTKUvDl9iKpLSWYN1lxIeyywdNpTkhay74w2jFT6NS8qkjo5CxA1yfSYwp6AJIZNKIeEK5PJAW7ORgWgwp0VgzYpqovMrWxbu+DGZ6Lhie1RAqpzm8VUzKJOH3mCzWuTOLsN3VT/dv2eeYe9UjbR8YTBsLz7q60VN1sU51k+um1f8JxD5pPhbhSC8rRaB454tmh6YUWrJI3+GWY0qeWioj/tbkYITOkJaeuGt4JrJvHA+l0Gu7kY7XOaa05alMnRWVCXqFgLIwSY4uF59Ue5SU4QKuc/HamDxbr0x6csCetXGoP7Qn1Bk/J9DsynO/UD6iZ1Hyrz+jit0hDCwi/E9OjgKTbB3ZQKQ/0ZOvevfNHG0NK4Aj3Cp7NpRk07RT1i/S0EL93Ag8GRgKI9CfpajKyK6+Jj/PI1KO5/85VAwz2AwzP8FTBb075IxCXv6T9RVvWT2tUaqxDS92zrGUbWzUYk9mSs82pECH+fkqsDt93VW++4YsR/dHCYcQSYTO/KaBMDj9LSD/J/+z20Kq8XvZUAIHtm9hRPP3ItbuAu2Hm5lkPs92pd7kCxgRs0xOVBnZ13ccdA0aunrwv9SdqElJRC3g+oCu+nXyCgmXUs9yMjTMAIHfxZV+aPKcZeUBWt057Xo85Ks1Ir5gzEHCWqZEhrLZMuF11ziGtFQUds/EESajhagzcKsxamcSZxGth4UII+adPhQkUnx2WyN+4YWR+r3f8MnkyGFuR4zjzxJS8WsQYR5PTyRaD9ixa6Mh741nBHbzfjXHskGDq179xaRNrCIB1z1xRfWfjqw2pHc1zk9xlPpL8sQWAIuETZZhbnmL54rceXVNRvUiKrrqIkeogsl0XXb17ylNb0f4GA9Wd44vffEG8FSZGHEL2fbaTGRcSiCeA8PmA/f6Hz8HCS76fXUHwgwkzSwlI71ekZ7Fapmlk/KC+Hs8hUcw3N2LN5LhkVYyizYFl/uPeVP5lsoJHhhfWvvSWruCUW1ZcJOeuTbrDgywJ/qG07gZJplnTvLcYdNaH0KMYOYMGX+rB4NGPFmQsNaIwlWrfCezxre8zXBrsMT+edVLbLqN1BqB76JH4BvZTqUIMfGwPGEn+EnmTV86fPBaYbFL3DFEhjB45CewkXEAtJxk4/Ms2pPXnaRqdky0HOYdcUcE2zcXq4vaIvW2/v0nHFJH2XXe22ueDmq/18XGtELSq85j9X8q0tcNSSKJIX8FTuJF/Pf8j5PhqG2u+osvsLxYrvvfeVJL+4tkcXcr9JV7v0ERmj/X6fM3NC4j6dS1+9Umr2oPavqiAydTZPLMNRGY23LO9zAVDly7jD+70G5TPPLdhRIl4WxcYjLnM+SNcJ26FOrkrISUtPObIz5Zb3AG612krnpy15RMW+1cQjlnWFI6538qky9axd2oJmHIHP08KyP0ubGO+TQNOYuv2uh17yCIvR8VcStw7o1g0NM60sk+8Tq7YfIBJrtp53GkvzXH7OA0p8/n/u1satf/VJhtR1l8Wa6Gmaug7haSpaCaYQax6ta0mkutlb+eAOSG1aobM81D9A4iS1RRlzBBoVX6tU1S6WE2N9ORY6DfeLRC4l9Rvr5h95XDWB2mR1d4WFudpsgVYwiTwT31ljskD8ZyDOlm5DkGh9N/UB/0AI5Xvb8ZBmai2hQ4BWMqFwYnzxwB26YHSOv9WgY3JXnvoN+2R4rqGVh/LLDMtpFP+SpMGJNWvbIl5SOodbCczW2RKleksPoUeGEzrjtKHVdtZA+kfqO+rVx/iclCqwoopepvJpSTDjT+b9GWylGRF8EDbGlw6eUzmJM95Ovoz+kwLX3c2fTjFeYEsE7vUZm3mqdGJuKh2w9/QGSaqRHs99aScGOdDqkFcACoqdbBoQqqjamhH6Q9ng39JCg3lrGJwd50Qk9ovnqBTr8MME7Ps2wiVfygUmPoUBJJfJWX5Nda0nuncbFkA=="))}const Go=B2();new Set(da(Go)),new Set(da(Go)),O2(Go),q2(Go);const k2=new Uint8Array(32);k2.fill(0);const U2=`Ethereum Signed Message:
`;function Cd(i){return typeof i=="string"&&(i=zh(i)),Fc(f2([zh(U2),zh(String(i.length)),i]))}const $2="address/5.7.0",Gn=new Ue($2);function Uf(i){vr(i,20)||Gn.throwArgumentError("invalid address","address",i),i=i.toLowerCase();const t=i.substring(2).split(""),e=new Uint8Array(40);for(let o=0;o<40;o++)e[o]=t[o].charCodeAt(0);const s=Ie(Fc(e));for(let o=0;o<40;o+=2)s[o>>1]>>4>=8&&(t[o]=t[o].toUpperCase()),(s[o>>1]&15)>=8&&(t[o+1]=t[o+1].toUpperCase());return"0x"+t.join("")}const j2=9007199254740991;function z2(i){return Math.log10?Math.log10(i):Math.log(i)/Math.LN10}const Bc={};for(let i=0;i<10;i++)Bc[String(i)]=String(i);for(let i=0;i<26;i++)Bc[String.fromCharCode(65+i)]=String(10+i);const $f=Math.floor(z2(j2));function L2(i){i=i.toUpperCase(),i=i.substring(4)+i.substring(0,2)+"00";let t=i.split("").map(s=>Bc[s]).join("");for(;t.length>=$f;){let s=t.substring(0,$f);t=parseInt(s,10)%97+t.substring(s.length)}let e=String(98-parseInt(t,10)%97);for(;e.length<2;)e="0"+e;return e}function H2(i){let t=null;if(typeof i!="string"&&Gn.throwArgumentError("invalid address","address",i),i.match(/^(0x)?[0-9a-fA-F]{40}$/))i.substring(0,2)!=="0x"&&(i="0x"+i),t=Uf(i),i.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&t!==i&&Gn.throwArgumentError("bad address checksum","address",i);else if(i.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(i.substring(2,4)!==L2(i)&&Gn.throwArgumentError("bad icap checksum","address",i),t=w2(i.substring(4));t.length<40;)t="0"+t;t=Uf("0x"+t)}else Gn.throwArgumentError("invalid address","address",i);return t}function Un(i,t,e){Object.defineProperty(i,t,{enumerable:!0,value:e,writable:!1})}const K2=new Uint8Array(32);K2.fill(0),Ze.from(-1);const V2=Ze.from(0),Q2=Ze.from(1);Ze.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),mi(Q2.toHexString(),32),mi(V2.toHexString(),32);var ui={},Ct={},so=Rd;function Rd(i,t){if(!i)throw new Error(t||"Assertion failed")}Rd.equal=function(i,t,e){if(i!=t)throw new Error(e||"Assertion failed: "+i+" != "+t)};var gc={exports:{}};typeof Object.create=="function"?gc.exports=function(i,t){t&&(i.super_=t,i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}))}:gc.exports=function(i,t){if(t){i.super_=t;var e=function(){};e.prototype=t.prototype,i.prototype=new e,i.prototype.constructor=i}};var G2=so,J2=gc.exports;Ct.inherits=J2;function Y2(i,t){return(i.charCodeAt(t)&64512)!==55296||t<0||t+1>=i.length?!1:(i.charCodeAt(t+1)&64512)===56320}function W2(i,t){if(Array.isArray(i))return i.slice();if(!i)return[];var e=[];if(typeof i=="string")if(t){if(t==="hex")for(i=i.replace(/[^a-z0-9]+/ig,""),i.length%2!==0&&(i="0"+i),o=0;o<i.length;o+=2)e.push(parseInt(i[o]+i[o+1],16))}else for(var s=0,o=0;o<i.length;o++){var a=i.charCodeAt(o);a<128?e[s++]=a:a<2048?(e[s++]=a>>6|192,e[s++]=a&63|128):Y2(i,o)?(a=65536+((a&1023)<<10)+(i.charCodeAt(++o)&1023),e[s++]=a>>18|240,e[s++]=a>>12&63|128,e[s++]=a>>6&63|128,e[s++]=a&63|128):(e[s++]=a>>12|224,e[s++]=a>>6&63|128,e[s++]=a&63|128)}else for(o=0;o<i.length;o++)e[o]=i[o]|0;return e}Ct.toArray=W2;function X2(i){for(var t="",e=0;e<i.length;e++)t+=xd(i[e].toString(16));return t}Ct.toHex=X2;function Nd(i){var t=i>>>24|i>>>8&65280|i<<8&16711680|(i&255)<<24;return t>>>0}Ct.htonl=Nd;function Z2(i,t){for(var e="",s=0;s<i.length;s++){var o=i[s];t==="little"&&(o=Nd(o)),e+=Od(o.toString(16))}return e}Ct.toHex32=Z2;function xd(i){return i.length===1?"0"+i:i}Ct.zero2=xd;function Od(i){return i.length===7?"0"+i:i.length===6?"00"+i:i.length===5?"000"+i:i.length===4?"0000"+i:i.length===3?"00000"+i:i.length===2?"000000"+i:i.length===1?"0000000"+i:i}Ct.zero8=Od;function t3(i,t,e,s){var o=e-t;G2(o%4===0);for(var a=new Array(o/4),u=0,d=t;u<a.length;u++,d+=4){var y;s==="big"?y=i[d]<<24|i[d+1]<<16|i[d+2]<<8|i[d+3]:y=i[d+3]<<24|i[d+2]<<16|i[d+1]<<8|i[d],a[u]=y>>>0}return a}Ct.join32=t3;function e3(i,t){for(var e=new Array(i.length*4),s=0,o=0;s<i.length;s++,o+=4){var a=i[s];t==="big"?(e[o]=a>>>24,e[o+1]=a>>>16&255,e[o+2]=a>>>8&255,e[o+3]=a&255):(e[o+3]=a>>>24,e[o+2]=a>>>16&255,e[o+1]=a>>>8&255,e[o]=a&255)}return e}Ct.split32=e3;function r3(i,t){return i>>>t|i<<32-t}Ct.rotr32=r3;function i3(i,t){return i<<t|i>>>32-t}Ct.rotl32=i3;function s3(i,t){return i+t>>>0}Ct.sum32=s3;function n3(i,t,e){return i+t+e>>>0}Ct.sum32_3=n3;function o3(i,t,e,s){return i+t+e+s>>>0}Ct.sum32_4=o3;function a3(i,t,e,s,o){return i+t+e+s+o>>>0}Ct.sum32_5=a3;function h3(i,t,e,s){var o=i[t],a=i[t+1],u=s+a>>>0,d=(u<s?1:0)+e+o;i[t]=d>>>0,i[t+1]=u}Ct.sum64=h3;function c3(i,t,e,s){var o=t+s>>>0,a=(o<t?1:0)+i+e;return a>>>0}Ct.sum64_hi=c3;function u3(i,t,e,s){var o=t+s;return o>>>0}Ct.sum64_lo=u3;function l3(i,t,e,s,o,a,u,d){var y=0,b=t;b=b+s>>>0,y+=b<t?1:0,b=b+a>>>0,y+=b<a?1:0,b=b+d>>>0,y+=b<d?1:0;var C=i+e+o+u+y;return C>>>0}Ct.sum64_4_hi=l3;function f3(i,t,e,s,o,a,u,d){var y=t+s+a+d;return y>>>0}Ct.sum64_4_lo=f3;function p3(i,t,e,s,o,a,u,d,y,b){var C=0,P=t;P=P+s>>>0,C+=P<t?1:0,P=P+a>>>0,C+=P<a?1:0,P=P+d>>>0,C+=P<d?1:0,P=P+b>>>0,C+=P<b?1:0;var O=i+e+o+u+y+C;return O>>>0}Ct.sum64_5_hi=p3;function d3(i,t,e,s,o,a,u,d,y,b){var C=t+s+a+d+b;return C>>>0}Ct.sum64_5_lo=d3;function g3(i,t,e){var s=t<<32-e|i>>>e;return s>>>0}Ct.rotr64_hi=g3;function m3(i,t,e){var s=i<<32-e|t>>>e;return s>>>0}Ct.rotr64_lo=m3;function v3(i,t,e){return i>>>e}Ct.shr64_hi=v3;function y3(i,t,e){var s=i<<32-e|t>>>e;return s>>>0}Ct.shr64_lo=y3;var ln={},jf=Ct,w3=so;function Jo(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}ln.BlockHash=Jo,Jo.prototype.update=function(i,t){if(i=jf.toArray(i,t),this.pending?this.pending=this.pending.concat(i):this.pending=i,this.pendingTotal+=i.length,this.pending.length>=this._delta8){i=this.pending;var e=i.length%this._delta8;this.pending=i.slice(i.length-e,i.length),this.pending.length===0&&(this.pending=null),i=jf.join32(i,0,i.length-e,this.endian);for(var s=0;s<i.length;s+=this._delta32)this._update(i,s,s+this._delta32)}return this},Jo.prototype.digest=function(i){return this.update(this._pad()),w3(this.pending===null),this._digest(i)},Jo.prototype._pad=function(){var i=this.pendingTotal,t=this._delta8,e=t-(i+this.padLength)%t,s=new Array(e+this.padLength);s[0]=128;for(var o=1;o<e;o++)s[o]=0;if(i<<=3,this.endian==="big"){for(var a=8;a<this.padLength;a++)s[o++]=0;s[o++]=0,s[o++]=0,s[o++]=0,s[o++]=0,s[o++]=i>>>24&255,s[o++]=i>>>16&255,s[o++]=i>>>8&255,s[o++]=i&255}else for(s[o++]=i&255,s[o++]=i>>>8&255,s[o++]=i>>>16&255,s[o++]=i>>>24&255,s[o++]=0,s[o++]=0,s[o++]=0,s[o++]=0,a=8;a<this.padLength;a++)s[o++]=0;return s};var Ws={},Ai={},b3=Ct,vi=b3.rotr32;function A3(i,t,e,s){if(i===0)return Td(t,e,s);if(i===1||i===3)return Fd(t,e,s);if(i===2)return Dd(t,e,s)}Ai.ft_1=A3;function Td(i,t,e){return i&t^~i&e}Ai.ch32=Td;function Dd(i,t,e){return i&t^i&e^t&e}Ai.maj32=Dd;function Fd(i,t,e){return i^t^e}Ai.p32=Fd;function E3(i){return vi(i,2)^vi(i,13)^vi(i,22)}Ai.s0_256=E3;function _3(i){return vi(i,6)^vi(i,11)^vi(i,25)}Ai.s1_256=_3;function I3(i){return vi(i,7)^vi(i,18)^i>>>3}Ai.g0_256=I3;function S3(i){return vi(i,17)^vi(i,19)^i>>>10}Ai.g1_256=S3;var on=Ct,P3=ln,M3=Ai,Hh=on.rotl32,$n=on.sum32,C3=on.sum32_5,R3=M3.ft_1,qd=P3.BlockHash,N3=[1518500249,1859775393,2400959708,3395469782];function pi(){if(!(this instanceof pi))return new pi;qd.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}on.inherits(pi,qd);var x3=pi;pi.blockSize=512,pi.outSize=160,pi.hmacStrength=80,pi.padLength=64,pi.prototype._update=function(i,t){for(var e=this.W,s=0;s<16;s++)e[s]=i[t+s];for(;s<e.length;s++)e[s]=Hh(e[s-3]^e[s-8]^e[s-14]^e[s-16],1);var o=this.h[0],a=this.h[1],u=this.h[2],d=this.h[3],y=this.h[4];for(s=0;s<e.length;s++){var b=~~(s/20),C=C3(Hh(o,5),R3(b,a,u,d),y,e[s],N3[b]);y=d,d=u,u=Hh(a,30),a=o,o=C}this.h[0]=$n(this.h[0],o),this.h[1]=$n(this.h[1],a),this.h[2]=$n(this.h[2],u),this.h[3]=$n(this.h[3],d),this.h[4]=$n(this.h[4],y)},pi.prototype._digest=function(i){return i==="hex"?on.toHex32(this.h,"big"):on.split32(this.h,"big")};var an=Ct,O3=ln,fn=Ai,T3=so,Hr=an.sum32,D3=an.sum32_4,F3=an.sum32_5,q3=fn.ch32,B3=fn.maj32,k3=fn.s0_256,U3=fn.s1_256,$3=fn.g0_256,j3=fn.g1_256,Bd=O3.BlockHash,z3=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function di(){if(!(this instanceof di))return new di;Bd.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=z3,this.W=new Array(64)}an.inherits(di,Bd);var kd=di;di.blockSize=512,di.outSize=256,di.hmacStrength=192,di.padLength=64,di.prototype._update=function(i,t){for(var e=this.W,s=0;s<16;s++)e[s]=i[t+s];for(;s<e.length;s++)e[s]=D3(j3(e[s-2]),e[s-7],$3(e[s-15]),e[s-16]);var o=this.h[0],a=this.h[1],u=this.h[2],d=this.h[3],y=this.h[4],b=this.h[5],C=this.h[6],P=this.h[7];for(T3(this.k.length===e.length),s=0;s<e.length;s++){var O=F3(P,U3(y),q3(y,b,C),this.k[s],e[s]),F=Hr(k3(o),B3(o,a,u));P=C,C=b,b=y,y=Hr(d,O),d=u,u=a,a=o,o=Hr(O,F)}this.h[0]=Hr(this.h[0],o),this.h[1]=Hr(this.h[1],a),this.h[2]=Hr(this.h[2],u),this.h[3]=Hr(this.h[3],d),this.h[4]=Hr(this.h[4],y),this.h[5]=Hr(this.h[5],b),this.h[6]=Hr(this.h[6],C),this.h[7]=Hr(this.h[7],P)},di.prototype._digest=function(i){return i==="hex"?an.toHex32(this.h,"big"):an.split32(this.h,"big")};var mc=Ct,Ud=kd;function zi(){if(!(this instanceof zi))return new zi;Ud.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}mc.inherits(zi,Ud);var L3=zi;zi.blockSize=512,zi.outSize=224,zi.hmacStrength=192,zi.padLength=64,zi.prototype._digest=function(i){return i==="hex"?mc.toHex32(this.h.slice(0,7),"big"):mc.split32(this.h.slice(0,7),"big")};var or=Ct,H3=ln,K3=so,yi=or.rotr64_hi,wi=or.rotr64_lo,$d=or.shr64_hi,jd=or.shr64_lo,is=or.sum64,Kh=or.sum64_hi,Vh=or.sum64_lo,V3=or.sum64_4_hi,Q3=or.sum64_4_lo,G3=or.sum64_5_hi,J3=or.sum64_5_lo,zd=H3.BlockHash,Y3=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Jr(){if(!(this instanceof Jr))return new Jr;zd.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=Y3,this.W=new Array(160)}or.inherits(Jr,zd);var Ld=Jr;Jr.blockSize=1024,Jr.outSize=512,Jr.hmacStrength=192,Jr.padLength=128,Jr.prototype._prepareBlock=function(i,t){for(var e=this.W,s=0;s<32;s++)e[s]=i[t+s];for(;s<e.length;s+=2){var o=aA(e[s-4],e[s-3]),a=hA(e[s-4],e[s-3]),u=e[s-14],d=e[s-13],y=nA(e[s-30],e[s-29]),b=oA(e[s-30],e[s-29]),C=e[s-32],P=e[s-31];e[s]=V3(o,a,u,d,y,b,C,P),e[s+1]=Q3(o,a,u,d,y,b,C,P)}},Jr.prototype._update=function(i,t){this._prepareBlock(i,t);var e=this.W,s=this.h[0],o=this.h[1],a=this.h[2],u=this.h[3],d=this.h[4],y=this.h[5],b=this.h[6],C=this.h[7],P=this.h[8],O=this.h[9],F=this.h[10],q=this.h[11],H=this.h[12],V=this.h[13],Y=this.h[14],ct=this.h[15];K3(this.k.length===e.length);for(var at=0;at<e.length;at+=2){var it=Y,rt=ct,ht=iA(P,O),gt=sA(P,O),ut=W3(P,O,F,q,H),Ot=X3(P,O,F,q,H,V),Ae=this.k[at],yt=this.k[at+1],Jt=e[at],c=e[at+1],f=G3(it,rt,ht,gt,ut,Ot,Ae,yt,Jt,c),g=J3(it,rt,ht,gt,ut,Ot,Ae,yt,Jt,c);it=eA(s,o),rt=rA(s,o),ht=Z3(s,o,a,u,d),gt=tA(s,o,a,u,d,y);var E=Kh(it,rt,ht,gt),S=Vh(it,rt,ht,gt);Y=H,ct=V,H=F,V=q,F=P,q=O,P=Kh(b,C,f,g),O=Vh(C,C,f,g),b=d,C=y,d=a,y=u,a=s,u=o,s=Kh(f,g,E,S),o=Vh(f,g,E,S)}is(this.h,0,s,o),is(this.h,2,a,u),is(this.h,4,d,y),is(this.h,6,b,C),is(this.h,8,P,O),is(this.h,10,F,q),is(this.h,12,H,V),is(this.h,14,Y,ct)},Jr.prototype._digest=function(i){return i==="hex"?or.toHex32(this.h,"big"):or.split32(this.h,"big")};function W3(i,t,e,s,o){var a=i&e^~i&o;return a<0&&(a+=4294967296),a}function X3(i,t,e,s,o,a){var u=t&s^~t&a;return u<0&&(u+=4294967296),u}function Z3(i,t,e,s,o){var a=i&e^i&o^e&o;return a<0&&(a+=4294967296),a}function tA(i,t,e,s,o,a){var u=t&s^t&a^s&a;return u<0&&(u+=4294967296),u}function eA(i,t){var e=yi(i,t,28),s=yi(t,i,2),o=yi(t,i,7),a=e^s^o;return a<0&&(a+=4294967296),a}function rA(i,t){var e=wi(i,t,28),s=wi(t,i,2),o=wi(t,i,7),a=e^s^o;return a<0&&(a+=4294967296),a}function iA(i,t){var e=yi(i,t,14),s=yi(i,t,18),o=yi(t,i,9),a=e^s^o;return a<0&&(a+=4294967296),a}function sA(i,t){var e=wi(i,t,14),s=wi(i,t,18),o=wi(t,i,9),a=e^s^o;return a<0&&(a+=4294967296),a}function nA(i,t){var e=yi(i,t,1),s=yi(i,t,8),o=$d(i,t,7),a=e^s^o;return a<0&&(a+=4294967296),a}function oA(i,t){var e=wi(i,t,1),s=wi(i,t,8),o=jd(i,t,7),a=e^s^o;return a<0&&(a+=4294967296),a}function aA(i,t){var e=yi(i,t,19),s=yi(t,i,29),o=$d(i,t,6),a=e^s^o;return a<0&&(a+=4294967296),a}function hA(i,t){var e=wi(i,t,19),s=wi(t,i,29),o=jd(i,t,6),a=e^s^o;return a<0&&(a+=4294967296),a}var vc=Ct,Hd=Ld;function Li(){if(!(this instanceof Li))return new Li;Hd.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}vc.inherits(Li,Hd);var cA=Li;Li.blockSize=1024,Li.outSize=384,Li.hmacStrength=192,Li.padLength=128,Li.prototype._digest=function(i){return i==="hex"?vc.toHex32(this.h.slice(0,12),"big"):vc.split32(this.h.slice(0,12),"big")},Ws.sha1=x3,Ws.sha224=L3,Ws.sha256=kd,Ws.sha384=cA,Ws.sha512=Ld;var Kd={},Ss=Ct,uA=ln,Yo=Ss.rotl32,zf=Ss.sum32,jn=Ss.sum32_3,Lf=Ss.sum32_4,Vd=uA.BlockHash;function li(){if(!(this instanceof li))return new li;Vd.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}Ss.inherits(li,Vd),Kd.ripemd160=li,li.blockSize=512,li.outSize=160,li.hmacStrength=192,li.padLength=64,li.prototype._update=function(i,t){for(var e=this.h[0],s=this.h[1],o=this.h[2],a=this.h[3],u=this.h[4],d=e,y=s,b=o,C=a,P=u,O=0;O<80;O++){var F=zf(Yo(Lf(e,Hf(O,s,o,a),i[pA[O]+t],lA(O)),gA[O]),u);e=u,u=a,a=Yo(o,10),o=s,s=F,F=zf(Yo(Lf(d,Hf(79-O,y,b,C),i[dA[O]+t],fA(O)),mA[O]),P),d=P,P=C,C=Yo(b,10),b=y,y=F}F=jn(this.h[1],o,C),this.h[1]=jn(this.h[2],a,P),this.h[2]=jn(this.h[3],u,d),this.h[3]=jn(this.h[4],e,y),this.h[4]=jn(this.h[0],s,b),this.h[0]=F},li.prototype._digest=function(i){return i==="hex"?Ss.toHex32(this.h,"little"):Ss.split32(this.h,"little")};function Hf(i,t,e,s){return i<=15?t^e^s:i<=31?t&e|~t&s:i<=47?(t|~e)^s:i<=63?t&s|e&~s:t^(e|~s)}function lA(i){return i<=15?0:i<=31?1518500249:i<=47?1859775393:i<=63?2400959708:2840853838}function fA(i){return i<=15?1352829926:i<=31?1548603684:i<=47?1836072691:i<=63?2053994217:0}var pA=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],dA=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],gA=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],mA=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],vA=Ct,yA=so;function nn(i,t,e){if(!(this instanceof nn))return new nn(i,t,e);this.Hash=i,this.blockSize=i.blockSize/8,this.outSize=i.outSize/8,this.inner=null,this.outer=null,this._init(vA.toArray(t,e))}var wA=nn;nn.prototype._init=function(i){i.length>this.blockSize&&(i=new this.Hash().update(i).digest()),yA(i.length<=this.blockSize);for(var t=i.length;t<this.blockSize;t++)i.push(0);for(t=0;t<i.length;t++)i[t]^=54;for(this.inner=new this.Hash().update(i),t=0;t<i.length;t++)i[t]^=106;this.outer=new this.Hash().update(i)},nn.prototype.update=function(i,t){return this.inner.update(i,t),this},nn.prototype.digest=function(i){return this.outer.update(this.inner.digest()),this.outer.digest(i)},function(i){var t=i;t.utils=Ct,t.common=ln,t.sha=Ws,t.ripemd=Kd,t.hmac=wA,t.sha1=t.sha.sha1,t.sha256=t.sha.sha256,t.sha224=t.sha.sha224,t.sha384=t.sha.sha384,t.sha512=t.sha.sha512,t.ripemd160=t.ripemd.ripemd160}(ui);function pn(i,t,e){return e={path:t,exports:{},require:function(s,o){return bA(s,o??e.path)}},i(e,e.exports),e.exports}function bA(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var kc=Qd;function Qd(i,t){if(!i)throw new Error(t||"Assertion failed")}Qd.equal=function(i,t,e){if(i!=t)throw new Error(e||"Assertion failed: "+i+" != "+t)};var Wr=pn(function(i,t){var e=t;function s(u,d){if(Array.isArray(u))return u.slice();if(!u)return[];var y=[];if(typeof u!="string"){for(var b=0;b<u.length;b++)y[b]=u[b]|0;return y}if(d==="hex"){u=u.replace(/[^a-z0-9]+/ig,""),u.length%2!==0&&(u="0"+u);for(var b=0;b<u.length;b+=2)y.push(parseInt(u[b]+u[b+1],16))}else for(var b=0;b<u.length;b++){var C=u.charCodeAt(b),P=C>>8,O=C&255;P?y.push(P,O):y.push(O)}return y}e.toArray=s;function o(u){return u.length===1?"0"+u:u}e.zero2=o;function a(u){for(var d="",y=0;y<u.length;y++)d+=o(u[y].toString(16));return d}e.toHex=a,e.encode=function(u,d){return d==="hex"?a(u):u}}),yr=pn(function(i,t){var e=t;e.assert=kc,e.toArray=Wr.toArray,e.zero2=Wr.zero2,e.toHex=Wr.toHex,e.encode=Wr.encode;function s(y,b,C){var P=new Array(Math.max(y.bitLength(),C)+1);P.fill(0);for(var O=1<<b+1,F=y.clone(),q=0;q<P.length;q++){var H,V=F.andln(O-1);F.isOdd()?(V>(O>>1)-1?H=(O>>1)-V:H=V,F.isubn(H)):H=0,P[q]=H,F.iushrn(1)}return P}e.getNAF=s;function o(y,b){var C=[[],[]];y=y.clone(),b=b.clone();for(var P=0,O=0,F;y.cmpn(-P)>0||b.cmpn(-O)>0;){var q=y.andln(3)+P&3,H=b.andln(3)+O&3;q===3&&(q=-1),H===3&&(H=-1);var V;q&1?(F=y.andln(7)+P&7,(F===3||F===5)&&H===2?V=-q:V=q):V=0,C[0].push(V);var Y;H&1?(F=b.andln(7)+O&7,(F===3||F===5)&&q===2?Y=-H:Y=H):Y=0,C[1].push(Y),2*P===V+1&&(P=1-P),2*O===Y+1&&(O=1-O),y.iushrn(1),b.iushrn(1)}return C}e.getJSF=o;function a(y,b,C){var P="_"+b;y.prototype[b]=function(){return this[P]!==void 0?this[P]:this[P]=C.call(this)}}e.cachedProperty=a;function u(y){return typeof y=="string"?e.toArray(y,"hex"):y}e.parseBytes=u;function d(y){return new bt(y,"hex","le")}e.intFromLE=d}),Wo=yr.getNAF,AA=yr.getJSF,ga=yr.assert;function ns(i,t){this.type=i,this.p=new bt(t.p,16),this.red=t.prime?bt.red(t.prime):bt.mont(this.p),this.zero=new bt(0).toRed(this.red),this.one=new bt(1).toRed(this.red),this.two=new bt(2).toRed(this.red),this.n=t.n&&new bt(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var e=this.n&&this.p.div(this.n);!e||e.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var Cs=ns;ns.prototype.point=function(){throw new Error("Not implemented")},ns.prototype.validate=function(){throw new Error("Not implemented")},ns.prototype._fixedNafMul=function(i,t){ga(i.precomputed);var e=i._getDoubles(),s=Wo(t,1,this._bitLength),o=(1<<e.step+1)-(e.step%2===0?2:1);o/=3;var a=[],u,d;for(u=0;u<s.length;u+=e.step){d=0;for(var y=u+e.step-1;y>=u;y--)d=(d<<1)+s[y];a.push(d)}for(var b=this.jpoint(null,null,null),C=this.jpoint(null,null,null),P=o;P>0;P--){for(u=0;u<a.length;u++)d=a[u],d===P?C=C.mixedAdd(e.points[u]):d===-P&&(C=C.mixedAdd(e.points[u].neg()));b=b.add(C)}return b.toP()},ns.prototype._wnafMul=function(i,t){var e=4,s=i._getNAFPoints(e);e=s.wnd;for(var o=s.points,a=Wo(t,e,this._bitLength),u=this.jpoint(null,null,null),d=a.length-1;d>=0;d--){for(var y=0;d>=0&&a[d]===0;d--)y++;if(d>=0&&y++,u=u.dblp(y),d<0)break;var b=a[d];ga(b!==0),i.type==="affine"?b>0?u=u.mixedAdd(o[b-1>>1]):u=u.mixedAdd(o[-b-1>>1].neg()):b>0?u=u.add(o[b-1>>1]):u=u.add(o[-b-1>>1].neg())}return i.type==="affine"?u.toP():u},ns.prototype._wnafMulAdd=function(i,t,e,s,o){var a=this._wnafT1,u=this._wnafT2,d=this._wnafT3,y=0,b,C,P;for(b=0;b<s;b++){P=t[b];var O=P._getNAFPoints(i);a[b]=O.wnd,u[b]=O.points}for(b=s-1;b>=1;b-=2){var F=b-1,q=b;if(a[F]!==1||a[q]!==1){d[F]=Wo(e[F],a[F],this._bitLength),d[q]=Wo(e[q],a[q],this._bitLength),y=Math.max(d[F].length,y),y=Math.max(d[q].length,y);continue}var H=[t[F],null,null,t[q]];t[F].y.cmp(t[q].y)===0?(H[1]=t[F].add(t[q]),H[2]=t[F].toJ().mixedAdd(t[q].neg())):t[F].y.cmp(t[q].y.redNeg())===0?(H[1]=t[F].toJ().mixedAdd(t[q]),H[2]=t[F].add(t[q].neg())):(H[1]=t[F].toJ().mixedAdd(t[q]),H[2]=t[F].toJ().mixedAdd(t[q].neg()));var V=[-3,-1,-5,-7,0,7,5,1,3],Y=AA(e[F],e[q]);for(y=Math.max(Y[0].length,y),d[F]=new Array(y),d[q]=new Array(y),C=0;C<y;C++){var ct=Y[0][C]|0,at=Y[1][C]|0;d[F][C]=V[(ct+1)*3+(at+1)],d[q][C]=0,u[F]=H}}var it=this.jpoint(null,null,null),rt=this._wnafT4;for(b=y;b>=0;b--){for(var ht=0;b>=0;){var gt=!0;for(C=0;C<s;C++)rt[C]=d[C][b]|0,rt[C]!==0&&(gt=!1);if(!gt)break;ht++,b--}if(b>=0&&ht++,it=it.dblp(ht),b<0)break;for(C=0;C<s;C++){var ut=rt[C];ut!==0&&(ut>0?P=u[C][ut-1>>1]:ut<0&&(P=u[C][-ut-1>>1].neg()),P.type==="affine"?it=it.mixedAdd(P):it=it.add(P))}}for(b=0;b<s;b++)u[b]=null;return o?it:it.toP()};function Rr(i,t){this.curve=i,this.type=t,this.precomputed=null}ns.BasePoint=Rr,Rr.prototype.eq=function(){throw new Error("Not implemented")},Rr.prototype.validate=function(){return this.curve.validate(this)},ns.prototype.decodePoint=function(i,t){i=yr.toArray(i,t);var e=this.p.byteLength();if((i[0]===4||i[0]===6||i[0]===7)&&i.length-1===2*e){i[0]===6?ga(i[i.length-1]%2===0):i[0]===7&&ga(i[i.length-1]%2===1);var s=this.point(i.slice(1,1+e),i.slice(1+e,1+2*e));return s}else if((i[0]===2||i[0]===3)&&i.length-1===e)return this.pointFromX(i.slice(1,1+e),i[0]===3);throw new Error("Unknown point format")},Rr.prototype.encodeCompressed=function(i){return this.encode(i,!0)},Rr.prototype._encode=function(i){var t=this.curve.p.byteLength(),e=this.getX().toArray("be",t);return i?[this.getY().isEven()?2:3].concat(e):[4].concat(e,this.getY().toArray("be",t))},Rr.prototype.encode=function(i,t){return yr.encode(this._encode(t),i)},Rr.prototype.precompute=function(i){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,i),t.beta=this._getBeta(),this.precomputed=t,this},Rr.prototype._hasDoubles=function(i){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return t?t.points.length>=Math.ceil((i.bitLength()+1)/t.step):!1},Rr.prototype._getDoubles=function(i,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var e=[this],s=this,o=0;o<t;o+=i){for(var a=0;a<i;a++)s=s.dbl();e.push(s)}return{step:i,points:e}},Rr.prototype._getNAFPoints=function(i){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],e=(1<<i)-1,s=e===1?null:this.dbl(),o=1;o<e;o++)t[o]=t[o-1].add(s);return{wnd:i,points:t}},Rr.prototype._getBeta=function(){return null},Rr.prototype.dblp=function(i){for(var t=this,e=0;e<i;e++)t=t.dbl();return t};var Uc=pn(function(i){typeof Object.create=="function"?i.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:i.exports=function(t,e){if(e){t.super_=e;var s=function(){};s.prototype=e.prototype,t.prototype=new s,t.prototype.constructor=t}}}),EA=yr.assert;function Dr(i){Cs.call(this,"short",i),this.a=new bt(i.a,16).toRed(this.red),this.b=new bt(i.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(i),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}Uc(Dr,Cs);var _A=Dr;Dr.prototype._getEndomorphism=function(i){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var t,e;if(i.beta)t=new bt(i.beta,16).toRed(this.red);else{var s=this._getEndoRoots(this.p);t=s[0].cmp(s[1])<0?s[0]:s[1],t=t.toRed(this.red)}if(i.lambda)e=new bt(i.lambda,16);else{var o=this._getEndoRoots(this.n);this.g.mul(o[0]).x.cmp(this.g.x.redMul(t))===0?e=o[0]:(e=o[1],EA(this.g.mul(e).x.cmp(this.g.x.redMul(t))===0))}var a;return i.basis?a=i.basis.map(function(u){return{a:new bt(u.a,16),b:new bt(u.b,16)}}):a=this._getEndoBasis(e),{beta:t,lambda:e,basis:a}}},Dr.prototype._getEndoRoots=function(i){var t=i===this.p?this.red:bt.mont(i),e=new bt(2).toRed(t).redInvm(),s=e.redNeg(),o=new bt(3).toRed(t).redNeg().redSqrt().redMul(e),a=s.redAdd(o).fromRed(),u=s.redSub(o).fromRed();return[a,u]},Dr.prototype._getEndoBasis=function(i){for(var t=this.n.ushrn(Math.floor(this.n.bitLength()/2)),e=i,s=this.n.clone(),o=new bt(1),a=new bt(0),u=new bt(0),d=new bt(1),y,b,C,P,O,F,q,H=0,V,Y;e.cmpn(0)!==0;){var ct=s.div(e);V=s.sub(ct.mul(e)),Y=u.sub(ct.mul(o));var at=d.sub(ct.mul(a));if(!C&&V.cmp(t)<0)y=q.neg(),b=o,C=V.neg(),P=Y;else if(C&&++H===2)break;q=V,s=e,e=V,u=o,o=Y,d=a,a=at}O=V.neg(),F=Y;var it=C.sqr().add(P.sqr()),rt=O.sqr().add(F.sqr());return rt.cmp(it)>=0&&(O=y,F=b),C.negative&&(C=C.neg(),P=P.neg()),O.negative&&(O=O.neg(),F=F.neg()),[{a:C,b:P},{a:O,b:F}]},Dr.prototype._endoSplit=function(i){var t=this.endo.basis,e=t[0],s=t[1],o=s.b.mul(i).divRound(this.n),a=e.b.neg().mul(i).divRound(this.n),u=o.mul(e.a),d=a.mul(s.a),y=o.mul(e.b),b=a.mul(s.b),C=i.sub(u).sub(d),P=y.add(b).neg();return{k1:C,k2:P}},Dr.prototype.pointFromX=function(i,t){i=new bt(i,16),i.red||(i=i.toRed(this.red));var e=i.redSqr().redMul(i).redIAdd(i.redMul(this.a)).redIAdd(this.b),s=e.redSqrt();if(s.redSqr().redSub(e).cmp(this.zero)!==0)throw new Error("invalid point");var o=s.fromRed().isOdd();return(t&&!o||!t&&o)&&(s=s.redNeg()),this.point(i,s)},Dr.prototype.validate=function(i){if(i.inf)return!0;var t=i.x,e=i.y,s=this.a.redMul(t),o=t.redSqr().redMul(t).redIAdd(s).redIAdd(this.b);return e.redSqr().redISub(o).cmpn(0)===0},Dr.prototype._endoWnafMulAdd=function(i,t,e){for(var s=this._endoWnafT1,o=this._endoWnafT2,a=0;a<i.length;a++){var u=this._endoSplit(t[a]),d=i[a],y=d._getBeta();u.k1.negative&&(u.k1.ineg(),d=d.neg(!0)),u.k2.negative&&(u.k2.ineg(),y=y.neg(!0)),s[a*2]=d,s[a*2+1]=y,o[a*2]=u.k1,o[a*2+1]=u.k2}for(var b=this._wnafMulAdd(1,s,o,a*2,e),C=0;C<a*2;C++)s[C]=null,o[C]=null;return b};function De(i,t,e,s){Cs.BasePoint.call(this,i,"affine"),t===null&&e===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new bt(t,16),this.y=new bt(e,16),s&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}Uc(De,Cs.BasePoint),Dr.prototype.point=function(i,t,e){return new De(this,i,t,e)},Dr.prototype.pointFromJSON=function(i,t){return De.fromJSON(this,i,t)},De.prototype._getBeta=function(){if(this.curve.endo){var i=this.precomputed;if(i&&i.beta)return i.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(i){var e=this.curve,s=function(o){return e.point(o.x.redMul(e.endo.beta),o.y)};i.beta=t,t.precomputed={beta:null,naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(s)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(s)}}}return t}},De.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},De.fromJSON=function(i,t,e){typeof t=="string"&&(t=JSON.parse(t));var s=i.point(t[0],t[1],e);if(!t[2])return s;function o(u){return i.point(u[0],u[1],e)}var a=t[2];return s.precomputed={beta:null,doubles:a.doubles&&{step:a.doubles.step,points:[s].concat(a.doubles.points.map(o))},naf:a.naf&&{wnd:a.naf.wnd,points:[s].concat(a.naf.points.map(o))}},s},De.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},De.prototype.isInfinity=function(){return this.inf},De.prototype.add=function(i){if(this.inf)return i;if(i.inf)return this;if(this.eq(i))return this.dbl();if(this.neg().eq(i))return this.curve.point(null,null);if(this.x.cmp(i.x)===0)return this.curve.point(null,null);var t=this.y.redSub(i.y);t.cmpn(0)!==0&&(t=t.redMul(this.x.redSub(i.x).redInvm()));var e=t.redSqr().redISub(this.x).redISub(i.x),s=t.redMul(this.x.redSub(e)).redISub(this.y);return this.curve.point(e,s)},De.prototype.dbl=function(){if(this.inf)return this;var i=this.y.redAdd(this.y);if(i.cmpn(0)===0)return this.curve.point(null,null);var t=this.curve.a,e=this.x.redSqr(),s=i.redInvm(),o=e.redAdd(e).redIAdd(e).redIAdd(t).redMul(s),a=o.redSqr().redISub(this.x.redAdd(this.x)),u=o.redMul(this.x.redSub(a)).redISub(this.y);return this.curve.point(a,u)},De.prototype.getX=function(){return this.x.fromRed()},De.prototype.getY=function(){return this.y.fromRed()},De.prototype.mul=function(i){return i=new bt(i,16),this.isInfinity()?this:this._hasDoubles(i)?this.curve._fixedNafMul(this,i):this.curve.endo?this.curve._endoWnafMulAdd([this],[i]):this.curve._wnafMul(this,i)},De.prototype.mulAdd=function(i,t,e){var s=[this,t],o=[i,e];return this.curve.endo?this.curve._endoWnafMulAdd(s,o):this.curve._wnafMulAdd(1,s,o,2)},De.prototype.jmulAdd=function(i,t,e){var s=[this,t],o=[i,e];return this.curve.endo?this.curve._endoWnafMulAdd(s,o,!0):this.curve._wnafMulAdd(1,s,o,2,!0)},De.prototype.eq=function(i){return this===i||this.inf===i.inf&&(this.inf||this.x.cmp(i.x)===0&&this.y.cmp(i.y)===0)},De.prototype.neg=function(i){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(i&&this.precomputed){var e=this.precomputed,s=function(o){return o.neg()};t.precomputed={naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(s)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(s)}}}return t},De.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var i=this.curve.jpoint(this.x,this.y,this.curve.one);return i};function ke(i,t,e,s){Cs.BasePoint.call(this,i,"jacobian"),t===null&&e===null&&s===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new bt(0)):(this.x=new bt(t,16),this.y=new bt(e,16),this.z=new bt(s,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}Uc(ke,Cs.BasePoint),Dr.prototype.jpoint=function(i,t,e){return new ke(this,i,t,e)},ke.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var i=this.z.redInvm(),t=i.redSqr(),e=this.x.redMul(t),s=this.y.redMul(t).redMul(i);return this.curve.point(e,s)},ke.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},ke.prototype.add=function(i){if(this.isInfinity())return i;if(i.isInfinity())return this;var t=i.z.redSqr(),e=this.z.redSqr(),s=this.x.redMul(t),o=i.x.redMul(e),a=this.y.redMul(t.redMul(i.z)),u=i.y.redMul(e.redMul(this.z)),d=s.redSub(o),y=a.redSub(u);if(d.cmpn(0)===0)return y.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var b=d.redSqr(),C=b.redMul(d),P=s.redMul(b),O=y.redSqr().redIAdd(C).redISub(P).redISub(P),F=y.redMul(P.redISub(O)).redISub(a.redMul(C)),q=this.z.redMul(i.z).redMul(d);return this.curve.jpoint(O,F,q)},ke.prototype.mixedAdd=function(i){if(this.isInfinity())return i.toJ();if(i.isInfinity())return this;var t=this.z.redSqr(),e=this.x,s=i.x.redMul(t),o=this.y,a=i.y.redMul(t).redMul(this.z),u=e.redSub(s),d=o.redSub(a);if(u.cmpn(0)===0)return d.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var y=u.redSqr(),b=y.redMul(u),C=e.redMul(y),P=d.redSqr().redIAdd(b).redISub(C).redISub(C),O=d.redMul(C.redISub(P)).redISub(o.redMul(b)),F=this.z.redMul(u);return this.curve.jpoint(P,O,F)},ke.prototype.dblp=function(i){if(i===0)return this;if(this.isInfinity())return this;if(!i)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var e=this;for(t=0;t<i;t++)e=e.dbl();return e}var s=this.curve.a,o=this.curve.tinv,a=this.x,u=this.y,d=this.z,y=d.redSqr().redSqr(),b=u.redAdd(u);for(t=0;t<i;t++){var C=a.redSqr(),P=b.redSqr(),O=P.redSqr(),F=C.redAdd(C).redIAdd(C).redIAdd(s.redMul(y)),q=a.redMul(P),H=F.redSqr().redISub(q.redAdd(q)),V=q.redISub(H),Y=F.redMul(V);Y=Y.redIAdd(Y).redISub(O);var ct=b.redMul(d);t+1<i&&(y=y.redMul(O)),a=H,d=ct,b=Y}return this.curve.jpoint(a,b.redMul(o),d)},ke.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},ke.prototype._zeroDbl=function(){var i,t,e;if(this.zOne){var s=this.x.redSqr(),o=this.y.redSqr(),a=o.redSqr(),u=this.x.redAdd(o).redSqr().redISub(s).redISub(a);u=u.redIAdd(u);var d=s.redAdd(s).redIAdd(s),y=d.redSqr().redISub(u).redISub(u),b=a.redIAdd(a);b=b.redIAdd(b),b=b.redIAdd(b),i=y,t=d.redMul(u.redISub(y)).redISub(b),e=this.y.redAdd(this.y)}else{var C=this.x.redSqr(),P=this.y.redSqr(),O=P.redSqr(),F=this.x.redAdd(P).redSqr().redISub(C).redISub(O);F=F.redIAdd(F);var q=C.redAdd(C).redIAdd(C),H=q.redSqr(),V=O.redIAdd(O);V=V.redIAdd(V),V=V.redIAdd(V),i=H.redISub(F).redISub(F),t=q.redMul(F.redISub(i)).redISub(V),e=this.y.redMul(this.z),e=e.redIAdd(e)}return this.curve.jpoint(i,t,e)},ke.prototype._threeDbl=function(){var i,t,e;if(this.zOne){var s=this.x.redSqr(),o=this.y.redSqr(),a=o.redSqr(),u=this.x.redAdd(o).redSqr().redISub(s).redISub(a);u=u.redIAdd(u);var d=s.redAdd(s).redIAdd(s).redIAdd(this.curve.a),y=d.redSqr().redISub(u).redISub(u);i=y;var b=a.redIAdd(a);b=b.redIAdd(b),b=b.redIAdd(b),t=d.redMul(u.redISub(y)).redISub(b),e=this.y.redAdd(this.y)}else{var C=this.z.redSqr(),P=this.y.redSqr(),O=this.x.redMul(P),F=this.x.redSub(C).redMul(this.x.redAdd(C));F=F.redAdd(F).redIAdd(F);var q=O.redIAdd(O);q=q.redIAdd(q);var H=q.redAdd(q);i=F.redSqr().redISub(H),e=this.y.redAdd(this.z).redSqr().redISub(P).redISub(C);var V=P.redSqr();V=V.redIAdd(V),V=V.redIAdd(V),V=V.redIAdd(V),t=F.redMul(q.redISub(i)).redISub(V)}return this.curve.jpoint(i,t,e)},ke.prototype._dbl=function(){var i=this.curve.a,t=this.x,e=this.y,s=this.z,o=s.redSqr().redSqr(),a=t.redSqr(),u=e.redSqr(),d=a.redAdd(a).redIAdd(a).redIAdd(i.redMul(o)),y=t.redAdd(t);y=y.redIAdd(y);var b=y.redMul(u),C=d.redSqr().redISub(b.redAdd(b)),P=b.redISub(C),O=u.redSqr();O=O.redIAdd(O),O=O.redIAdd(O),O=O.redIAdd(O);var F=d.redMul(P).redISub(O),q=e.redAdd(e).redMul(s);return this.curve.jpoint(C,F,q)},ke.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var i=this.x.redSqr(),t=this.y.redSqr(),e=this.z.redSqr(),s=t.redSqr(),o=i.redAdd(i).redIAdd(i),a=o.redSqr(),u=this.x.redAdd(t).redSqr().redISub(i).redISub(s);u=u.redIAdd(u),u=u.redAdd(u).redIAdd(u),u=u.redISub(a);var d=u.redSqr(),y=s.redIAdd(s);y=y.redIAdd(y),y=y.redIAdd(y),y=y.redIAdd(y);var b=o.redIAdd(u).redSqr().redISub(a).redISub(d).redISub(y),C=t.redMul(b);C=C.redIAdd(C),C=C.redIAdd(C);var P=this.x.redMul(d).redISub(C);P=P.redIAdd(P),P=P.redIAdd(P);var O=this.y.redMul(b.redMul(y.redISub(b)).redISub(u.redMul(d)));O=O.redIAdd(O),O=O.redIAdd(O),O=O.redIAdd(O);var F=this.z.redAdd(u).redSqr().redISub(e).redISub(d);return this.curve.jpoint(P,O,F)},ke.prototype.mul=function(i,t){return i=new bt(i,t),this.curve._wnafMul(this,i)},ke.prototype.eq=function(i){if(i.type==="affine")return this.eq(i.toJ());if(this===i)return!0;var t=this.z.redSqr(),e=i.z.redSqr();if(this.x.redMul(e).redISub(i.x.redMul(t)).cmpn(0)!==0)return!1;var s=t.redMul(this.z),o=e.redMul(i.z);return this.y.redMul(o).redISub(i.y.redMul(s)).cmpn(0)===0},ke.prototype.eqXToP=function(i){var t=this.z.redSqr(),e=i.toRed(this.curve.red).redMul(t);if(this.x.cmp(e)===0)return!0;for(var s=i.clone(),o=this.curve.redN.redMul(t);;){if(s.iadd(this.curve.n),s.cmp(this.curve.p)>=0)return!1;if(e.redIAdd(o),this.x.cmp(e)===0)return!0}},ke.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},ke.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var na=pn(function(i,t){var e=t;e.base=Cs,e.short=_A,e.mont=null,e.edwards=null}),oa=pn(function(i,t){var e=t,s=yr.assert;function o(d){d.type==="short"?this.curve=new na.short(d):d.type==="edwards"?this.curve=new na.edwards(d):this.curve=new na.mont(d),this.g=this.curve.g,this.n=this.curve.n,this.hash=d.hash,s(this.g.validate(),"Invalid curve"),s(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}e.PresetCurve=o;function a(d,y){Object.defineProperty(e,d,{configurable:!0,enumerable:!0,get:function(){var b=new o(y);return Object.defineProperty(e,d,{configurable:!0,enumerable:!0,value:b}),b}})}a("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:ui.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),a("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:ui.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),a("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:ui.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),a("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:ui.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),a("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:ui.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),a("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:ui.sha256,gRed:!1,g:["9"]}),a("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:ui.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var u;try{u=null.crash()}catch{u=void 0}a("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:ui.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",u]})});function os(i){if(!(this instanceof os))return new os(i);this.hash=i.hash,this.predResist=!!i.predResist,this.outLen=this.hash.outSize,this.minEntropy=i.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=Wr.toArray(i.entropy,i.entropyEnc||"hex"),e=Wr.toArray(i.nonce,i.nonceEnc||"hex"),s=Wr.toArray(i.pers,i.persEnc||"hex");kc(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,e,s)}var Kf=os;os.prototype._init=function(i,t,e){var s=i.concat(t).concat(e);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var o=0;o<this.V.length;o++)this.K[o]=0,this.V[o]=1;this._update(s),this._reseed=1,this.reseedInterval=281474976710656},os.prototype._hmac=function(){return new ui.hmac(this.hash,this.K)},os.prototype._update=function(i){var t=this._hmac().update(this.V).update([0]);i&&(t=t.update(i)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),i&&(this.K=this._hmac().update(this.V).update([1]).update(i).digest(),this.V=this._hmac().update(this.V).digest())},os.prototype.reseed=function(i,t,e,s){typeof t!="string"&&(s=e,e=t,t=null),i=Wr.toArray(i,t),e=Wr.toArray(e,s),kc(i.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(i.concat(e||[])),this._reseed=1},os.prototype.generate=function(i,t,e,s){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof t!="string"&&(s=e,e=t,t=null),e&&(e=Wr.toArray(e,s||"hex"),this._update(e));for(var o=[];o.length<i;)this.V=this._hmac().update(this.V).digest(),o=o.concat(this.V);var a=o.slice(0,i);return this._update(e),this._reseed++,Wr.encode(a,t)};var Qh=yr.assert;function Le(i,t){this.ec=i,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}var Gh=Le;Le.fromPublic=function(i,t,e){return t instanceof Le?t:new Le(i,{pub:t,pubEnc:e})},Le.fromPrivate=function(i,t,e){return t instanceof Le?t:new Le(i,{priv:t,privEnc:e})},Le.prototype.validate=function(){var i=this.getPublic();return i.isInfinity()?{result:!1,reason:"Invalid public key"}:i.validate()?i.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},Le.prototype.getPublic=function(i,t){return typeof i=="string"&&(t=i,i=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,i):this.pub},Le.prototype.getPrivate=function(i){return i==="hex"?this.priv.toString(16,2):this.priv},Le.prototype._importPrivate=function(i,t){this.priv=new bt(i,t||16),this.priv=this.priv.umod(this.ec.curve.n)},Le.prototype._importPublic=function(i,t){if(i.x||i.y){this.ec.curve.type==="mont"?Qh(i.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&Qh(i.x&&i.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(i.x,i.y);return}this.pub=this.ec.curve.decodePoint(i,t)},Le.prototype.derive=function(i){return i.validate()||Qh(i.validate(),"public point not validated"),i.mul(this.priv).getX()},Le.prototype.sign=function(i,t,e){return this.ec.sign(i,this,t,e)},Le.prototype.verify=function(i,t){return this.ec.verify(i,t,this)},Le.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var IA=yr.assert;function Ia(i,t){if(i instanceof Ia)return i;this._importDER(i,t)||(IA(i.r&&i.s,"Signature without r or s"),this.r=new bt(i.r,16),this.s=new bt(i.s,16),i.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=i.recoveryParam)}var Xo=Ia;function SA(){this.place=0}function Jh(i,t){var e=i[t.place++];if(!(e&128))return e;var s=e&15;if(s===0||s>4)return!1;for(var o=0,a=0,u=t.place;a<s;a++,u++)o<<=8,o|=i[u],o>>>=0;return o<=127?!1:(t.place=u,o)}function Vf(i){for(var t=0,e=i.length-1;!i[t]&&!(i[t+1]&128)&&t<e;)t++;return t===0?i:i.slice(t)}Ia.prototype._importDER=function(i,t){i=yr.toArray(i,t);var e=new SA;if(i[e.place++]!==48)return!1;var s=Jh(i,e);if(s===!1||s+e.place!==i.length||i[e.place++]!==2)return!1;var o=Jh(i,e);if(o===!1)return!1;var a=i.slice(e.place,o+e.place);if(e.place+=o,i[e.place++]!==2)return!1;var u=Jh(i,e);if(u===!1||i.length!==u+e.place)return!1;var d=i.slice(e.place,u+e.place);if(a[0]===0)if(a[1]&128)a=a.slice(1);else return!1;if(d[0]===0)if(d[1]&128)d=d.slice(1);else return!1;return this.r=new bt(a),this.s=new bt(d),this.recoveryParam=null,!0};function Yh(i,t){if(t<128){i.push(t);return}var e=1+(Math.log(t)/Math.LN2>>>3);for(i.push(e|128);--e;)i.push(t>>>(e<<3)&255);i.push(t)}Ia.prototype.toDER=function(i){var t=this.r.toArray(),e=this.s.toArray();for(t[0]&128&&(t=[0].concat(t)),e[0]&128&&(e=[0].concat(e)),t=Vf(t),e=Vf(e);!e[0]&&!(e[1]&128);)e=e.slice(1);var s=[2];Yh(s,t.length),s=s.concat(t),s.push(2),Yh(s,e.length);var o=s.concat(e),a=[48];return Yh(a,o.length),a=a.concat(o),yr.encode(a,i)};var PA=function(){throw new Error("unsupported")},Gd=yr.assert;function Tr(i){if(!(this instanceof Tr))return new Tr(i);typeof i=="string"&&(Gd(Object.prototype.hasOwnProperty.call(oa,i),"Unknown curve "+i),i=oa[i]),i instanceof oa.PresetCurve&&(i={curve:i}),this.curve=i.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=i.curve.g,this.g.precompute(i.curve.n.bitLength()+1),this.hash=i.hash||i.curve.hash}var MA=Tr;Tr.prototype.keyPair=function(i){return new Gh(this,i)},Tr.prototype.keyFromPrivate=function(i,t){return Gh.fromPrivate(this,i,t)},Tr.prototype.keyFromPublic=function(i,t){return Gh.fromPublic(this,i,t)},Tr.prototype.genKeyPair=function(i){i||(i={});for(var t=new Kf({hash:this.hash,pers:i.pers,persEnc:i.persEnc||"utf8",entropy:i.entropy||PA(this.hash.hmacStrength),entropyEnc:i.entropy&&i.entropyEnc||"utf8",nonce:this.n.toArray()}),e=this.n.byteLength(),s=this.n.sub(new bt(2));;){var o=new bt(t.generate(e));if(!(o.cmp(s)>0))return o.iaddn(1),this.keyFromPrivate(o)}},Tr.prototype._truncateToN=function(i,t){var e=i.byteLength()*8-this.n.bitLength();return e>0&&(i=i.ushrn(e)),!t&&i.cmp(this.n)>=0?i.sub(this.n):i},Tr.prototype.sign=function(i,t,e,s){typeof e=="object"&&(s=e,e=null),s||(s={}),t=this.keyFromPrivate(t,e),i=this._truncateToN(new bt(i,16));for(var o=this.n.byteLength(),a=t.getPrivate().toArray("be",o),u=i.toArray("be",o),d=new Kf({hash:this.hash,entropy:a,nonce:u,pers:s.pers,persEnc:s.persEnc||"utf8"}),y=this.n.sub(new bt(1)),b=0;;b++){var C=s.k?s.k(b):new bt(d.generate(this.n.byteLength()));if(C=this._truncateToN(C,!0),!(C.cmpn(1)<=0||C.cmp(y)>=0)){var P=this.g.mul(C);if(!P.isInfinity()){var O=P.getX(),F=O.umod(this.n);if(F.cmpn(0)!==0){var q=C.invm(this.n).mul(F.mul(t.getPrivate()).iadd(i));if(q=q.umod(this.n),q.cmpn(0)!==0){var H=(P.getY().isOdd()?1:0)|(O.cmp(F)!==0?2:0);return s.canonical&&q.cmp(this.nh)>0&&(q=this.n.sub(q),H^=1),new Xo({r:F,s:q,recoveryParam:H})}}}}}},Tr.prototype.verify=function(i,t,e,s){i=this._truncateToN(new bt(i,16)),e=this.keyFromPublic(e,s),t=new Xo(t,"hex");var o=t.r,a=t.s;if(o.cmpn(1)<0||o.cmp(this.n)>=0||a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;var u=a.invm(this.n),d=u.mul(i).umod(this.n),y=u.mul(o).umod(this.n),b;return this.curve._maxwellTrick?(b=this.g.jmulAdd(d,e.getPublic(),y),b.isInfinity()?!1:b.eqXToP(o)):(b=this.g.mulAdd(d,e.getPublic(),y),b.isInfinity()?!1:b.getX().umod(this.n).cmp(o)===0)},Tr.prototype.recoverPubKey=function(i,t,e,s){Gd((3&e)===e,"The recovery param is more than two bits"),t=new Xo(t,s);var o=this.n,a=new bt(i),u=t.r,d=t.s,y=e&1,b=e>>1;if(u.cmp(this.curve.p.umod(this.curve.n))>=0&&b)throw new Error("Unable to find sencond key candinate");b?u=this.curve.pointFromX(u.add(this.curve.n),y):u=this.curve.pointFromX(u,y);var C=t.r.invm(o),P=o.sub(a).mul(C).umod(o),O=d.mul(C).umod(o);return this.g.mulAdd(P,u,O)},Tr.prototype.getKeyRecoveryParam=function(i,t,e,s){if(t=new Xo(t,s),t.recoveryParam!==null)return t.recoveryParam;for(var o=0;o<4;o++){var a;try{a=this.recoverPubKey(i,t,o)}catch{continue}if(a.eq(e))return o}throw new Error("Unable to find valid recovery factor")};var CA=pn(function(i,t){var e=t;e.version="6.5.4",e.utils=yr,e.rand=function(){throw new Error("unsupported")},e.curve=na,e.curves=oa,e.ec=MA,e.eddsa=null}),RA=CA.ec;const NA="signing-key/5.7.0",yc=new Ue(NA);let Wh=null;function gi(){return Wh||(Wh=new RA("secp256k1")),Wh}class xA{constructor(t){Un(this,"curve","secp256k1"),Un(this,"privateKey",Je(t)),d2(this.privateKey)!==32&&yc.throwArgumentError("invalid private key","privateKey","[[ REDACTED ]]");const e=gi().keyFromPrivate(Ie(this.privateKey));Un(this,"publicKey","0x"+e.getPublic(!1,"hex")),Un(this,"compressedPublicKey","0x"+e.getPublic(!0,"hex")),Un(this,"_isSigningKey",!0)}_addPoint(t){const e=gi().keyFromPublic(Ie(this.publicKey)),s=gi().keyFromPublic(Ie(t));return"0x"+e.pub.add(s.pub).encodeCompressed("hex")}signDigest(t){const e=gi().keyFromPrivate(Ie(this.privateKey)),s=Ie(t);s.length!==32&&yc.throwArgumentError("bad digest length","digest",t);const o=e.sign(s,{canonical:!0});return wd({recoveryParam:o.recoveryParam,r:mi("0x"+o.r.toString(16),32),s:mi("0x"+o.s.toString(16),32)})}computeSharedSecret(t){const e=gi().keyFromPrivate(Ie(this.privateKey)),s=gi().keyFromPublic(Ie(Jd(t)));return mi("0x"+e.derive(s.getPublic()).toString(16),32)}static isSigningKey(t){return!!(t&&t._isSigningKey)}}function OA(i,t){const e=wd(t),s={r:Ie(e.r),s:Ie(e.s)};return"0x"+gi().recoverPubKey(Ie(i),s,e.recoveryParam).encode("hex",!1)}function Jd(i,t){const e=Ie(i);if(e.length===32){const s=new xA(e);return t?"0x"+gi().keyFromPrivate(e).getPublic(!0,"hex"):s.publicKey}else{if(e.length===33)return t?Je(e):"0x"+gi().keyFromPublic(e).getPublic(!1,"hex");if(e.length===65)return t?"0x"+gi().keyFromPublic(e).getPublic(!0,"hex"):Je(e)}return yc.throwArgumentError("invalid public or private key","key","[REDACTED]")}var Qf;(function(i){i[i.legacy=0]="legacy",i[i.eip2930=1]="eip2930",i[i.eip1559=2]="eip1559"})(Qf||(Qf={}));function TA(i){const t=Jd(i);return H2(Of(Fc(Of(t,1)),12))}function DA(i,t){return TA(OA(Ie(i),t))}const FA="https://rpc.walletconnect.com/v1";async function qA(i,t,e,s,o,a){switch(e.t){case"eip191":return BA(i,t,e.s);case"eip1271":return await kA(i,t,e.s,s,o,a);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${e.t}`)}}function BA(i,t,e){return DA(Cd(t),e).toLowerCase()===i.toLowerCase()}async function kA(i,t,e,s,o,a){try{const u="0x1626ba7e",d="0000000000000000000000000000000000000000000000000000000000000040",y="0000000000000000000000000000000000000000000000000000000000000041",b=e.substring(2),C=Cd(t).substring(2),P=u+C+d+y+b,O=await fetch(`${a||FA}/?chainId=${s}&projectId=${o}`,{method:"POST",body:JSON.stringify({id:UA(),jsonrpc:"2.0",method:"eth_call",params:[{to:i,data:P},"latest"]})}),{result:F}=await O.json();return F?F.slice(0,u.length).toLowerCase()===u.toLowerCase():!1}catch(u){return console.error("isValidEip1271Signature: ",u),!1}}function UA(){return Date.now()+Math.floor(Math.random()*1e3)}var $A=Object.defineProperty,jA=Object.defineProperties,zA=Object.getOwnPropertyDescriptors,Gf=Object.getOwnPropertySymbols,LA=Object.prototype.hasOwnProperty,HA=Object.prototype.propertyIsEnumerable,Jf=(i,t,e)=>t in i?$A(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,KA=(i,t)=>{for(var e in t||(t={}))LA.call(t,e)&&Jf(i,e,t[e]);if(Gf)for(var e of Gf(t))HA.call(t,e)&&Jf(i,e,t[e]);return i},VA=(i,t)=>jA(i,zA(t));const QA="did:pkh:",$c=i=>i==null?void 0:i.split(":"),Yd=i=>{const t=i&&$c(i);if(t)return i.includes(QA)?t[3]:t[1]},Yf=i=>{const t=i&&$c(i);if(t)return t[2]+":"+t[3]},ma=i=>{const t=i&&$c(i);if(t)return t.pop()};async function Wf(i){const{cacao:t,projectId:e}=i,{s,p:o}=t,a=Wd(o,o.iss),u=ma(o.iss);return await qA(u,a,s,Yd(o.iss),e)}const Wd=(i,t)=>{const e=`${i.domain} wants you to sign in with your Ethereum account:`,s=ma(t);if(!i.aud&&!i.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let o=i.statement||void 0;const a=`URI: ${i.aud||i.uri}`,u=`Version: ${i.version}`,d=`Chain ID: ${Yd(t)}`,y=`Nonce: ${i.nonce}`,b=`Issued At: ${i.iat}`,C=i.resources?`Resources:${i.resources.map(O=>`
- ${O}`).join("")}`:void 0,P=aa(i.resources);if(P){const O=eo(P);o=r6(o,O)}return[e,s,"",o,"",a,u,d,y,b,C].filter(O=>O!=null).join(`
`)};function GA(i){return sd.Buffer.from(JSON.stringify(i)).toString("base64")}function JA(i){return JSON.parse(sd.Buffer.from(i,"base64").toString("utf-8"))}function Ps(i){if(!i)throw new Error("No recap provided, value is undefined");if(!i.att)throw new Error("No `att` property found");const t=Object.keys(i.att);if(!(t!=null&&t.length))throw new Error("No resources found in `att` property");t.forEach(e=>{const s=i.att[e];if(Array.isArray(s))throw new Error(`Resource must be an object: ${e}`);if(typeof s!="object")throw new Error(`Resource must be an object: ${e}`);if(!Object.keys(s).length)throw new Error(`Resource object is empty: ${e}`);Object.keys(s).forEach(o=>{const a=s[o];if(!Array.isArray(a))throw new Error(`Ability limits ${o} must be an array of objects, found: ${a}`);if(!a.length)throw new Error(`Value of ${o} is empty array, must be an array with objects`);a.forEach(u=>{if(typeof u!="object")throw new Error(`Ability limits (${o}) must be an array of objects, found: ${u}`)})})})}function YA(i,t,e,s={}){return e==null||e.sort((o,a)=>o.localeCompare(a)),{att:{[i]:WA(t,e,s)}}}function WA(i,t,e={}){t=t==null?void 0:t.sort((o,a)=>o.localeCompare(a));const s=t.map(o=>({[`${i}/${o}`]:[e]}));return Object.assign({},...s)}function Xd(i){return Ps(i),`urn:recap:${GA(i).replace(/=/g,"")}`}function eo(i){const t=JA(i.replace("urn:recap:",""));return Ps(t),t}function XA(i,t,e){const s=YA(i,t,e);return Xd(s)}function ZA(i){return i&&i.includes("urn:recap:")}function t6(i,t){const e=eo(i),s=eo(t),o=e6(e,s);return Xd(o)}function e6(i,t){Ps(i),Ps(t);const e=Object.keys(i.att).concat(Object.keys(t.att)).sort((o,a)=>o.localeCompare(a)),s={att:{}};return e.forEach(o=>{var a,u;Object.keys(((a=i.att)==null?void 0:a[o])||{}).concat(Object.keys(((u=t.att)==null?void 0:u[o])||{})).sort((d,y)=>d.localeCompare(y)).forEach(d=>{var y,b;s.att[o]=VA(KA({},s.att[o]),{[d]:((y=i.att[o])==null?void 0:y[d])||((b=t.att[o])==null?void 0:b[d])})})}),s}function r6(i="",t){Ps(t);const e="I further authorize the stated URI to perform the following actions on my behalf: ";if(i.includes(e))return i;const s=[];let o=0;Object.keys(t.att).forEach(d=>{const y=Object.keys(t.att[d]).map(P=>({ability:P.split("/")[0],action:P.split("/")[1]}));y.sort((P,O)=>P.action.localeCompare(O.action));const b={};y.forEach(P=>{b[P.ability]||(b[P.ability]=[]),b[P.ability].push(P.action)});const C=Object.keys(b).map(P=>(o++,`(${o}) '${P}': '${b[P].join("', '")}' for '${d}'.`));s.push(C.join(", ").replace(".,","."))});const a=s.join(" "),u=`${e}${a}`;return`${i?i+" ":""}${u}`}function Xf(i){var t;const e=eo(i);Ps(e);const s=(t=e.att)==null?void 0:t.eip155;return s?Object.keys(s).map(o=>o.split("/")[1]):[]}function Zf(i){const t=eo(i);Ps(t);const e=[];return Object.values(t.att).forEach(s=>{Object.values(s).forEach(o=>{var a;(a=o==null?void 0:o[0])!=null&&a.chains&&e.push(o[0].chains)})}),[...new Set(e.flat())]}function aa(i){if(!i)return;const t=i==null?void 0:i[i.length-1];return ZA(t)?t:void 0}const Zd="base10",Xe="base16",wc="base64pad",jc="utf8",t0=0,as=1,i6=0,tp=1,bc=12,zc=32;function s6(){const i=nd.generateKeyPair();return{privateKey:Fr(i.secretKey,Xe),publicKey:Fr(i.publicKey,Xe)}}function Ac(){const i=od.randomBytes(zc);return Fr(i,Xe)}function n6(i,t){const e=nd.sharedKey(Yr(i,Xe),Yr(t,Xe),!0),s=new Cb(Nc.SHA256,e).expand(zc);return Fr(s,Xe)}function ha(i){const t=Nc.hash(Yr(i,Xe));return Fr(t,Xe)}function Is(i){const t=Nc.hash(Yr(i,jc));return Fr(t,Xe)}function o6(i){return Yr(`${i}`,Zd)}function no(i){return Number(Fr(i,Zd))}function a6(i){const t=o6(typeof i.type<"u"?i.type:t0);if(no(t)===as&&typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const e=typeof i.senderPublicKey<"u"?Yr(i.senderPublicKey,Xe):void 0,s=typeof i.iv<"u"?Yr(i.iv,Xe):od.randomBytes(bc),o=new ad.ChaCha20Poly1305(Yr(i.symKey,Xe)).seal(s,Yr(i.message,jc));return c6({type:t,sealed:o,iv:s,senderPublicKey:e})}function h6(i){const t=new ad.ChaCha20Poly1305(Yr(i.symKey,Xe)),{sealed:e,iv:s}=va(i.encoded),o=t.open(s,e);if(o===null)throw new Error("Failed to decrypt");return Fr(o,jc)}function c6(i){if(no(i.type)===as){if(typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Fr(wf([i.type,i.senderPublicKey,i.iv,i.sealed]),wc)}return Fr(wf([i.type,i.iv,i.sealed]),wc)}function va(i){const t=Yr(i,wc),e=t.slice(i6,tp),s=tp;if(no(e)===as){const d=s+zc,y=d+bc,b=t.slice(s,d),C=t.slice(d,y),P=t.slice(y);return{type:e,sealed:P,iv:C,senderPublicKey:b}}const o=s+bc,a=t.slice(s,o),u=t.slice(o);return{type:e,sealed:u,iv:a}}function u6(i,t){const e=va(i);return e0({type:no(e.type),senderPublicKey:typeof e.senderPublicKey<"u"?Fr(e.senderPublicKey,Xe):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function e0(i){const t=(i==null?void 0:i.type)||t0;if(t===as){if(typeof(i==null?void 0:i.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(i==null?void 0:i.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:i==null?void 0:i.senderPublicKey,receiverPublicKey:i==null?void 0:i.receiverPublicKey}}function ep(i){return i.type===as&&typeof i.senderPublicKey=="string"&&typeof i.receiverPublicKey=="string"}const l6="irn";function Ec(i){return(i==null?void 0:i.relay)||{protocol:l6}}function ca(i){const t=xb[i];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${i}`);return t}var f6=Object.defineProperty,p6=Object.defineProperties,d6=Object.getOwnPropertyDescriptors,rp=Object.getOwnPropertySymbols,g6=Object.prototype.hasOwnProperty,m6=Object.prototype.propertyIsEnumerable,ip=(i,t,e)=>t in i?f6(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,sp=(i,t)=>{for(var e in t||(t={}))g6.call(t,e)&&ip(i,e,t[e]);if(rp)for(var e of rp(t))m6.call(t,e)&&ip(i,e,t[e]);return i},v6=(i,t)=>p6(i,d6(t));function y6(i,t="-"){const e={},s="relay"+t;return Object.keys(i).forEach(o=>{if(o.startsWith(s)){const a=o.replace(s,""),u=i[o];e[a]=u}}),e}function np(i){i=i.includes("wc://")?i.replace("wc://",""):i,i=i.includes("wc:")?i.replace("wc:",""):i;const t=i.indexOf(":"),e=i.indexOf("?")!==-1?i.indexOf("?"):void 0,s=i.substring(0,t),o=i.substring(t+1,e).split("@"),a=typeof e<"u"?i.substring(e):"",u=la.parse(a),d=typeof u.methods=="string"?u.methods.split(","):void 0;return{protocol:s,topic:w6(o[0]),version:parseInt(o[1],10),symKey:u.symKey,relay:y6(u),methods:d,expiryTimestamp:u.expiryTimestamp?parseInt(u.expiryTimestamp,10):void 0}}function w6(i){return i.startsWith("//")?i.substring(2):i}function b6(i,t="-"){const e="relay",s={};return Object.keys(i).forEach(o=>{const a=e+t+o;i[o]&&(s[a]=i[o])}),s}function A6(i){return`${i.protocol}:${i.topic}@${i.version}?`+la.stringify(sp(v6(sp({symKey:i.symKey},b6(i.relay)),{expiryTimestamp:i.expiryTimestamp}),i.methods?{methods:i.methods.join(",")}:{}))}function dn(i){const t=[];return i.forEach(e=>{const[s,o]=e.split(":");t.push(`${s}:${o}`)}),t}function E6(i){const t=[];return Object.values(i).forEach(e=>{t.push(...dn(e.accounts))}),t}function _6(i,t){const e=[];return Object.values(i).forEach(s=>{dn(s.accounts).includes(t)&&e.push(...s.methods)}),e}function I6(i,t){const e=[];return Object.values(i).forEach(s=>{dn(s.accounts).includes(t)&&e.push(...s.events)}),e}function Lc(i){return i.includes(":")}function Jn(i){return Lc(i)?i.split(":")[0]:i}function S6(i){const t={};return i==null||i.forEach(e=>{const[s,o]=e.split(":");t[s]||(t[s]={accounts:[],chains:[],events:[]}),t[s].accounts.push(e),t[s].chains.push(`${s}:${o}`)}),t}function op(i,t){t=t.map(s=>s.replace("did:pkh:",""));const e=S6(t);for(const[s,o]of Object.entries(e))o.methods?o.methods=ia(o.methods,i):o.methods=i,o.events=["chainChanged","accountsChanged"];return e}const P6={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},M6={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Q(i,t){const{message:e,code:s}=M6[i];return{message:t?`${e} ${t}`:e,code:s}}function Gt(i,t){const{message:e,code:s}=P6[i];return{message:t?`${e} ${t}`:e,code:s}}function bi(i,t){return Array.isArray(i)?typeof t<"u"&&i.length?i.every(t):!0:!1}function ro(i){return Object.getPrototypeOf(i)===Object.prototype&&Object.keys(i).length}function We(i){return typeof i>"u"}function Ce(i,t){return t&&We(i)?!0:typeof i=="string"&&!!i.trim().length}function Hc(i,t){return t&&We(i)?!0:typeof i=="number"&&!isNaN(i)}function C6(i,t){const{requiredNamespaces:e}=t,s=Object.keys(i.namespaces),o=Object.keys(e);let a=!0;return _s(o,s)?(s.forEach(u=>{const{accounts:d,methods:y,events:b}=i.namespaces[u],C=dn(d),P=e[u];(!_s(ld(u,P),C)||!_s(P.methods,y)||!_s(P.events,b))&&(a=!1)}),a):!1}function ya(i){return Ce(i,!1)&&i.includes(":")?i.split(":").length===2:!1}function R6(i){if(Ce(i,!1)&&i.includes(":")){const t=i.split(":");if(t.length===3){const e=t[0]+":"+t[1];return!!t[2]&&ya(e)}}return!1}function N6(i){if(Ce(i,!1))try{return typeof new URL(i)<"u"}catch{return!1}return!1}function x6(i){var t;return(t=i==null?void 0:i.proposer)==null?void 0:t.publicKey}function O6(i){return i==null?void 0:i.topic}function T6(i,t){let e=null;return Ce(i==null?void 0:i.publicKey,!1)||(e=Q("MISSING_OR_INVALID",`${t} controller public key should be a string`)),e}function ap(i){let t=!0;return bi(i)?i.length&&(t=i.every(e=>Ce(e,!1))):t=!1,t}function D6(i,t,e){let s=null;return bi(t)&&t.length?t.forEach(o=>{s||ya(o)||(s=Gt("UNSUPPORTED_CHAINS",`${e}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):ya(i)||(s=Gt("UNSUPPORTED_CHAINS",`${e}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function F6(i,t,e){let s=null;return Object.entries(i).forEach(([o,a])=>{if(s)return;const u=D6(o,ld(o,a),`${t} ${e}`);u&&(s=u)}),s}function q6(i,t){let e=null;return bi(i)?i.forEach(s=>{e||R6(s)||(e=Gt("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):e=Gt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),e}function B6(i,t){let e=null;return Object.values(i).forEach(s=>{if(e)return;const o=q6(s==null?void 0:s.accounts,`${t} namespace`);o&&(e=o)}),e}function k6(i,t){let e=null;return ap(i==null?void 0:i.methods)?ap(i==null?void 0:i.events)||(e=Gt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):e=Gt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),e}function r0(i,t){let e=null;return Object.values(i).forEach(s=>{if(e)return;const o=k6(s,`${t}, namespace`);o&&(e=o)}),e}function U6(i,t,e){let s=null;if(i&&ro(i)){const o=r0(i,t);o&&(s=o);const a=F6(i,t,e);a&&(s=a)}else s=Q("MISSING_OR_INVALID",`${t}, ${e} should be an object with data`);return s}function Xh(i,t){let e=null;if(i&&ro(i)){const s=r0(i,t);s&&(e=s);const o=B6(i,t);o&&(e=o)}else e=Q("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return e}function i0(i){return Ce(i.protocol,!0)}function $6(i,t){let e=!1;return t&&!i?e=!0:i&&bi(i)&&i.length&&i.forEach(s=>{e=i0(s)}),e}function j6(i){return typeof i=="number"}function nr(i){return typeof i<"u"&&typeof i!==null}function z6(i){return!(!i||typeof i!="object"||!i.code||!Hc(i.code,!1)||!i.message||!Ce(i.message,!1))}function L6(i){return!(We(i)||!Ce(i.method,!1))}function H6(i){return!(We(i)||We(i.result)&&We(i.error)||!Hc(i.id,!1)||!Ce(i.jsonrpc,!1))}function K6(i){return!(We(i)||!Ce(i.name,!1))}function hp(i,t){return!(!ya(t)||!E6(i).includes(t))}function V6(i,t,e){return Ce(e,!1)?_6(i,t).includes(e):!1}function Q6(i,t,e){return Ce(e,!1)?I6(i,t).includes(e):!1}function cp(i,t,e){let s=null;const o=G6(i),a=J6(t),u=Object.keys(o),d=Object.keys(a),y=up(Object.keys(i)),b=up(Object.keys(t)),C=y.filter(P=>!b.includes(P));return C.length&&(s=Q("NON_CONFORMING_NAMESPACES",`${e} namespaces keys don't satisfy requiredNamespaces.
      Required: ${C.toString()}
      Received: ${Object.keys(t).toString()}`)),_s(u,d)||(s=Q("NON_CONFORMING_NAMESPACES",`${e} namespaces chains don't satisfy required namespaces.
      Required: ${u.toString()}
      Approved: ${d.toString()}`)),Object.keys(t).forEach(P=>{if(!P.includes(":")||s)return;const O=dn(t[P].accounts);O.includes(P)||(s=Q("NON_CONFORMING_NAMESPACES",`${e} namespaces accounts don't satisfy namespace accounts for ${P}
        Required: ${P}
        Approved: ${O.toString()}`))}),u.forEach(P=>{s||(_s(o[P].methods,a[P].methods)?_s(o[P].events,a[P].events)||(s=Q("NON_CONFORMING_NAMESPACES",`${e} namespaces events don't satisfy namespace events for ${P}`)):s=Q("NON_CONFORMING_NAMESPACES",`${e} namespaces methods don't satisfy namespace methods for ${P}`))}),s}function G6(i){const t={};return Object.keys(i).forEach(e=>{var s;e.includes(":")?t[e]=i[e]:(s=i[e].chains)==null||s.forEach(o=>{t[o]={methods:i[e].methods,events:i[e].events}})}),t}function up(i){return[...new Set(i.map(t=>t.includes(":")?t.split(":")[0]:t))]}function J6(i){const t={};return Object.keys(i).forEach(e=>{if(e.includes(":"))t[e]=i[e];else{const s=dn(i[e].accounts);s==null||s.forEach(o=>{t[o]={accounts:i[e].accounts.filter(a=>a.includes(`${o}:`)),methods:i[e].methods,events:i[e].events}})}}),t}function Y6(i,t){return Hc(i,!1)&&i<=t.max&&i>=t.min}function lp(){const i=io();return new Promise(t=>{switch(i){case mr.browser:t(W6());break;case mr.reactNative:t(X6());break;case mr.node:t(Z6());break;default:t(!0)}})}function W6(){return cn()&&(navigator==null?void 0:navigator.onLine)}async function X6(){if(hn()&&typeof we<"u"&&we!=null&&we.NetInfo){const i=await(we==null?void 0:we.NetInfo.fetch());return i==null?void 0:i.isConnected}return!0}function Z6(){return!0}function tE(i){switch(io()){case mr.browser:eE(i);break;case mr.reactNative:rE(i);break}}function eE(i){!hn()&&cn()&&(window.addEventListener("online",()=>i(!0)),window.addEventListener("offline",()=>i(!1)))}function rE(i){var t;hn()&&typeof we<"u"&&we!=null&&we.NetInfo&&((t=we)==null||t.NetInfo.addEventListener(e=>i(e==null?void 0:e.isConnected)))}const Zh={};class zn{static get(t){return Zh[t]}static set(t,e){Zh[t]=e}static delete(t){delete Zh[t]}}var gn={},Ln={},tc={},Hn={};const iE=hd(zb);var fp;function sE(){if(fp)return Hn;fp=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.IHeartBeat=void 0;const i=iE;class t extends i.IEvents{constructor(s){super()}}return Hn.IHeartBeat=t,Hn}var pp;function s0(){return pp||(pp=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),ba.__exportStar(sE(),i)}(tc)),tc}var ec={},bs={},dp;function nE(){if(dp)return bs;dp=1,Object.defineProperty(bs,"__esModule",{value:!0}),bs.HEARTBEAT_EVENTS=bs.HEARTBEAT_INTERVAL=void 0;const i=et;return bs.HEARTBEAT_INTERVAL=i.FIVE_SECONDS,bs.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},bs}var gp;function n0(){return gp||(gp=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),ba.__exportStar(nE(),i)}(ec)),ec}var mp;function oE(){if(mp)return Ln;mp=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.HeartBeat=void 0;const i=ba,t=Xr,e=et,s=s0(),o=n0();class a extends s.IHeartBeat{constructor(d){super(d),this.events=new t.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(d==null?void 0:d.interval)||o.HEARTBEAT_INTERVAL}static init(d){return i.__awaiter(this,void 0,void 0,function*(){const y=new a(d);return yield y.init(),y})}init(){return i.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(d,y){this.events.on(d,y)}once(d,y){this.events.once(d,y)}off(d,y){this.events.off(d,y)}removeListener(d,y){this.events.removeListener(d,y)}initialize(){return i.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),e.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return Ln.HeartBeat=a,Ln}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const t=ba;t.__exportStar(oE(),i),t.__exportStar(s0(),i),t.__exportStar(n0(),i)})(gn);class aE extends Ms{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class hE extends Ms{constructor(t,e){super(),this.core=t,this.logger=e,this.records=new Map}}class cE{constructor(t,e){this.logger=t,this.core=e}}let uE=class extends Ms{constructor(t,e){super(),this.relayer=t,this.logger=e}},lE=class extends Ms{constructor(t){super()}},fE=class{constructor(t,e,s,o){this.core=t,this.logger=e,this.name=s}},pE=class extends Ms{constructor(t,e){super(),this.relayer=t,this.logger=e}},dE=class extends Ms{constructor(t,e){super(),this.core=t,this.logger=e}},gE=class{constructor(t,e){this.projectId=t,this.logger=e}},mE=class{constructor(t,e){this.projectId=t,this.logger=e}},vE=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},yE=class{constructor(t){this.client=t}};class Hi extends Ob{constructor(t){super(t),this.events=new Xr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async request(t,e){return this.requestStrict(rn(t.method,t.params||[],t.id||Es().toString()),e)}async requestStrict(t,e){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(a){o(a)}this.events.on(`${t.id}`,a=>{Qr(a)?o(a.error):s(a.result)});try{await this.connection.send(t,e)}catch(a){o(a)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Aa(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}function wE(i,t){return t=t||{},new Promise(function(e,s){var o=new XMLHttpRequest,a=[],u=[],d={},y=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:y,headers:{keys:function(){return a},entries:function(){return u},get:function(C){return d[C.toLowerCase()]},has:function(C){return C.toLowerCase()in d}}}};for(var b in o.open(t.method||"get",i,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(C,P,O){a.push(P=P.toLowerCase()),u.push([P,O]),d[P]=d[P]?d[P]+","+O:O}),e(y())},o.onerror=s,o.withCredentials=t.credentials=="include",t.headers)o.setRequestHeader(b,t.headers[b]);o.send(t.body||null)})}const bE=Object.freeze(Object.defineProperty({__proto__:null,default:wE},Symbol.toStringTag,{value:"Module"})),vp=hd(bE);var AE=self.fetch||(self.fetch=vp.default||vp);const EE=cd(AE);function _E(i,t){if(i.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),s=0;s<e.length;s++)e[s]=255;for(var o=0;o<i.length;o++){var a=i.charAt(o),u=a.charCodeAt(0);if(e[u]!==255)throw new TypeError(a+" is ambiguous");e[u]=o}var d=i.length,y=i.charAt(0),b=Math.log(d)/Math.log(256),C=Math.log(256)/Math.log(d);function P(q){if(q instanceof Uint8Array||(ArrayBuffer.isView(q)?q=new Uint8Array(q.buffer,q.byteOffset,q.byteLength):Array.isArray(q)&&(q=Uint8Array.from(q))),!(q instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(q.length===0)return"";for(var H=0,V=0,Y=0,ct=q.length;Y!==ct&&q[Y]===0;)Y++,H++;for(var at=(ct-Y)*C+1>>>0,it=new Uint8Array(at);Y!==ct;){for(var rt=q[Y],ht=0,gt=at-1;(rt!==0||ht<V)&&gt!==-1;gt--,ht++)rt+=256*it[gt]>>>0,it[gt]=rt%d>>>0,rt=rt/d>>>0;if(rt!==0)throw new Error("Non-zero carry");V=ht,Y++}for(var ut=at-V;ut!==at&&it[ut]===0;)ut++;for(var Ot=y.repeat(H);ut<at;++ut)Ot+=i.charAt(it[ut]);return Ot}function O(q){if(typeof q!="string")throw new TypeError("Expected String");if(q.length===0)return new Uint8Array;var H=0;if(q[H]!==" "){for(var V=0,Y=0;q[H]===y;)V++,H++;for(var ct=(q.length-H)*b+1>>>0,at=new Uint8Array(ct);q[H];){var it=e[q.charCodeAt(H)];if(it===255)return;for(var rt=0,ht=ct-1;(it!==0||rt<Y)&&ht!==-1;ht--,rt++)it+=d*at[ht]>>>0,at[ht]=it%256>>>0,it=it/256>>>0;if(it!==0)throw new Error("Non-zero carry");Y=rt,H++}if(q[H]!==" "){for(var gt=ct-Y;gt!==ct&&at[gt]===0;)gt++;for(var ut=new Uint8Array(V+(ct-gt)),Ot=V;gt!==ct;)ut[Ot++]=at[gt++];return ut}}}function F(q){var H=O(q);if(H)return H;throw new Error(`Non-${t} character`)}return{encode:P,decodeUnsafe:O,decode:F}}var IE=_E,SE=IE;const o0=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},PE=i=>new TextEncoder().encode(i),ME=i=>new TextDecoder().decode(i);let CE=class{constructor(t,e,s){this.name=t,this.prefix=e,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},RE=class{constructor(t,e,s){if(this.name=t,this.prefix=e,e.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return a0(this,t)}},NE=class{constructor(t){this.decoders=t}or(t){return a0(this,t)}decode(t){const e=t[0],s=this.decoders[e];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const a0=(i,t)=>new NE({...i.decoders||{[i.prefix]:i},...t.decoders||{[t.prefix]:t}});let xE=class{constructor(t,e,s,o){this.name=t,this.prefix=e,this.baseEncode=s,this.baseDecode=o,this.encoder=new CE(t,e,s),this.decoder=new RE(t,e,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};const Sa=({name:i,prefix:t,encode:e,decode:s})=>new xE(i,t,e,s),oo=({prefix:i,name:t,alphabet:e})=>{const{encode:s,decode:o}=SE(e,t);return Sa({prefix:i,name:t,encode:s,decode:a=>o0(o(a))})},OE=(i,t,e,s)=>{const o={};for(let C=0;C<t.length;++C)o[t[C]]=C;let a=i.length;for(;i[a-1]==="=";)--a;const u=new Uint8Array(a*e/8|0);let d=0,y=0,b=0;for(let C=0;C<a;++C){const P=o[i[C]];if(P===void 0)throw new SyntaxError(`Non-${s} character`);y=y<<e|P,d+=e,d>=8&&(d-=8,u[b++]=255&y>>d)}if(d>=e||255&y<<8-d)throw new SyntaxError("Unexpected end of data");return u},TE=(i,t,e)=>{const s=t[t.length-1]==="=",o=(1<<e)-1;let a="",u=0,d=0;for(let y=0;y<i.length;++y)for(d=d<<8|i[y],u+=8;u>e;)u-=e,a+=t[o&d>>u];if(u&&(a+=t[o&d<<e-u]),s)for(;a.length*e&7;)a+="=";return a},$e=({name:i,prefix:t,bitsPerChar:e,alphabet:s})=>Sa({prefix:t,name:i,encode(o){return TE(o,s,e)},decode(o){return OE(o,s,e,i)}}),DE=Sa({prefix:"\0",name:"identity",encode:i=>ME(i),decode:i=>PE(i)});var FE=Object.freeze({__proto__:null,identity:DE});const qE=$e({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var BE=Object.freeze({__proto__:null,base2:qE});const kE=$e({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var UE=Object.freeze({__proto__:null,base8:kE});const $E=oo({prefix:"9",name:"base10",alphabet:"0123456789"});var jE=Object.freeze({__proto__:null,base10:$E});const zE=$e({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),LE=$e({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var HE=Object.freeze({__proto__:null,base16:zE,base16upper:LE});const KE=$e({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),VE=$e({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),QE=$e({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),GE=$e({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),JE=$e({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),YE=$e({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),WE=$e({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),XE=$e({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ZE=$e({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var t_=Object.freeze({__proto__:null,base32:KE,base32upper:VE,base32pad:QE,base32padupper:GE,base32hex:JE,base32hexupper:YE,base32hexpad:WE,base32hexpadupper:XE,base32z:ZE});const e_=oo({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),r_=oo({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var i_=Object.freeze({__proto__:null,base36:e_,base36upper:r_});const s_=oo({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),n_=oo({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var o_=Object.freeze({__proto__:null,base58btc:s_,base58flickr:n_});const a_=$e({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),h_=$e({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),c_=$e({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),u_=$e({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var l_=Object.freeze({__proto__:null,base64:a_,base64pad:h_,base64url:c_,base64urlpad:u_});const h0=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),f_=h0.reduce((i,t,e)=>(i[e]=t,i),[]),p_=h0.reduce((i,t,e)=>(i[t.codePointAt(0)]=e,i),[]);function d_(i){return i.reduce((t,e)=>(t+=f_[e],t),"")}function g_(i){const t=[];for(const e of i){const s=p_[e.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${e}`);t.push(s)}return new Uint8Array(t)}const m_=Sa({prefix:"🚀",name:"base256emoji",encode:d_,decode:g_});var v_=Object.freeze({__proto__:null,base256emoji:m_}),y_=c0,yp=128,w_=127,b_=~w_,A_=Math.pow(2,31);function c0(i,t,e){t=t||[],e=e||0;for(var s=e;i>=A_;)t[e++]=i&255|yp,i/=128;for(;i&b_;)t[e++]=i&255|yp,i>>>=7;return t[e]=i|0,c0.bytes=e-s+1,t}var E_=_c,__=128,wp=127;function _c(i,s){var e=0,s=s||0,o=0,a=s,u,d=i.length;do{if(a>=d)throw _c.bytes=0,new RangeError("Could not decode varint");u=i[a++],e+=o<28?(u&wp)<<o:(u&wp)*Math.pow(2,o),o+=7}while(u>=__);return _c.bytes=a-s,e}var I_=Math.pow(2,7),S_=Math.pow(2,14),P_=Math.pow(2,21),M_=Math.pow(2,28),C_=Math.pow(2,35),R_=Math.pow(2,42),N_=Math.pow(2,49),x_=Math.pow(2,56),O_=Math.pow(2,63),T_=function(i){return i<I_?1:i<S_?2:i<P_?3:i<M_?4:i<C_?5:i<R_?6:i<N_?7:i<x_?8:i<O_?9:10},D_={encode:y_,decode:E_,encodingLength:T_},u0=D_;const bp=(i,t,e=0)=>(u0.encode(i,t,e),t),Ap=i=>u0.encodingLength(i),Ic=(i,t)=>{const e=t.byteLength,s=Ap(i),o=s+Ap(e),a=new Uint8Array(o+e);return bp(i,a,0),bp(e,a,s),a.set(t,o),new F_(i,e,t,a)};class F_{constructor(t,e,s,o){this.code=t,this.size=e,this.digest=s,this.bytes=o}}const l0=({name:i,code:t,encode:e})=>new q_(i,t,e);let q_=class{constructor(t,e,s){this.name=t,this.code=e,this.encode=s}digest(t){if(t instanceof Uint8Array){const e=this.encode(t);return e instanceof Uint8Array?Ic(this.code,e):e.then(s=>Ic(this.code,s))}else throw Error("Unknown type, must be binary type")}};const f0=i=>async t=>new Uint8Array(await crypto.subtle.digest(i,t)),B_=l0({name:"sha2-256",code:18,encode:f0("SHA-256")}),k_=l0({name:"sha2-512",code:19,encode:f0("SHA-512")});var U_=Object.freeze({__proto__:null,sha256:B_,sha512:k_});const p0=0,$_="identity",d0=o0,j_=i=>Ic(p0,d0(i)),z_={code:p0,name:$_,encode:d0,digest:j_};var L_=Object.freeze({__proto__:null,identity:z_});new TextEncoder,new TextDecoder;const Ep={...FE,...BE,...UE,...jE,...HE,...t_,...i_,...o_,...l_,...v_};({...U_,...L_});function g0(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function H_(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?g0(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function m0(i,t,e,s){return{name:i,prefix:t,encoder:{name:i,prefix:t,encode:e},decoder:{decode:s}}}const _p=m0("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),rc=m0("ascii","a",i=>{let t="a";for(let e=0;e<i.length;e++)t+=String.fromCharCode(i[e]);return t},i=>{i=i.substring(1);const t=H_(i.length);for(let e=0;e<i.length;e++)t[e]=i.charCodeAt(e);return t}),K_={utf8:_p,"utf-8":_p,hex:Ep.base16,latin1:rc,ascii:rc,binary:rc,...Ep};function V_(i,t="utf8"){const e=K_[t];if(!e)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?g0(globalThis.Buffer.from(i,"utf-8")):e.decoder.decode(`${e.prefix}${i}`)}const v0="wc",Q_=2,Kc="core",hs=`${v0}@2:${Kc}:`,G_={name:Kc,logger:"error"},J_={database:":memory:"},Y_="crypto",Ip="client_ed25519_seed",W_=et.ONE_DAY,X_="keychain",Z_="0.3",tI="messages",eI="0.3",rI=et.SIX_HOURS,iI="publisher",y0="irn",sI="error",w0="wss://relay.walletconnect.com",Sp="wss://relay.walletconnect.org",nI="relayer",gr={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},oI="_subscription",Nr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},aI=et.ONE_SECOND,hI="2.12.2",cI=1e4,uI="0.3",lI="WALLETCONNECT_CLIENT_ID",fi={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},fI="subscription",pI="0.3",dI=et.FIVE_SECONDS*1e3,gI="pairing",mI="0.3",Kn={wc_pairingDelete:{req:{ttl:et.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:et.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:et.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:et.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:et.ONE_DAY,prompt:!1,tag:0},res:{ttl:et.ONE_DAY,prompt:!1,tag:0}}},Zs={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Kr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},vI="history",yI="0.3",wI="expirer",Or={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},bI="0.3",ic="verify-api",tn="https://verify.walletconnect.com",Sc="https://verify.walletconnect.org",AI=[tn,Sc],EI="echo",_I="https://echo.walletconnect.com";class II{constructor(t,e){this.core=t,this.logger=e,this.keychain=new Map,this.name=X_,this.version=Z_,this.initialized=!1,this.storagePrefix=hs,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:a}=Q("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(a)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=ar(e,this.name)}get context(){return wr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,fd(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?pd(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=Q("NOT_INITIALIZED",this.name);throw new Error(t)}}}class SI{constructor(t,e,s){this.core=t,this.logger=e,this.name=Y_,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),a=bf(o);return qb(a.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=s6();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const a=await this.getClientSeed(),u=bf(a),d=Ac();return await Bb(d,o,W_,u)},this.generateSharedKey=(o,a,u)=>{this.isInitialized();const d=this.getPrivateKey(o),y=n6(d,a);return this.setSymKey(y,u)},this.setSymKey=async(o,a)=>{this.isInitialized();const u=a||ha(o);return await this.keychain.set(u,o),u},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,a,u)=>{this.isInitialized();const d=e0(u),y=fc(a);if(ep(d)){const O=d.senderPublicKey,F=d.receiverPublicKey;o=await this.generateSharedKey(O,F)}const b=this.getSymKey(o),{type:C,senderPublicKey:P}=d;return a6({type:C,symKey:b,message:y,senderPublicKey:P})},this.decode=async(o,a,u)=>{this.isInitialized();const d=u6(a,u);if(ep(d)){const y=d.receiverPublicKey,b=d.senderPublicKey;o=await this.generateSharedKey(y,b)}try{const y=this.getSymKey(o),b=h6({symKey:y,encoded:a});return ud(b)}catch(y){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(y)}},this.getPayloadType=o=>{const a=va(o);return no(a.type)},this.getPayloadSenderPublicKey=o=>{const a=va(o);return a.senderPublicKey?Fr(a.senderPublicKey,Xe):void 0},this.core=t,this.logger=ar(e,this.name),this.keychain=s||new II(this.core,this.logger)}get context(){return wr(this.logger)}async setPrivateKey(t,e){return await this.keychain.set(t,e),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Ip)}catch{t=Ac(),await this.keychain.set(Ip,t)}return V_(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=Q("NOT_INITIALIZED",this.name);throw new Error(t)}}}class PI extends cE{constructor(t,e){super(t,e),this.logger=t,this.core=e,this.messages=new Map,this.name=tI,this.version=eI,this.initialized=!1,this.storagePrefix=hs,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const a=Is(o);let u=this.messages.get(s);return typeof u>"u"&&(u={}),typeof u[a]<"u"||(u[a]=o,this.messages.set(s,u),await this.persist()),a},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const a=this.get(s),u=Is(o);return typeof a[u]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=ar(t,this.name),this.core=e}get context(){return wr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,fd(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?pd(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=Q("NOT_INITIALIZED",this.name);throw new Error(t)}}}class MI extends uE{constructor(t,e){super(t,e),this.relayer=t,this.logger=e,this.events=new Xr.EventEmitter,this.name=iI,this.queue=new Map,this.publishTimeout=et.toMiliseconds(et.ONE_MINUTE),this.failedPublishTimeout=et.toMiliseconds(et.ONE_SECOND),this.needsTransportRestart=!1,this.publish=async(s,o,a)=>{var u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:a}});const d=(a==null?void 0:a.ttl)||rI,y=Ec(a),b=(a==null?void 0:a.prompt)||!1,C=(a==null?void 0:a.tag)||0,P=(a==null?void 0:a.id)||Es().toString(),O={topic:s,message:o,opts:{ttl:d,relay:y,prompt:b,tag:C,id:P}},F=`Failed to publish payload, please try again. id:${P} tag:${C}`,q=Date.now();let H,V=1;try{for(;H===void 0;){if(Date.now()-q>this.publishTimeout)throw new Error(F);this.logger.trace({id:P,attempts:V},`publisher.publish - attempt ${V}`),H=await await Zn(this.rpcPublish(s,o,d,y,b,C,P).catch(Y=>this.logger.warn(Y)),this.publishTimeout,F),V++,H||await new Promise(Y=>setTimeout(Y,this.failedPublishTimeout))}this.relayer.events.emit(gr.publish,O),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{id:P,topic:s,message:o,opts:a}})}catch(Y){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(Y),(u=a==null?void 0:a.internal)!=null&&u.throwOnFailedPublish)throw Y;this.queue.set(P,O)}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=t,this.logger=ar(e,this.name),this.registerEventListeners()}get context(){return wr(this.logger)}rpcPublish(t,e,s,o,a,u,d){var y,b,C,P;const O={method:ca(o.protocol).publish,params:{topic:t,message:e,ttl:s,prompt:a,tag:u},id:d};return We((y=O.params)==null?void 0:y.prompt)&&((b=O.params)==null||delete b.prompt),We((C=O.params)==null?void 0:C.tag)&&((P=O.params)==null||delete P.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:O}),this.relayer.request(O)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:e,message:s,opts:o}=t;await this.publish(e,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(gn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(gr.connection_stalled);return}this.checkQueue()}),this.relayer.on(gr.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class CI{constructor(){this.map=new Map,this.set=(t,e)=>{const s=this.get(t);this.exists(t,e)||this.map.set(t,[...s,e])},this.get=t=>this.map.get(t)||[],this.exists=(t,e)=>this.get(t).includes(e),this.delete=(t,e)=>{if(typeof e>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,e))return;const o=s.filter(a=>a!==e);if(!o.length){this.map.delete(t);return}this.map.set(t,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var RI=Object.defineProperty,NI=Object.defineProperties,xI=Object.getOwnPropertyDescriptors,Pp=Object.getOwnPropertySymbols,OI=Object.prototype.hasOwnProperty,TI=Object.prototype.propertyIsEnumerable,Mp=(i,t,e)=>t in i?RI(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Vn=(i,t)=>{for(var e in t||(t={}))OI.call(t,e)&&Mp(i,e,t[e]);if(Pp)for(var e of Pp(t))TI.call(t,e)&&Mp(i,e,t[e]);return i},sc=(i,t)=>NI(i,xI(t));class DI extends pE{constructor(t,e){super(t,e),this.relayer=t,this.logger=e,this.subscriptions=new Map,this.topicMap=new CI,this.events=new Xr.EventEmitter,this.name=fI,this.version=pI,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=hs,this.subscribeTimeout=et.toMiliseconds(et.ONE_MINUTE),this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const a=Ec(o),u={topic:s,relay:a};this.pending.set(s,u);const d=await this.rpcSubscribe(s,a);return typeof d=="string"&&(this.onSubscribe(d,u),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}})),d}catch(a){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(a),a}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>{if(this.topics.includes(s))return!0;const o=`${this.pendingSubscriptionWatchLabel}_${s}`;return await new Promise((a,u)=>{const d=new et.Watch;d.start(o);const y=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(y),d.stop(o),a(!0)),d.elapsed(o)>=dI&&(clearInterval(y),d.stop(o),u(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.start=async()=>{await this.onConnect()},this.stop=async()=>{await this.onDisconnect()},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=ar(e,this.name),this.clientId=""}get context(){return wr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,e){let s=!1;try{s=this.getSubscription(t).topic===e}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,e){const s=this.topicMap.get(t);await Promise.all(s.map(async o=>await this.unsubscribeById(t,o,e)))}async unsubscribeById(t,e,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:e,opts:s}});try{const o=Ec(s);await this.rpcUnsubscribe(t,e,o);const a=Gt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,e,a),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:e,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(t,e){const s={method:ca(e.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Zn(this.relayer.request(s).catch(o=>this.logger.warn(o)),this.subscribeTimeout)?Is(t+this.clientId):null}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(gr.connection_stalled)}return null}async rpcBatchSubscribe(t){if(!t.length)return;const e=t[0].relay,s={method:ca(e.protocol).batchSubscribe,params:{topics:t.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Zn(this.relayer.request(s).catch(o=>this.logger.warn(o)),this.subscribeTimeout)}catch{this.relayer.events.emit(gr.connection_stalled)}}rpcUnsubscribe(t,e,s){const o={method:ca(s.protocol).unsubscribe,params:{topic:t,id:e}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(t,e){this.setSubscription(t,sc(Vn({},e),{id:t})),this.pending.delete(e.topic)}onBatchSubscribe(t){t.length&&t.forEach(e=>{this.setSubscription(e.id,Vn({},e)),this.pending.delete(e.topic)})}async onUnsubscribe(t,e,s){this.events.removeAllListeners(e),this.hasSubscription(e,t)&&this.deleteSubscription(e,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,e){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:e}),this.addSubscription(t,e)}addSubscription(t,e){this.subscriptions.set(t,Vn({},e)),this.topicMap.set(e.topic,t),this.events.emit(fi.created,e)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const e=this.subscriptions.get(t);if(!e){const{message:s}=Q("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return e}deleteSubscription(t,e){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:e});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(fi.deleted,sc(Vn({},s),{reason:e}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(fi.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let e=0;e<t;e++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(fi.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:e}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(e)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const e=await this.rpcBatchSubscribe(t);bi(e)&&this.onBatchSubscribe(e.map((s,o)=>sc(Vn({},t[o]),{id:s})))}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||!this.relayer.connected)return;const t=[];this.pending.forEach(e=>{t.push(e)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(gn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.events.on(fi.created,async t=>{const e=fi.created;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),await this.persist()}),this.events.on(fi.deleted,async t=>{const e=fi.deleted;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Q("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const e=setInterval(()=>{this.restartInProgress||(clearInterval(e),t())},this.pollingInterval)})}}var FI=Object.defineProperty,Cp=Object.getOwnPropertySymbols,qI=Object.prototype.hasOwnProperty,BI=Object.prototype.propertyIsEnumerable,Rp=(i,t,e)=>t in i?FI(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,kI=(i,t)=>{for(var e in t||(t={}))qI.call(t,e)&&Rp(i,e,t[e]);if(Cp)for(var e of Cp(t))BI.call(t,e)&&Rp(i,e,t[e]);return i};class UI extends lE{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Xr.EventEmitter,this.name=nI,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled","interrupted"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.heartBeatTimeout=et.toMiliseconds(et.THIRTY_SECONDS+et.ONE_SECOND),this.request=async e=>{var s,o;this.logger.debug("Publishing Request Payload");const a=e.id||Es().toString();await this.toEstablishConnection();try{const u=this.provider.request(e);this.requestsInFlight.set(a,{promise:u,request:e}),this.logger.trace({id:a,method:e.method,topic:(s=e.params)==null?void 0:s.topic},"relayer.request - attempt to publish...");const d=await new Promise(async(y,b)=>{const C=()=>{b(new Error(`relayer.request - publish interrupted, id: ${a}`))};this.provider.on(Nr.disconnect,C);const P=await u;this.provider.off(Nr.disconnect,C),y(P)});return this.logger.trace({id:a,method:e.method,topic:(o=e.params)==null?void 0:o.topic},"relayer.request - published"),d}catch(u){throw this.logger.debug(`Failed to Publish Request: ${a}`),u}finally{this.requestsInFlight.delete(a)}},this.resetPingTimeout=()=>{if(Xn())try{clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var e,s,o;(o=(s=(e=this.provider)==null?void 0:e.connection)==null?void 0:s.socket)==null||o.terminate()},this.heartBeatTimeout)}catch(e){this.logger.warn(e)}},this.onPayloadHandler=e=>{this.onProviderPayload(e),this.resetPingTimeout()},this.onConnectHandler=()=>{this.startPingTimeout(),this.events.emit(gr.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=e=>{this.logger.error(e),this.events.emit(gr.error,e),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(Nr.payload,this.onPayloadHandler),this.provider.on(Nr.connect,this.onConnectHandler),this.provider.on(Nr.disconnect,this.onDisconnectHandler),this.provider.on(Nr.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?ar(t.logger,this.name):xc(Ea({level:t.logger||sI})),this.messages=new PI(this.logger,t.core),this.subscriber=new DI(this,this.logger),this.publisher=new MI(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||w0,this.projectId=t.projectId,this.bundleId=Jb(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Sp}...`),await this.restartTransport(Sp)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&this.subscriber.pending.size===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},cI)}get context(){return wr(this.logger)}get connected(){var t,e,s;return((s=(e=(t=this.provider)==null?void 0:t.connection)==null?void 0:e.socket)==null?void 0:s.readyState)===1}get connecting(){var t,e,s;return((s=(e=(t=this.provider)==null?void 0:t.connection)==null?void 0:e.socket)==null?void 0:s.readyState)===0}async publish(t,e,s){this.isInitialized(),await this.publisher.publish(t,e,s),await this.recordMessageEvent({topic:t,message:e,publishedAt:Date.now()})}async subscribe(t,e){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"",a;const u=d=>{d.topic===t&&(this.subscriber.off(fi.created,u),a())};return await Promise.all([new Promise(d=>{a=d,this.subscriber.on(fi.created,u)}),new Promise(async d=>{o=await this.subscriber.subscribe(t,e)||o,d()})]),o}async unsubscribe(t,e){this.isInitialized(),await this.subscriber.unsubscribe(t,e)}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async transportDisconnect(){if(!this.hasExperiencedNetworkDisruption&&this.connected&&this.requestsInFlight.size>0)try{await Promise.all(Array.from(this.requestsInFlight.values()).map(t=>t.promise))}catch(t){this.logger.warn(t)}this.hasExperiencedNetworkDisruption||this.connected?await Zn(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(t){await this.confirmOnlineStateOrThrow(),t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportDisconnect(),await this.createProvider()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;try{await new Promise(async(e,s)=>{const o=()=>{this.provider.off(Nr.disconnect,o),s(new Error("Connection interrupted while trying to subscribe"))};this.provider.on(Nr.disconnect,o),await Zn(this.provider.connect(),et.toMiliseconds(et.ONE_MINUTE),`Socket stalled when trying to connect to ${this.relayUrl}`).catch(a=>{s(a)}),await this.subscriber.start(),this.hasExperiencedNetworkDisruption=!1,e()})}catch(e){this.logger.error(e);const s=e;if(!this.isConnectionStalled(s.message))throw e}finally{this.connectionAttemptInProgress=!1}}async restartTransport(t){this.connectionAttemptInProgress||(this.relayUrl=t||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await lp())throw new Error("No internet connection detected. Please restart your network and try again.")}startPingTimeout(){var t,e,s,o,a;if(Xn())try{(e=(t=this.provider)==null?void 0:t.connection)!=null&&e.socket&&((a=(o=(s=this.provider)==null?void 0:s.connection)==null?void 0:o.socket)==null||a.once("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(u){this.logger.warn(u)}}isConnectionStalled(t){return this.staleConnectionErrors.some(e=>t.includes(e))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Hi(new kb(e2({sdkVersion:hI,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:e,message:s}=t;await this.messages.set(e,s)}async shouldIgnoreMessageEvent(t){const{topic:e,message:s}=t;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(e))return this.logger.debug(`Ignoring message for non-subscribed topic ${e}`),!0;const o=this.messages.has(e,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Oc(t)){if(!t.method.endsWith(oI))return;const e=t.params,{topic:s,message:o,publishedAt:a}=e.data,u={topic:s,message:o,publishedAt:a};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(kI({type:"event",event:e.id},u)),this.events.emit(e.id,u),await this.acknowledgePayload(t),await this.onMessageEvent(u)}else Aa(t)&&this.events.emit(gr.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(gr.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const e=_a(t.id,!0);await this.provider.connection.send(e)}unregisterProviderListeners(){this.provider.off(Nr.payload,this.onPayloadHandler),this.provider.off(Nr.connect,this.onConnectHandler),this.provider.off(Nr.disconnect,this.onDisconnectHandler),this.provider.off(Nr.error,this.onProviderErrorHandler)}async registerEventListeners(){let t=await lp();tE(async e=>{t!==e&&(t=e,e?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){await this.subscriber.stop(),this.events.emit(gr.disconnect),this.connectionAttemptInProgress=!1,!this.transportExplicitlyClosed&&setTimeout(async()=>{await this.transportOpen().catch(t=>this.logger.error(t))},et.toMiliseconds(aI))}isInitialized(){if(!this.initialized){const{message:t}=Q("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&(this.connectionAttemptInProgress&&await new Promise(t=>{const e=setInterval(()=>{this.connected&&(clearInterval(e),t())},this.connectionStatusPollingInterval)}),await this.transportOpen())}}var $I=Object.defineProperty,Np=Object.getOwnPropertySymbols,jI=Object.prototype.hasOwnProperty,zI=Object.prototype.propertyIsEnumerable,xp=(i,t,e)=>t in i?$I(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Op=(i,t)=>{for(var e in t||(t={}))jI.call(t,e)&&xp(i,e,t[e]);if(Np)for(var e of Np(t))zI.call(t,e)&&xp(i,e,t[e]);return i};class Rs extends fE{constructor(t,e,s,o=hs,a=void 0){super(t,e,s,o),this.core=t,this.logger=e,this.name=s,this.map=new Map,this.version=uI,this.cached=[],this.initialized=!1,this.storagePrefix=hs,this.recentlyDeleted=[],this.recentlyDeletedLimit=200,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(u=>{this.getKey&&u!==null&&!We(u)?this.map.set(this.getKey(u),u):x6(u)?this.map.set(u.id,u):O6(u)&&this.map.set(u.topic,u)}),this.cached=[],this.initialized=!0)},this.set=async(u,d)=>{this.isInitialized(),this.map.has(u)?await this.update(u,d):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:u,value:d}),this.map.set(u,d),await this.persist())},this.get=u=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:u}),this.getData(u)),this.getAll=u=>(this.isInitialized(),u?this.values.filter(d=>Object.keys(u).every(y=>Tb(d[y],u[y]))):this.values),this.update=async(u,d)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:u,update:d});const y=Op(Op({},this.getData(u)),d);this.map.set(u,y),await this.persist()},this.delete=async(u,d)=>{this.isInitialized(),this.map.has(u)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:u,reason:d}),this.map.delete(u),this.addToRecentlyDeleted(u),await this.persist())},this.logger=ar(e,this.name),this.storagePrefix=o,this.getKey=a}get context(){return wr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(t){this.recentlyDeleted.push(t),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const e=this.map.get(t);if(!e){if(this.recentlyDeleted.includes(t)){const{message:o}=Q("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${t}`);throw this.logger.error(o),new Error(o)}const{message:s}=Q("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return e}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:e}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=Q("NOT_INITIALIZED",this.name);throw new Error(t)}}}class LI{constructor(t,e){this.core=t,this.logger=e,this.name=gI,this.version=mI,this.events=new Tc,this.initialized=!1,this.storagePrefix=hs,this.ignoredPayloadTypes=[as],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async s=>{this.isInitialized();const o=Ac(),a=await this.core.crypto.setSymKey(o),u=He(et.FIVE_MINUTES),d={protocol:y0},y={topic:a,expiry:u,relay:d,active:!1},b=A6({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:o,relay:d,expiryTimestamp:u,methods:s==null?void 0:s.methods});return await this.pairings.set(a,y),await this.core.relayer.subscribe(a),this.core.expirer.set(a,u),{topic:a,uri:b}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:a,relay:u,expiryTimestamp:d,methods:y}=np(s.uri);let b;if(this.pairings.keys.includes(o)&&(b=this.pairings.get(o),b.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const C=d||He(et.FIVE_MINUTES),P={topic:o,relay:u,expiry:C,active:!1,methods:y};return await this.pairings.set(o,P),this.core.expirer.set(o,C),s.activatePairing&&await this.activate({topic:o}),this.events.emit(Zs.create,P),this.core.crypto.keychain.has(o)||await this.core.crypto.setSymKey(a,o),await this.core.relayer.subscribe(o,{relay:u}),P},this.activate=async({topic:s})=>{this.isInitialized();const o=He(et.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const a=await this.sendRequest(o,"wc_pairingPing",{}),{done:u,resolve:d,reject:y}=As();this.events.once(St("pairing_ping",a),({error:b})=>{b?y(b):d()}),await u()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",Gt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,a)=>{const u=rn(o,a),d=await this.core.crypto.encode(s,u),y=Kn[o].req;return this.core.history.set(s,u),this.core.relayer.publish(s,d,y),u.id},this.sendResult=async(s,o,a)=>{const u=_a(s,a),d=await this.core.crypto.encode(o,u),y=await this.core.history.get(o,s),b=Kn[y.request.method].res;await this.core.relayer.publish(o,d,b),await this.core.history.resolve(u)},this.sendError=async(s,o,a)=>{const u=Dc(s,a),d=await this.core.crypto.encode(o,u),y=await this.core.history.get(o,s),b=Kn[y.request.method]?Kn[y.request.method].res:Kn.unregistered_method.res;await this.core.relayer.publish(o,d,b),await this.core.history.resolve(u)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,Gt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>ss(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:a}=s;switch(a.method){case"wc_pairingPing":return this.onPairingPingRequest(o,a);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,a);default:return this.onUnknownRpcMethodRequest(o,a)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:a}=s,u=(await this.core.history.get(o,a.id)).request.method;switch(u){case"wc_pairingPing":return this.onPairingPingResponse(o,a);default:return this.onUnknownRpcMethodResponse(u)}},this.onPairingPingRequest=async(s,o)=>{const{id:a}=o;try{this.isValidPing({topic:s}),await this.sendResult(a,s,!0),this.events.emit(Zs.ping,{id:a,topic:s})}catch(u){await this.sendError(a,s,u),this.logger.error(u)}},this.onPairingPingResponse=(s,o)=>{const{id:a}=o;setTimeout(()=>{$i(o)?this.events.emit(St("pairing_ping",a),{}):Qr(o)&&this.events.emit(St("pairing_ping",a),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:a}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(Zs.delete,{id:a,topic:s})}catch(u){await this.sendError(a,s,u),this.logger.error(u)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:a,method:u}=o;try{if(this.registeredMethods.includes(u))return;const d=Gt("WC_METHOD_UNSUPPORTED",u);await this.sendError(a,s,d),this.logger.error(d)}catch(d){await this.sendError(a,s,d),this.logger.error(d)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Gt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var o;if(!nr(s)){const{message:u}=Q("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(u)}if(!N6(s.uri)){const{message:u}=Q("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(u)}const a=np(s.uri);if(!((o=a==null?void 0:a.relay)!=null&&o.protocol)){const{message:u}=Q("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(u)}if(!(a!=null&&a.symKey)){const{message:u}=Q("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(u)}if(a!=null&&a.expiryTimestamp&&et.toMiliseconds(a==null?void 0:a.expiryTimestamp)<Date.now()){const{message:u}=Q("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(u)}},this.isValidPing=async s=>{if(!nr(s)){const{message:a}=Q("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(a)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!nr(s)){const{message:a}=Q("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(a)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Ce(s,!1)){const{message:o}=Q("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=Q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(ss(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=Q("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=t,this.logger=ar(e,this.name),this.pairings=new Rs(this.core,this.logger,this.name,this.storagePrefix)}get context(){return wr(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=Q("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(gr.message,async t=>{const{topic:e,message:s}=t;if(!this.pairings.keys.includes(e)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(e,s);try{Oc(o)?(this.core.history.set(e,o),this.onRelayEventRequest({topic:e,payload:o})):Aa(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:e,payload:o}),this.core.history.delete(e,o.id))}catch(a){this.logger.error(a)}})}registerExpirerEvents(){this.core.expirer.on(Or.expired,async t=>{const{topic:e}=gd(t.target);e&&this.pairings.keys.includes(e)&&(await this.deletePairing(e,!0),this.events.emit(Zs.expire,{topic:e}))})}}class HI extends hE{constructor(t,e){super(t,e),this.core=t,this.logger=e,this.records=new Map,this.events=new Xr.EventEmitter,this.name=vI,this.version=yI,this.cached=[],this.initialized=!1,this.storagePrefix=hs,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,a)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:a}),this.records.has(o.id))return;const u={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:a,expiry:He(et.THIRTY_DAYS)};this.records.set(u.id,u),this.persist(),this.events.emit(Kr.created,u)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Qr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.persist(),this.events.emit(Kr.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(a=>{if(a.topic===s){if(typeof o<"u"&&a.id!==o)return;this.records.delete(a.id),this.events.emit(Kr.deleted,a)}}),this.persist()},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=ar(e,this.name)}get context(){return wr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(e=>{if(typeof e.response<"u")return;const s={topic:e.topic,request:rn(e.request.method,e.request.params,e.id),chainId:e.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const e=this.records.get(t);if(!e){const{message:s}=Q("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return e}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Kr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:e}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Kr.created,t=>{const e=Kr.created;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t})}),this.events.on(Kr.updated,t=>{const e=Kr.updated;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t})}),this.events.on(Kr.deleted,t=>{const e=Kr.deleted;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t})}),this.core.heartbeat.on(gn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let t=!1;this.records.forEach(e=>{et.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.records.delete(e.id),this.events.emit(Kr.deleted,e,!1),t=!0)}),t&&this.persist()}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=Q("NOT_INITIALIZED",this.name);throw new Error(t)}}}class KI extends dE{constructor(t,e){super(t,e),this.core=t,this.logger=e,this.expirations=new Map,this.events=new Xr.EventEmitter,this.name=wI,this.version=bI,this.cached=[],this.initialized=!1,this.storagePrefix=hs,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const a=this.formatTarget(s),u={target:a,expiry:o};this.expirations.set(a,u),this.checkExpiry(a,u),this.events.emit(Or.created,{target:a,expiration:u})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),a=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Or.deleted,{target:o,expiration:a})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=ar(e,this.name)}get context(){return wr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return r2(t);if(typeof t=="number")return i2(t);const{message:e}=Q("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(e)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Or.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:e}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const e=this.expirations.get(t);if(!e){const{message:s}=Q("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.warn(s),new Error(s)}return e}checkExpiry(t,e){const{expiry:s}=e;et.toMiliseconds(s)-Date.now()<=0&&this.expire(t,e)}expire(t,e){this.expirations.delete(t),this.events.emit(Or.expired,{target:t,expiration:e})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,e)=>this.checkExpiry(e,t))}registerEventListeners(){this.core.heartbeat.on(gn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Or.created,t=>{const e=Or.created;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()}),this.events.on(Or.expired,t=>{const e=Or.expired;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()}),this.events.on(Or.deleted,t=>{const e=Or.deleted;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Q("NOT_INITIALIZED",this.name);throw new Error(t)}}}let VI=class extends gE{constructor(t,e){super(t,e),this.projectId=t,this.logger=e,this.name=ic,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||hn()||!cn())return;const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(a){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(a)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Sc;try{await this.createIframe()}catch(a){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(a),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let a;try{a=await this.fetchAttestation(s.attestationId,o)}catch(u){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${o}`),this.logger.info(u),a=await this.fetchAttestation(s.attestationId,Sc)}return a},this.fetchAttestation=async(s,o)=>{this.logger.info(`resolving attestation: ${s} from url: ${o}`);const a=this.startAbortTimer(et.ONE_SECOND*2),u=await fetch(`${o}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(a),u.status===200?await u.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const o=a=>{a.data==="verify_ready"&&(this.onInit(),window.removeEventListener("message",o),s())};await Promise.race([new Promise(a=>{const u=document.getElementById(ic);if(u)return this.iframe=u,this.onInit(),a();window.addEventListener("message",o);const d=document.createElement("iframe");d.id=ic,d.src=`${this.verifyUrl}/${this.projectId}`,d.style.display="none",document.body.append(d),this.iframe=d,s=a}),new Promise((a,u)=>setTimeout(()=>{window.removeEventListener("message",o),u("verify iframe load timeout")},et.toMiliseconds(et.FIVE_SECONDS)))])},this.onInit=()=>{this.initialized=!0,this.processQueue()},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let o=s||tn;return AI.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${tn}`),o=tn),o},this.logger=ar(e,this.name),this.verifyUrl=tn,this.abortController=new AbortController,this.isDevEnv=Xn()&&{}.IS_VITEST}get context(){return wr(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),et.toMiliseconds(t))}},QI=class extends mE{constructor(t,e){super(t,e),this.projectId=t,this.logger=e,this.context=EI,this.registerDeviceToken=async s=>{const{clientId:o,token:a,notificationType:u,enableEncrypted:d=!1}=s,y=`${_I}/${this.projectId}/clients`;await EE(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:u,token:a,always_raw:d})})},this.logger=ar(e,this.context)}};var GI=Object.defineProperty,Tp=Object.getOwnPropertySymbols,JI=Object.prototype.hasOwnProperty,YI=Object.prototype.propertyIsEnumerable,Dp=(i,t,e)=>t in i?GI(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Fp=(i,t)=>{for(var e in t||(t={}))JI.call(t,e)&&Dp(i,e,t[e]);if(Tp)for(var e of Tp(t))YI.call(t,e)&&Dp(i,e,t[e]);return i};let WI=class b0 extends aE{constructor(t){var e;super(t),this.protocol=v0,this.version=Q_,this.name=Kc,this.events=new Xr.EventEmitter,this.initialized=!1,this.on=(u,d)=>this.events.on(u,d),this.once=(u,d)=>this.events.once(u,d),this.off=(u,d)=>this.events.off(u,d),this.removeListener=(u,d)=>this.events.removeListener(u,d),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||w0,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const s=Ea({level:typeof(t==null?void 0:t.logger)=="string"&&t.logger?t.logger:G_.logger}),{logger:o,chunkLoggerController:a}=Db({opts:s,maxSizeInBytes:t==null?void 0:t.maxLogBlobSizeInBytes,loggerOverride:t==null?void 0:t.logger});this.logChunkController=a,(e=this.logChunkController)!=null&&e.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var u,d;(u=this.logChunkController)!=null&&u.downloadLogsBlobInBrowser&&((d=this.logChunkController)==null||d.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=ar(o,this.name),this.heartbeat=new gn.HeartBeat,this.crypto=new SI(this,this.logger,t==null?void 0:t.keychain),this.history=new HI(this,this.logger),this.expirer=new KI(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new Fb(Fp(Fp({},J_),t==null?void 0:t.storageOptions)),this.relayer=new UI({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new LI(this,this.logger),this.verify=new VI(this.projectId||"",this.logger),this.echoClient=new QI(this.projectId||"",this.logger)}static async init(t){const e=new b0(t);await e.initialize();const s=await e.crypto.getClientId();return await e.storage.setItem(lI,s),e}get context(){return wr(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var t;return(t=this.logChunkController)==null?void 0:t.logsToBlob({clientId:await this.crypto.getClientId()})}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}};const XI=WI,A0="wc",E0=2,_0="client",Vc=`${A0}@${E0}:${_0}:`,nc={name:_0,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},qp="WALLETCONNECT_DEEPLINK_CHOICE",ZI="proposal",I0="Proposal expired",t8="session",Js=et.SEVEN_DAYS,e8="engine",xr={wc_sessionPropose:{req:{ttl:et.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:et.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:et.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:et.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:et.ONE_DAY,prompt:!1,tag:1104},res:{ttl:et.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:et.ONE_DAY,prompt:!1,tag:1106},res:{ttl:et.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:et.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:et.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:et.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:et.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:et.ONE_DAY,prompt:!1,tag:1112},res:{ttl:et.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:et.ONE_DAY,prompt:!1,tag:1114},res:{ttl:et.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:et.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:et.ONE_HOUR,prompt:!1,tag:1117}}},oc={min:et.FIVE_MINUTES,max:et.SEVEN_DAYS},Ui={idle:"IDLE",active:"ACTIVE"},r8="request",i8=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"],s8="wc",n8="auth",o8="authKeys",a8="pairingTopics",h8="requests",Pa=`${s8}@${1.5}:${n8}:`,ua=`${Pa}:PUB_KEY`;var c8=Object.defineProperty,u8=Object.defineProperties,l8=Object.getOwnPropertyDescriptors,Bp=Object.getOwnPropertySymbols,f8=Object.prototype.hasOwnProperty,p8=Object.prototype.propertyIsEnumerable,kp=(i,t,e)=>t in i?c8(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Fe=(i,t)=>{for(var e in t||(t={}))f8.call(t,e)&&kp(i,e,t[e]);if(Bp)for(var e of Bp(t))p8.call(t,e)&&kp(i,e,t[e]);return i},Ys=(i,t)=>u8(i,l8(t));class d8 extends yE{constructor(t){super(t),this.name=e8,this.events=new Tc,this.initialized=!1,this.requestQueue={state:Ui.idle,queue:[]},this.sessionRequestQueue={state:Ui.idle,queue:[]},this.requestQueueDelay=et.ONE_SECOND,this.expectedPairingMethodMap=new Map,this.recentlyDeletedMap=new Map,this.recentlyDeletedLimit=200,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(xr)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},et.toMiliseconds(this.requestQueueDelay)))},this.connect=async e=>{await this.isInitialized();const s=Ys(Fe({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:a,optionalNamespaces:u,sessionProperties:d,relays:y}=s;let b=o,C,P=!1;try{b&&(P=this.client.core.pairing.pairings.get(b).active)}catch(it){throw this.client.logger.error(`connect() -> pairing.get(${b}) failed`),it}if(!b||!P){const{topic:it,uri:rt}=await this.client.core.pairing.create();b=it,C=rt}if(!b){const{message:it}=Q("NO_MATCHING_KEY",`connect() pairing topic: ${b}`);throw new Error(it)}const O=await this.client.core.crypto.generateKeyPair(),F=xr.wc_sessionPropose.req.ttl||et.FIVE_MINUTES,q=He(F),H=Fe({requiredNamespaces:a,optionalNamespaces:u,relays:y??[{protocol:y0}],proposer:{publicKey:O,metadata:this.client.metadata},expiryTimestamp:q},d&&{sessionProperties:d}),{reject:V,resolve:Y,done:ct}=As(F,I0);this.events.once(St("session_connect"),async({error:it,session:rt})=>{if(it)V(it);else if(rt){rt.self.publicKey=O;const ht=Ys(Fe({},rt),{requiredNamespaces:H.requiredNamespaces,optionalNamespaces:H.optionalNamespaces});await this.client.session.set(rt.topic,ht),await this.setExpiry(rt.topic,rt.expiry),b&&await this.client.core.pairing.updateMetadata({topic:b,metadata:rt.peer.metadata}),Y(ht)}});const at=await this.sendRequest({topic:b,method:"wc_sessionPropose",params:H,throwOnFailedPublish:!0});return await this.setProposal(at,Fe({id:at},H)),{uri:C,approval:ct}},this.pair=async e=>{await this.isInitialized();try{return await this.client.core.pairing.pair(e)}catch(s){throw this.client.logger.error("pair() failed"),s}},this.approve=async e=>{await this.isInitialized();try{await this.isValidApprove(e)}catch(ct){throw this.client.logger.error("approve() -> isValidApprove() failed"),ct}const{id:s,relayProtocol:o,namespaces:a,sessionProperties:u,sessionConfig:d}=e;let y;try{y=this.client.proposal.get(s)}catch(ct){throw this.client.logger.error(`approve() -> proposal.get(${s}) failed`),ct}let{pairingTopic:b,proposer:C,requiredNamespaces:P,optionalNamespaces:O}=y;b=b||"";const F=await this.client.core.crypto.generateKeyPair(),q=C.publicKey,H=await this.client.core.crypto.generateSharedKey(F,q),V=Fe(Fe({relay:{protocol:o??"irn"},namespaces:a,pairingTopic:b,controller:{publicKey:F,metadata:this.client.metadata},expiry:He(Js)},u&&{sessionProperties:u}),d&&{sessionConfig:d});await this.client.core.relayer.subscribe(H);const Y=Ys(Fe({},V),{topic:H,requiredNamespaces:P,optionalNamespaces:O,pairingTopic:b,acknowledged:!1,self:V.controller,peer:{publicKey:C.publicKey,metadata:C.metadata},controller:F});await this.client.session.set(H,Y);try{await this.sendResult({id:s,topic:b,result:{relay:{protocol:o??"irn"},responderPublicKey:F},throwOnFailedPublish:!0}),await this.sendRequest({topic:H,method:"wc_sessionSettle",params:V,throwOnFailedPublish:!0})}catch(ct){throw this.client.logger.error(ct),this.client.session.delete(H,Gt("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(H),ct}return await this.client.core.pairing.updateMetadata({topic:b,metadata:C.metadata}),await this.client.proposal.delete(s,Gt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:b}),await this.setExpiry(H,He(Js)),{topic:H,acknowledged:()=>new Promise(ct=>setTimeout(()=>ct(this.client.session.get(H)),500))}},this.reject=async e=>{await this.isInitialized();try{await this.isValidReject(e)}catch(u){throw this.client.logger.error("reject() -> isValidReject() failed"),u}const{id:s,reason:o}=e;let a;try{a=this.client.proposal.get(s).pairingTopic}catch(u){throw this.client.logger.error(`reject() -> proposal.get(${s}) failed`),u}a&&(await this.sendError({id:s,topic:a,error:o}),await this.client.proposal.delete(s,Gt("USER_DISCONNECTED")))},this.update=async e=>{await this.isInitialized();try{await this.isValidUpdate(e)}catch(P){throw this.client.logger.error("update() -> isValidUpdate() failed"),P}const{topic:s,namespaces:o}=e,{done:a,resolve:u,reject:d}=As(),y=Gs(),b=Es().toString(),C=this.client.session.get(s).namespaces;return this.events.once(St("session_update",y),({error:P})=>{P?d(P):u()}),await this.client.session.update(s,{namespaces:o}),this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:o},throwOnFailedPublish:!0,clientRpcId:y,relayRpcId:b}).catch(P=>{this.client.logger.error(P),this.client.session.update(s,{namespaces:C}),d(P)}),{acknowledged:a}},this.extend=async e=>{await this.isInitialized();try{await this.isValidExtend(e)}catch(y){throw this.client.logger.error("extend() -> isValidExtend() failed"),y}const{topic:s}=e,o=Gs(),{done:a,resolve:u,reject:d}=As();return this.events.once(St("session_extend",o),({error:y})=>{y?d(y):u()}),await this.setExpiry(s,He(Js)),this.sendRequest({topic:s,method:"wc_sessionExtend",params:{},clientRpcId:o,throwOnFailedPublish:!0}).catch(y=>{d(y)}),{acknowledged:a}},this.request=async e=>{await this.isInitialized();try{await this.isValidRequest(e)}catch(F){throw this.client.logger.error("request() -> isValidRequest() failed"),F}const{chainId:s,request:o,topic:a,expiry:u=xr.wc_sessionRequest.req.ttl}=e,d=this.client.session.get(a),y=Gs(),b=Es().toString(),{done:C,resolve:P,reject:O}=As(u,"Request expired. Please try again.");return this.events.once(St("session_request",y),({error:F,result:q})=>{F?O(F):P(q)}),await Promise.all([new Promise(async F=>{await this.sendRequest({clientRpcId:y,relayRpcId:b,topic:a,method:"wc_sessionRequest",params:{request:Ys(Fe({},o),{expiryTimestamp:He(u)}),chainId:s},expiry:u,throwOnFailedPublish:!0}).catch(q=>O(q)),this.client.events.emit("session_request_sent",{topic:a,request:o,chainId:s,id:y}),F()}),new Promise(async F=>{var q;if(!((q=d.sessionConfig)!=null&&q.disableDeepLink)){const H=await n2(this.client.core.storage,qp);s2({id:y,topic:a,wcDeepLink:H})}F()}),C()]).then(F=>F[2])},this.respond=async e=>{await this.isInitialized(),await this.isValidRespond(e);const{topic:s,response:o}=e,{id:a}=o;$i(o)?await this.sendResult({id:a,topic:s,result:o.result,throwOnFailedPublish:!0}):Qr(o)&&await this.sendError({id:a,topic:s,error:o.error}),this.cleanupAfterResponse(e)},this.ping=async e=>{await this.isInitialized();try{await this.isValidPing(e)}catch(o){throw this.client.logger.error("ping() -> isValidPing() failed"),o}const{topic:s}=e;if(this.client.session.keys.includes(s)){const o=Gs(),a=Es().toString(),{done:u,resolve:d,reject:y}=As();this.events.once(St("session_ping",o),({error:b})=>{b?y(b):d()}),await Promise.all([this.sendRequest({topic:s,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:o,relayRpcId:a}),u()])}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async e=>{await this.isInitialized(),await this.isValidEmit(e);const{topic:s,event:o,chainId:a}=e,u=Es().toString();await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:o,chainId:a},throwOnFailedPublish:!0,relayRpcId:u})},this.disconnect=async e=>{await this.isInitialized(),await this.isValidDisconnect(e);const{topic:s}=e;if(this.client.session.keys.includes(s))await this.sendRequest({topic:s,method:"wc_sessionDelete",params:Gt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:s,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(s))await this.client.core.pairing.disconnect({topic:s});else{const{message:o}=Q("MISMATCHED_TOPIC",`Session or pairing topic not found: ${s}`);throw new Error(o)}},this.find=e=>(this.isInitialized(),this.client.session.getAll().filter(s=>C6(s,e))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.authenticate=async e=>{this.isInitialized(),this.isValidAuthenticate(e);const{chains:s,statement:o="",uri:a,domain:u,nonce:d,type:y,exp:b,nbf:C,methods:P=[]}=e,O=[...e.resources||[]],{topic:F,uri:q}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"]});this.client.logger.info({message:"Generated new pairing",pairing:{topic:F,uri:q}});const H=await this.client.core.crypto.generateKeyPair(),V=ha(H);if(await Promise.all([this.client.auth.authKeys.set(ua,{responseTopic:V,publicKey:H}),this.client.auth.pairingTopics.set(V,{topic:V,pairingTopic:F})]),await this.client.core.relayer.subscribe(V),this.client.logger.info(`sending request to new pairing topic: ${F}`),P.length>0){const{namespace:Jt}=ra(s[0]);let c=XA(Jt,"request",P);aa(O)&&(c=t6(c,O.pop())),O.push(c)}const Y=He(xr.wc_sessionPropose.req.ttl),ct={authPayload:{type:y??"caip122",chains:s,statement:o,aud:a,domain:u,version:"1",nonce:d,iat:new Date().toISOString(),exp:b,nbf:C,resources:O},requester:{publicKey:H,metadata:this.client.metadata},expiryTimestamp:Y},at={eip155:{chains:s,methods:[...new Set(["personal_sign",...P])],events:["chainChanged","accountsChanged"]}},it={requiredNamespaces:{},optionalNamespaces:at,relays:[{protocol:"irn"}],proposer:{publicKey:H,metadata:this.client.metadata},expiryTimestamp:Y},{done:rt,resolve:ht,reject:gt}=As(xr.wc_sessionAuthenticate.req.ttl,"Request expired"),ut=async({error:Jt,session:c})=>{if(this.events.off(St("session_request",Ae),Ot),Jt)gt(Jt);else if(c){c.self.publicKey=H,await this.client.session.set(c.topic,c),await this.setExpiry(c.topic,c.expiry),F&&await this.client.core.pairing.updateMetadata({topic:F,metadata:c.peer.metadata});const f=this.client.session.get(c.topic);ht({session:f})}},Ot=async Jt=>{if(Jt.error){const x=Gt("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return Jt.error.code===x.code?void 0:(this.events.off(St("session_connect"),ut),gt(Jt.error.message))}this.events.off(St("session_connect"),ut);const{cacaos:c,responder:f}=Jt.result,g=[],E=[];for(const x of c){await Wf({cacao:x,projectId:this.client.core.projectId})||(this.client.logger.error(x,"Signature verification failed"),gt(Gt("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:I}=x,p=aa(I.resources),_=[Yf(I.iss)],lt=ma(I.iss);if(p){const st=Xf(p),v=Zf(p);g.push(...st),_.push(...v)}for(const st of _)E.push(`${st}:${lt}`)}const S=await this.client.core.crypto.generateSharedKey(H,f.publicKey);let R;g.length>0&&(R={topic:S,acknowledged:!0,self:{publicKey:H,metadata:this.client.metadata},peer:f,controller:f.publicKey,expiry:He(Js),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:F,namespaces:op([...new Set(g)],[...new Set(E)])},await this.client.core.relayer.subscribe(S),await this.client.session.set(S,R),R=this.client.session.get(S)),ht({auths:c,session:R})},Ae=Gs(),yt=Gs();this.events.once(St("session_connect"),ut),this.events.once(St("session_request",Ae),Ot);try{await Promise.all([this.sendRequest({topic:F,method:"wc_sessionAuthenticate",params:ct,expiry:e.expiry,throwOnFailedPublish:!0,clientRpcId:Ae}),this.sendRequest({topic:F,method:"wc_sessionPropose",params:it,expiry:xr.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:yt})])}catch(Jt){throw this.events.off(St("session_connect"),ut),this.events.off(St("session_request",Ae),Ot),Jt}return await this.setProposal(yt,Fe({id:yt},it)),await this.client.auth.requests.set(Ae,{authPayload:ct.authPayload,requester:ct.requester,expiryTimestamp:Y,id:Ae,pairingTopic:F,verifyContext:{}}),{uri:q,response:rt}},this.approveSessionAuthenticate=async e=>{this.isInitialized();const{id:s,auths:o}=e,a=this.getPendingAuthRequest(s);if(!a)throw new Error(`Could not find pending auth request with id ${s}`);const u=a.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),y=ha(u),b={type:as,receiverPublicKey:u,senderPublicKey:d},C=[],P=[];for(const q of o){if(!await Wf({cacao:q,projectId:this.client.core.projectId})){const at=Gt("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:s,topic:y,error:at,encodeOpts:b}),new Error(at.message)}const{p:H}=q,V=aa(H.resources),Y=[Yf(H.iss)],ct=ma(H.iss);if(V){const at=Xf(V),it=Zf(V);C.push(...at),Y.push(...it)}for(const at of Y)P.push(`${at}:${ct}`)}const O=await this.client.core.crypto.generateSharedKey(d,u);let F;return(C==null?void 0:C.length)>0&&(F={topic:O,acknowledged:!0,self:{publicKey:d,metadata:this.client.metadata},peer:{publicKey:u,metadata:a.requester.metadata},controller:u,expiry:He(Js),authentication:o,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:"",namespaces:op([...new Set(C)],[...new Set(P)])},await this.client.core.relayer.subscribe(O),await this.client.session.set(O,F)),await this.sendResult({topic:y,id:s,result:{cacaos:o,responder:{publicKey:d,metadata:this.client.metadata}},encodeOpts:b,throwOnFailedPublish:!0}),await this.client.auth.requests.delete(s,{message:"fullfilled",code:0}),await this.client.core.pairing.activate({topic:a.pairingTopic}),{session:F}},this.rejectSessionAuthenticate=async e=>{await this.isInitialized();const{id:s,reason:o}=e,a=this.getPendingAuthRequest(s);if(!a)throw new Error(`Could not find pending auth request with id ${s}`);const u=a.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),y=ha(u),b={type:as,receiverPublicKey:u,senderPublicKey:d};await this.sendError({id:s,topic:y,error:o,encodeOpts:b}),await this.client.auth.requests.delete(s,{message:"rejected",code:0}),await this.client.proposal.delete(s,Gt("USER_DISCONNECTED"))},this.formatAuthMessage=e=>{this.isInitialized();const{request:s,iss:o}=e;return Wd(s,o)},this.cleanupDuplicatePairings=async e=>{if(e.pairingTopic)try{const s=this.client.core.pairing.pairings.get(e.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(a=>{var u,d;return((u=a.peerMetadata)==null?void 0:u.url)&&((d=a.peerMetadata)==null?void 0:d.url)===e.peer.metadata.url&&a.topic&&a.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(a=>this.client.core.pairing.disconnect({topic:a.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async e=>{const{topic:s,expirerHasDeleted:o=!1,emitEvent:a=!0,id:u=0}=e,{self:d}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,Gt("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(d.publicKey)&&await this.client.core.crypto.deleteKeyPair(d.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),o||this.client.core.expirer.del(s),this.client.core.storage.removeItem(qp).catch(y=>this.client.logger.warn(y)),this.getPendingSessionRequests().forEach(y=>{y.topic===s&&this.deletePendingSessionRequest(y.id,Gt("USER_DISCONNECTED"))}),a&&this.client.events.emit("session_delete",{id:u,topic:s})},this.deleteProposal=async(e,s)=>{await Promise.all([this.client.proposal.delete(e,Gt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"proposal")},this.deletePendingSessionRequest=async(e,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(e,s),o?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(a=>a.id!==e),o&&(this.sessionRequestQueue.state=Ui.idle,this.client.events.emit("session_request_expire",{id:e}))},this.setExpiry=async(e,s)=>{this.client.session.keys.includes(e)&&await this.client.session.update(e,{expiry:s}),this.client.core.expirer.set(e,s)},this.setProposal=async(e,s)=>{await this.client.proposal.set(e,s),this.client.core.expirer.set(e,He(xr.wc_sessionPropose.req.ttl))},this.setPendingSessionRequest=async e=>{const{id:s,topic:o,params:a,verifyContext:u}=e,d=a.request.expiryTimestamp||He(xr.wc_sessionRequest.req.ttl);await this.client.pendingRequest.set(s,{id:s,topic:o,params:a,verifyContext:u}),d&&this.client.core.expirer.set(s,d)},this.sendRequest=async e=>{const{topic:s,method:o,params:a,expiry:u,relayRpcId:d,clientRpcId:y,throwOnFailedPublish:b}=e,C=rn(o,a,y);if(cn()&&i8.includes(o)){const F=Is(JSON.stringify(C));this.client.core.verify.register({attestationId:F})}let P;try{P=await this.client.core.crypto.encode(s,C)}catch(F){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${s} failed`),F}const O=xr[o].req;return u&&(O.ttl=u),d&&(O.id=d),this.client.core.history.set(s,C),b?(O.internal=Ys(Fe({},O.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,P,O)):this.client.core.relayer.publish(s,P,O).catch(F=>this.client.logger.error(F)),C.id},this.sendResult=async e=>{const{id:s,topic:o,result:a,throwOnFailedPublish:u,encodeOpts:d}=e,y=_a(s,a);let b;try{b=await this.client.core.crypto.encode(o,y,d)}catch(O){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${o} failed`),O}let C;try{C=await this.client.core.history.get(o,s)}catch(O){throw this.client.logger.error(`sendResult() -> history.get(${o}, ${s}) failed`),O}const P=xr[C.request.method].res;u?(P.internal=Ys(Fe({},P.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,b,P)):this.client.core.relayer.publish(o,b,P).catch(O=>this.client.logger.error(O)),await this.client.core.history.resolve(y)},this.sendError=async e=>{const{id:s,topic:o,error:a,encodeOpts:u}=e,d=Dc(s,a);let y;try{y=await this.client.core.crypto.encode(o,d,u)}catch(P){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${o} failed`),P}let b;try{b=await this.client.core.history.get(o,s)}catch(P){throw this.client.logger.error(`sendError() -> history.get(${o}, ${s}) failed`),P}const C=xr[b.request.method].res;this.client.core.relayer.publish(o,y,C),await this.client.core.history.resolve(d)},this.cleanup=async()=>{const e=[],s=[];this.client.session.getAll().forEach(o=>{let a=!1;ss(o.expiry)&&(a=!0),this.client.core.crypto.keychain.has(o.topic)||(a=!0),a&&e.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{ss(o.expiryTimestamp)&&s.push(o.id)}),await Promise.all([...e.map(o=>this.deleteSession({topic:o})),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async e=>{this.requestQueue.queue.push(e),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===Ui.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Ui.active;const e=this.requestQueue.queue.shift();if(e)try{this.processRequest(e),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=Ui.idle},this.processRequest=e=>{const{topic:s,payload:o}=e,a=o.method;if(!this.shouldIgnorePairingRequest({topic:s,requestMethod:a}))switch(a){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);case"wc_sessionAuthenticate":return this.onSessionAuthenticateRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${a}`)}},this.onRelayEventResponse=async e=>{const{topic:s,payload:o}=e,a=(await this.client.core.history.get(s,o.id)).request.method;switch(a){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${a}`)}},this.onRelayEventUnknownPayload=e=>{const{topic:s}=e,{message:o}=Q("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.shouldIgnorePairingRequest=e=>{const{topic:s,requestMethod:o}=e,a=this.expectedPairingMethodMap.get(s);return!a||a.includes(o)?!1:!!(a.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)},this.onSessionProposeRequest=async(e,s)=>{const{params:o,id:a}=s;try{this.isValidConnect(Fe({},s.params));const u=o.expiryTimestamp||He(xr.wc_sessionPropose.req.ttl),d=Fe({id:a,pairingTopic:e,expiryTimestamp:u},o);await this.setProposal(a,d);const y=Is(JSON.stringify(s)),b=await this.getVerifyContext(y,d.proposer.metadata);this.client.events.emit("session_proposal",{id:a,params:d,verifyContext:b})}catch(u){await this.sendError({id:a,topic:e,error:u}),this.client.logger.error(u)}},this.onSessionProposeResponse=async(e,s)=>{const{id:o}=s;if($i(s)){const{result:a}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:a});const u=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:u});const d=u.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:d});const y=a.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:y});const b=await this.client.core.crypto.generateSharedKey(d,y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:b});const C=await this.client.core.relayer.subscribe(b);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:C}),await this.client.core.pairing.activate({topic:e})}else if(Qr(s)){await this.client.proposal.delete(o,Gt("USER_DISCONNECTED"));const a=St("session_connect");if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners, 954`);this.events.emit(St("session_connect"),{error:s.error})}},this.onSessionSettleRequest=async(e,s)=>{const{id:o,params:a}=s;try{this.isValidSessionSettleRequest(a);const{relay:u,controller:d,expiry:y,namespaces:b,sessionProperties:C,pairingTopic:P,sessionConfig:O}=s.params,F=Fe(Fe({topic:e,relay:u,expiry:y,namespaces:b,acknowledged:!0,pairingTopic:P,requiredNamespaces:{},optionalNamespaces:{},controller:d.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:d.publicKey,metadata:d.metadata}},C&&{sessionProperties:C}),O&&{sessionConfig:O});await this.sendResult({id:s.id,topic:e,result:!0,throwOnFailedPublish:!0});const q=St("session_connect");if(this.events.listenerCount(q)===0)throw new Error(`emitting ${q} without any listeners 997`);this.events.emit(St("session_connect"),{session:F}),this.cleanupDuplicatePairings(F)}catch(u){await this.sendError({id:o,topic:e,error:u}),this.client.logger.error(u)}},this.onSessionSettleResponse=async(e,s)=>{const{id:o}=s;$i(s)?(await this.client.session.update(e,{acknowledged:!0}),this.events.emit(St("session_approve",o),{})):Qr(s)&&(await this.client.session.delete(e,Gt("USER_DISCONNECTED")),this.events.emit(St("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(e,s)=>{const{params:o,id:a}=s;try{const u=`${e}_session_update`,d=zn.get(u);if(d&&this.isRequestOutOfSync(d,a)){this.client.logger.info(`Discarding out of sync request - ${a}`),this.sendError({id:a,topic:e,error:Gt("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(Fe({topic:e},o));try{zn.set(u,a),await this.client.session.update(e,{namespaces:o.namespaces}),await this.sendResult({id:a,topic:e,result:!0,throwOnFailedPublish:!0})}catch(y){throw zn.delete(u),y}this.client.events.emit("session_update",{id:a,topic:e,params:o})}catch(u){await this.sendError({id:a,topic:e,error:u}),this.client.logger.error(u)}},this.isRequestOutOfSync=(e,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(e.toString().slice(0,-3)),this.onSessionUpdateResponse=(e,s)=>{const{id:o}=s,a=St("session_update",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);$i(s)?this.events.emit(St("session_update",o),{}):Qr(s)&&this.events.emit(St("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(e,s)=>{const{id:o}=s;try{this.isValidExtend({topic:e}),await this.setExpiry(e,He(Js)),await this.sendResult({id:o,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:o,topic:e})}catch(a){await this.sendError({id:o,topic:e,error:a}),this.client.logger.error(a)}},this.onSessionExtendResponse=(e,s)=>{const{id:o}=s,a=St("session_extend",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);$i(s)?this.events.emit(St("session_extend",o),{}):Qr(s)&&this.events.emit(St("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(e,s)=>{const{id:o}=s;try{this.isValidPing({topic:e}),await this.sendResult({id:o,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:o,topic:e})}catch(a){await this.sendError({id:o,topic:e,error:a}),this.client.logger.error(a)}},this.onSessionPingResponse=(e,s)=>{const{id:o}=s,a=St("session_ping",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);setTimeout(()=>{$i(s)?this.events.emit(St("session_ping",o),{}):Qr(s)&&this.events.emit(St("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(e,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:e,reason:s.params}),await Promise.all([new Promise(a=>{this.client.core.relayer.once(gr.publish,async()=>{a(await this.deleteSession({topic:e,id:o}))})}),this.sendResult({id:o,topic:e,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:e,error:Gt("USER_DISCONNECTED")})])}catch(a){this.client.logger.error(a)}},this.onSessionRequest=async(e,s)=>{const{id:o,params:a}=s;try{await this.isValidRequest(Fe({topic:e},a));const u=Is(JSON.stringify(rn("wc_sessionRequest",a,o))),d=this.client.session.get(e),y=await this.getVerifyContext(u,d.peer.metadata),b={id:o,topic:e,params:a,verifyContext:y};await this.setPendingSessionRequest(b),this.addSessionRequestToSessionRequestQueue(b),this.processSessionRequestQueue()}catch(u){await this.sendError({id:o,topic:e,error:u}),this.client.logger.error(u)}},this.onSessionRequestResponse=(e,s)=>{const{id:o}=s,a=St("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);$i(s)?this.events.emit(St("session_request",o),{result:s.result}):Qr(s)&&this.events.emit(St("session_request",o),{error:s.error})},this.onSessionEventRequest=async(e,s)=>{const{id:o,params:a}=s;try{const u=`${e}_session_event_${a.event.name}`,d=zn.get(u);if(d&&this.isRequestOutOfSync(d,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(Fe({topic:e},a)),this.client.events.emit("session_event",{id:o,topic:e,params:a}),zn.set(u,o)}catch(u){await this.sendError({id:o,topic:e,error:u}),this.client.logger.error(u)}},this.onSessionAuthenticateResponse=(e,s)=>{const{id:o}=s;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:e,payload:s}),$i(s)?this.events.emit(St("session_request",o),{result:s.result}):Qr(s)&&this.events.emit(St("session_request",o),{error:s.error})},this.onSessionAuthenticateRequest=async(e,s)=>{const{requester:o,authPayload:a,expiryTimestamp:u}=s.params,d=Is(JSON.stringify(s)),y=await this.getVerifyContext(d,this.client.metadata),b={requester:o,pairingTopic:e,id:s.id,authPayload:a,verifyContext:y,expiryTimestamp:u};await this.client.auth.requests.set(s.id,b),this.client.events.emit("session_authenticate",{topic:e,params:s.params,id:s.id})},this.addSessionRequestToSessionRequestQueue=e=>{this.sessionRequestQueue.queue.push(e)},this.cleanupAfterResponse=e=>{this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Ui.idle,this.processSessionRequestQueue()},et.toMiliseconds(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:e,error:s})=>{const o=this.client.core.history.pending;o.length>0&&o.filter(a=>a.topic===e&&a.request.method==="wc_sessionRequest").forEach(a=>{const u=a.request.id,d=St("session_request",u);if(this.events.listenerCount(d)===0)throw new Error(`emitting ${d} without any listeners`);this.events.emit(St("session_request",a.request.id),{error:s})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===Ui.active){this.client.logger.info("session request queue is already active.");return}const e=this.sessionRequestQueue.queue[0];if(!e){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=Ui.active,this.client.events.emit("session_request",e)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=e=>{if(e.methods&&this.expectedPairingMethodMap.set(e.topic,e.methods),e.active)return;const s=this.client.proposal.getAll().find(o=>o.pairingTopic===e.topic);s&&this.onSessionProposeRequest(e.topic,rn("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async e=>{if(!nr(e)){const{message:y}=Q("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw new Error(y)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:a,sessionProperties:u,relays:d}=e;if(We(s)||await this.isValidPairingTopic(s),!$6(d,!0)){const{message:y}=Q("MISSING_OR_INVALID",`connect() relays: ${d}`);throw new Error(y)}!We(o)&&ro(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!We(a)&&ro(a)!==0&&this.validateNamespaces(a,"optionalNamespaces"),We(u)||this.validateSessionProps(u,"sessionProperties")},this.validateNamespaces=(e,s)=>{const o=U6(e,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async e=>{if(!nr(e))throw new Error(Q("MISSING_OR_INVALID",`approve() params: ${e}`).message);const{id:s,namespaces:o,relayProtocol:a,sessionProperties:u}=e;this.checkRecentlyDeleted(s),await this.isValidProposalId(s);const d=this.client.proposal.get(s),y=Xh(o,"approve()");if(y)throw new Error(y.message);const b=cp(d.requiredNamespaces,o,"approve()");if(b)throw new Error(b.message);if(!Ce(a,!0)){const{message:C}=Q("MISSING_OR_INVALID",`approve() relayProtocol: ${a}`);throw new Error(C)}We(u)||this.validateSessionProps(u,"sessionProperties")},this.isValidReject=async e=>{if(!nr(e)){const{message:a}=Q("MISSING_OR_INVALID",`reject() params: ${e}`);throw new Error(a)}const{id:s,reason:o}=e;if(this.checkRecentlyDeleted(s),await this.isValidProposalId(s),!z6(o)){const{message:a}=Q("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(a)}},this.isValidSessionSettleRequest=e=>{if(!nr(e)){const{message:b}=Q("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw new Error(b)}const{relay:s,controller:o,namespaces:a,expiry:u}=e;if(!i0(s)){const{message:b}=Q("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(b)}const d=T6(o,"onSessionSettleRequest()");if(d)throw new Error(d.message);const y=Xh(a,"onSessionSettleRequest()");if(y)throw new Error(y.message);if(ss(u)){const{message:b}=Q("EXPIRED","onSessionSettleRequest()");throw new Error(b)}},this.isValidUpdate=async e=>{if(!nr(e)){const{message:y}=Q("MISSING_OR_INVALID",`update() params: ${e}`);throw new Error(y)}const{topic:s,namespaces:o}=e;this.checkRecentlyDeleted(s),await this.isValidSessionTopic(s);const a=this.client.session.get(s),u=Xh(o,"update()");if(u)throw new Error(u.message);const d=cp(a.requiredNamespaces,o,"update()");if(d)throw new Error(d.message)},this.isValidExtend=async e=>{if(!nr(e)){const{message:o}=Q("MISSING_OR_INVALID",`extend() params: ${e}`);throw new Error(o)}const{topic:s}=e;this.checkRecentlyDeleted(s),await this.isValidSessionTopic(s)},this.isValidRequest=async e=>{if(!nr(e)){const{message:y}=Q("MISSING_OR_INVALID",`request() params: ${e}`);throw new Error(y)}const{topic:s,request:o,chainId:a,expiry:u}=e;this.checkRecentlyDeleted(s),await this.isValidSessionTopic(s);const{namespaces:d}=this.client.session.get(s);if(!hp(d,a)){const{message:y}=Q("MISSING_OR_INVALID",`request() chainId: ${a}`);throw new Error(y)}if(!L6(o)){const{message:y}=Q("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(y)}if(!V6(d,a,o.method)){const{message:y}=Q("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(y)}if(u&&!Y6(u,oc)){const{message:y}=Q("MISSING_OR_INVALID",`request() expiry: ${u}. Expiry must be a number (in seconds) between ${oc.min} and ${oc.max}`);throw new Error(y)}},this.isValidRespond=async e=>{var s;if(!nr(e)){const{message:u}=Q("MISSING_OR_INVALID",`respond() params: ${e}`);throw new Error(u)}const{topic:o,response:a}=e;try{await this.isValidSessionTopic(o)}catch(u){throw(s=e==null?void 0:e.response)!=null&&s.id&&this.cleanupAfterResponse(e),u}if(!H6(a)){const{message:u}=Q("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(u)}},this.isValidPing=async e=>{if(!nr(e)){const{message:o}=Q("MISSING_OR_INVALID",`ping() params: ${e}`);throw new Error(o)}const{topic:s}=e;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async e=>{if(!nr(e)){const{message:d}=Q("MISSING_OR_INVALID",`emit() params: ${e}`);throw new Error(d)}const{topic:s,event:o,chainId:a}=e;await this.isValidSessionTopic(s);const{namespaces:u}=this.client.session.get(s);if(!hp(u,a)){const{message:d}=Q("MISSING_OR_INVALID",`emit() chainId: ${a}`);throw new Error(d)}if(!K6(o)){const{message:d}=Q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(d)}if(!Q6(u,a,o.name)){const{message:d}=Q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(d)}},this.isValidDisconnect=async e=>{if(!nr(e)){const{message:o}=Q("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw new Error(o)}const{topic:s}=e;await this.isValidSessionOrPairingTopic(s)},this.isValidAuthenticate=e=>{const{chains:s,uri:o,domain:a,nonce:u}=e;if(!Array.isArray(s)||s.length===0)throw new Error("chains is required and must be a non-empty array");if(!Ce(o,!1))throw new Error("uri is required parameter");if(!Ce(a,!1))throw new Error("domain is required parameter");if(!Ce(u,!1))throw new Error("nonce is required parameter");if([...new Set(s.map(y=>ra(y).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:d}=ra(s[0]);if(d!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")},this.getVerifyContext=async(e,s)=>{const o={verified:{verifyUrl:s.verifyUrl||tn,validation:"UNKNOWN",origin:s.url||""}};try{const a=await this.client.core.verify.resolve({attestationId:e,verifyUrl:s.verifyUrl});a&&(o.verified.origin=a.origin,o.verified.isScam=a.isScam,o.verified.validation=a.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(a){this.client.logger.info(a)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(e,s)=>{Object.values(e).forEach(o=>{if(!Ce(o,!1)){const{message:a}=Q("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(a)}})},this.getPendingAuthRequest=e=>{const s=this.client.auth.requests.get(e);return typeof s=="object"?s:void 0},this.addToRecentlyDeleted=(e,s)=>{if(this.recentlyDeletedMap.set(e,s),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let o=0;const a=this.recentlyDeletedLimit/2;for(const u of this.recentlyDeletedMap.keys()){if(o++>=a)break;this.recentlyDeletedMap.delete(u)}}},this.checkRecentlyDeleted=e=>{const s=this.recentlyDeletedMap.get(e);if(s){const{message:o}=Q("MISSING_OR_INVALID",`Record was recently deleted - ${s}: ${e}`);throw new Error(o)}}}async isInitialized(){if(!this.initialized){const{message:t}=Q("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(gr.message,async t=>{const{topic:e,message:s}=t,{publicKey:o}=this.client.auth.authKeys.keys.includes(ua)?this.client.auth.authKeys.get(ua):{responseTopic:void 0,publicKey:void 0},a=await this.client.core.crypto.decode(e,s,{receiverPublicKey:o});try{Oc(a)?(this.client.core.history.set(e,a),this.onRelayEventRequest({topic:e,payload:a})):Aa(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:e,payload:a}),this.client.core.history.delete(e,a.id)):this.onRelayEventUnknownPayload({topic:e,payload:a})}catch(u){this.client.logger.error(u)}})}registerExpirerEvents(){this.client.core.expirer.on(Or.expired,async t=>{const{topic:e,id:s}=gd(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,Q("EXPIRED"),!0);e?this.client.session.keys.includes(e)&&(await this.deleteSession({topic:e,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:e})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(Zs.create,t=>this.onPairingCreated(t)),this.client.core.pairing.events.on(Zs.delete,t=>{this.addToRecentlyDeleted(t.topic,"pairing")})}isValidPairingTopic(t){if(!Ce(t,!1)){const{message:e}=Q("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(e)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:e}=Q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(e)}if(ss(this.client.core.pairing.pairings.get(t).expiry)){const{message:e}=Q("EXPIRED",`pairing topic: ${t}`);throw new Error(e)}}async isValidSessionTopic(t){if(!Ce(t,!1)){const{message:e}=Q("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(e)}if(this.checkRecentlyDeleted(t),!this.client.session.keys.includes(t)){const{message:e}=Q("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(e)}if(ss(this.client.session.get(t).expiry)){await this.deleteSession({topic:t});const{message:e}=Q("EXPIRED",`session topic: ${t}`);throw new Error(e)}if(!this.client.core.crypto.keychain.has(t)){const{message:e}=Q("MISSING_OR_INVALID",`session topic does not exist in keychain: ${t}`);throw await this.deleteSession({topic:t}),new Error(e)}}async isValidSessionOrPairingTopic(t){if(this.checkRecentlyDeleted(t),this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Ce(t,!1)){const{message:e}=Q("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(e)}else{const{message:e}=Q("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(e)}}async isValidProposalId(t){if(!j6(t)){const{message:e}=Q("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(e)}if(!this.client.proposal.keys.includes(t)){const{message:e}=Q("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(e)}if(ss(this.client.proposal.get(t).expiryTimestamp)){await this.deleteProposal(t);const{message:e}=Q("EXPIRED",`proposal id: ${t}`);throw new Error(e)}}}class g8 extends Rs{constructor(t,e){super(t,e,ZI,Vc),this.core=t,this.logger=e}}class m8 extends Rs{constructor(t,e){super(t,e,t8,Vc),this.core=t,this.logger=e}}class v8 extends Rs{constructor(t,e){super(t,e,r8,Vc,s=>s.id),this.core=t,this.logger=e}}class y8 extends Rs{constructor(t,e){super(t,e,o8,Pa,()=>ua),this.core=t,this.logger=e}}class w8 extends Rs{constructor(t,e){super(t,e,a8,Pa),this.core=t,this.logger=e}}class b8 extends Rs{constructor(t,e){super(t,e,h8,Pa,s=>s.id),this.core=t,this.logger=e}}class A8{constructor(t,e){this.core=t,this.logger=e,this.authKeys=new y8(this.core,this.logger),this.pairingTopics=new w8(this.core,this.logger),this.requests=new b8(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}class Qc extends vE{constructor(t){super(t),this.protocol=A0,this.version=E0,this.name=nc.name,this.events=new Xr.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.authenticate=async s=>{try{return await this.engine.authenticate(s)}catch(o){throw this.logger.error(o.message),o}},this.formatAuthMessage=s=>{try{return this.engine.formatAuthMessage(s)}catch(o){throw this.logger.error(o.message),o}},this.approveSessionAuthenticate=async s=>{try{return await this.engine.approveSessionAuthenticate(s)}catch(o){throw this.logger.error(o.message),o}},this.rejectSessionAuthenticate=async s=>{try{return await this.engine.rejectSessionAuthenticate(s)}catch(o){throw this.logger.error(o.message),o}},this.name=(t==null?void 0:t.name)||nc.name,this.metadata=(t==null?void 0:t.metadata)||Wb();const e=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:xc(Ea({level:(t==null?void 0:t.logger)||nc.logger}));this.core=(t==null?void 0:t.core)||new XI(t),this.logger=ar(e,this.name),this.session=new m8(this.core,this.logger),this.proposal=new g8(this.core,this.logger),this.pendingRequest=new v8(this.core,this.logger),this.engine=new d8(this),this.auth=new A8(this.core,this.logger)}static async init(t){const e=new Qc(t);return await e.initialize(),e}get context(){return wr(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),await this.auth.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}}var Pc={exports:{}};(function(i,t){var e=typeof self<"u"?self:Ub,s=function(){function a(){this.fetch=!1,this.DOMException=e.DOMException}return a.prototype=e,new a}();(function(a){(function(u){var d={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function y(f){return f&&DataView.prototype.isPrototypeOf(f)}if(d.arrayBuffer)var b=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],C=ArrayBuffer.isView||function(f){return f&&b.indexOf(Object.prototype.toString.call(f))>-1};function P(f){if(typeof f!="string"&&(f=String(f)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(f))throw new TypeError("Invalid character in header field name");return f.toLowerCase()}function O(f){return typeof f!="string"&&(f=String(f)),f}function F(f){var g={next:function(){var E=f.shift();return{done:E===void 0,value:E}}};return d.iterable&&(g[Symbol.iterator]=function(){return g}),g}function q(f){this.map={},f instanceof q?f.forEach(function(g,E){this.append(E,g)},this):Array.isArray(f)?f.forEach(function(g){this.append(g[0],g[1])},this):f&&Object.getOwnPropertyNames(f).forEach(function(g){this.append(g,f[g])},this)}q.prototype.append=function(f,g){f=P(f),g=O(g);var E=this.map[f];this.map[f]=E?E+", "+g:g},q.prototype.delete=function(f){delete this.map[P(f)]},q.prototype.get=function(f){return f=P(f),this.has(f)?this.map[f]:null},q.prototype.has=function(f){return this.map.hasOwnProperty(P(f))},q.prototype.set=function(f,g){this.map[P(f)]=O(g)},q.prototype.forEach=function(f,g){for(var E in this.map)this.map.hasOwnProperty(E)&&f.call(g,this.map[E],E,this)},q.prototype.keys=function(){var f=[];return this.forEach(function(g,E){f.push(E)}),F(f)},q.prototype.values=function(){var f=[];return this.forEach(function(g){f.push(g)}),F(f)},q.prototype.entries=function(){var f=[];return this.forEach(function(g,E){f.push([E,g])}),F(f)},d.iterable&&(q.prototype[Symbol.iterator]=q.prototype.entries);function H(f){if(f.bodyUsed)return Promise.reject(new TypeError("Already read"));f.bodyUsed=!0}function V(f){return new Promise(function(g,E){f.onload=function(){g(f.result)},f.onerror=function(){E(f.error)}})}function Y(f){var g=new FileReader,E=V(g);return g.readAsArrayBuffer(f),E}function ct(f){var g=new FileReader,E=V(g);return g.readAsText(f),E}function at(f){for(var g=new Uint8Array(f),E=new Array(g.length),S=0;S<g.length;S++)E[S]=String.fromCharCode(g[S]);return E.join("")}function it(f){if(f.slice)return f.slice(0);var g=new Uint8Array(f.byteLength);return g.set(new Uint8Array(f)),g.buffer}function rt(){return this.bodyUsed=!1,this._initBody=function(f){this._bodyInit=f,f?typeof f=="string"?this._bodyText=f:d.blob&&Blob.prototype.isPrototypeOf(f)?this._bodyBlob=f:d.formData&&FormData.prototype.isPrototypeOf(f)?this._bodyFormData=f:d.searchParams&&URLSearchParams.prototype.isPrototypeOf(f)?this._bodyText=f.toString():d.arrayBuffer&&d.blob&&y(f)?(this._bodyArrayBuffer=it(f.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):d.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(f)||C(f))?this._bodyArrayBuffer=it(f):this._bodyText=f=Object.prototype.toString.call(f):this._bodyText="",this.headers.get("content-type")||(typeof f=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):d.searchParams&&URLSearchParams.prototype.isPrototypeOf(f)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},d.blob&&(this.blob=function(){var f=H(this);if(f)return f;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?H(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(Y)}),this.text=function(){var f=H(this);if(f)return f;if(this._bodyBlob)return ct(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(at(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},d.formData&&(this.formData=function(){return this.text().then(Ot)}),this.json=function(){return this.text().then(JSON.parse)},this}var ht=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function gt(f){var g=f.toUpperCase();return ht.indexOf(g)>-1?g:f}function ut(f,g){g=g||{};var E=g.body;if(f instanceof ut){if(f.bodyUsed)throw new TypeError("Already read");this.url=f.url,this.credentials=f.credentials,g.headers||(this.headers=new q(f.headers)),this.method=f.method,this.mode=f.mode,this.signal=f.signal,!E&&f._bodyInit!=null&&(E=f._bodyInit,f.bodyUsed=!0)}else this.url=String(f);if(this.credentials=g.credentials||this.credentials||"same-origin",(g.headers||!this.headers)&&(this.headers=new q(g.headers)),this.method=gt(g.method||this.method||"GET"),this.mode=g.mode||this.mode||null,this.signal=g.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&E)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(E)}ut.prototype.clone=function(){return new ut(this,{body:this._bodyInit})};function Ot(f){var g=new FormData;return f.trim().split("&").forEach(function(E){if(E){var S=E.split("="),R=S.shift().replace(/\+/g," "),x=S.join("=").replace(/\+/g," ");g.append(decodeURIComponent(R),decodeURIComponent(x))}}),g}function Ae(f){var g=new q,E=f.replace(/\r?\n[\t ]+/g," ");return E.split(/\r?\n/).forEach(function(S){var R=S.split(":"),x=R.shift().trim();if(x){var I=R.join(":").trim();g.append(x,I)}}),g}rt.call(ut.prototype);function yt(f,g){g||(g={}),this.type="default",this.status=g.status===void 0?200:g.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in g?g.statusText:"OK",this.headers=new q(g.headers),this.url=g.url||"",this._initBody(f)}rt.call(yt.prototype),yt.prototype.clone=function(){return new yt(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new q(this.headers),url:this.url})},yt.error=function(){var f=new yt(null,{status:0,statusText:""});return f.type="error",f};var Jt=[301,302,303,307,308];yt.redirect=function(f,g){if(Jt.indexOf(g)===-1)throw new RangeError("Invalid status code");return new yt(null,{status:g,headers:{location:f}})},u.DOMException=a.DOMException;try{new u.DOMException}catch{u.DOMException=function(g,E){this.message=g,this.name=E;var S=Error(g);this.stack=S.stack},u.DOMException.prototype=Object.create(Error.prototype),u.DOMException.prototype.constructor=u.DOMException}function c(f,g){return new Promise(function(E,S){var R=new ut(f,g);if(R.signal&&R.signal.aborted)return S(new u.DOMException("Aborted","AbortError"));var x=new XMLHttpRequest;function I(){x.abort()}x.onload=function(){var p={status:x.status,statusText:x.statusText,headers:Ae(x.getAllResponseHeaders()||"")};p.url="responseURL"in x?x.responseURL:p.headers.get("X-Request-URL");var _="response"in x?x.response:x.responseText;E(new yt(_,p))},x.onerror=function(){S(new TypeError("Network request failed"))},x.ontimeout=function(){S(new TypeError("Network request failed"))},x.onabort=function(){S(new u.DOMException("Aborted","AbortError"))},x.open(R.method,R.url,!0),R.credentials==="include"?x.withCredentials=!0:R.credentials==="omit"&&(x.withCredentials=!1),"responseType"in x&&d.blob&&(x.responseType="blob"),R.headers.forEach(function(p,_){x.setRequestHeader(_,p)}),R.signal&&(R.signal.addEventListener("abort",I),x.onreadystatechange=function(){x.readyState===4&&R.signal.removeEventListener("abort",I)}),x.send(typeof R._bodyInit>"u"?null:R._bodyInit)})}return c.polyfill=!0,a.fetch||(a.fetch=c,a.Headers=q,a.Request=ut,a.Response=yt),u.Headers=q,u.Request=ut,u.Response=yt,u.fetch=c,Object.defineProperty(u,"__esModule",{value:!0}),u})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;t=o.fetch,t.default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,i.exports=t})(Pc,Pc.exports);var E8=Pc.exports;const Up=cd(E8);var _8=Object.defineProperty,I8=Object.defineProperties,S8=Object.getOwnPropertyDescriptors,$p=Object.getOwnPropertySymbols,P8=Object.prototype.hasOwnProperty,M8=Object.prototype.propertyIsEnumerable,jp=(i,t,e)=>t in i?_8(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,zp=(i,t)=>{for(var e in t||(t={}))P8.call(t,e)&&jp(i,e,t[e]);if($p)for(var e of $p(t))M8.call(t,e)&&jp(i,e,t[e]);return i},Lp=(i,t)=>I8(i,S8(t));const C8={Accept:"application/json","Content-Type":"application/json"},R8="POST",Hp={headers:C8,method:R8},Kp=10;class us{constructor(t,e=!1){if(this.url=t,this.disableProviderPing=e,this.events=new Xr.EventEmitter,this.isAvailable=!1,this.registering=!1,!Af(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=e}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t){this.isAvailable||await this.register();try{const e=fc(t),s=await(await Up(this.url,Lp(zp({},Hp),{body:e}))).json();this.onPayload({data:s})}catch(e){this.onError(t.id,e)}}async register(t=this.url){if(!Af(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise((s,o)=>{this.events.once("register_error",a=>{this.resetMaxListeners(),o(a)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const e=fc({id:1,jsonrpc:"2.0",method:"test",params:[]});await Up(t,Lp(zp({},Hp),{body:e}))}this.onOpen()}catch(e){const s=this.parseError(e);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const e=typeof t.data=="string"?ud(t.data):t.data;this.events.emit("payload",e)}onError(t,e){const s=this.parseError(e),o=s.message||s.toString(),a=Dc(t,o);this.events.emit("payload",a)}parseError(t,e=this.url){return $b(t,e,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Kp&&this.events.setMaxListeners(Kp)}}const Vp="error",N8="wss://relay.walletconnect.com",x8="wc",O8="universal_provider",Qp=`${x8}@2:${O8}:`,T8="https://rpc.walletconnect.com/v1/",Ki={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Qn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof we<"u"?we:typeof self<"u"?self:{},Mc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(i,t){(function(){var e,s="4.17.21",o=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",u="Expected a function",d="Invalid `variable` option passed into `_.template`",y="__lodash_hash_undefined__",b=500,C="__lodash_placeholder__",P=1,O=2,F=4,q=1,H=2,V=1,Y=2,ct=4,at=8,it=16,rt=32,ht=64,gt=128,ut=256,Ot=512,Ae=30,yt="...",Jt=800,c=16,f=1,g=2,E=3,S=1/0,R=9007199254740991,x=17976931348623157e292,I=0/0,p=4294967295,_=p-1,lt=p>>>1,st=[["ary",gt],["bind",V],["bindKey",Y],["curry",at],["curryRight",it],["flip",Ot],["partial",rt],["partialRight",ht],["rearg",ut]],v="[object Arguments]",$="[object Array]",k="[object AsyncFunction]",L="[object Boolean]",Z="[object Date]",W="[object DOMException]",X="[object Error]",ot="[object Function]",mt="[object GeneratorFunction]",G="[object Map]",Tt="[object Number]",Zt="[object Null]",Rt="[object Object]",Zr="[object Promise]",te="[object Proxy]",Dt="[object RegExp]",Re="[object Set]",Ft="[object String]",kt="[object Symbol]",Ei="[object Undefined]",qt="[object WeakMap]",ee="[object WeakSet]",hr="[object ArrayBuffer]",xt="[object DataView]",$t="[object Float32Array]",qr="[object Float64Array]",jt="[object Int8Array]",zt="[object Int16Array]",Br="[object Int32Array]",Lt="[object Uint8Array]",Ht="[object Uint8ClampedArray]",kr="[object Uint16Array]",Kt="[object Uint32Array]",re=/\b__p \+= '';/g,_i=/\b(__p \+=) '' \+/g,ie=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Yt=/&(?:amp|lt|gt|quot|#39);/g,ti=/[&<>"']/g,se=RegExp(Yt.source),ne=RegExp(ti.source),Ii=/<%-([\s\S]+?)%>/g,oe=/<%([\s\S]+?)%>/g,Wt=/<%=([\s\S]+?)%>/g,Si=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ae=/^\w*$/,he=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ur=/[\\^$.*+?()[\]{}|]/g,ce=RegExp(Ur.source),Vt=/^\s+/,Pi=/\s/,ue=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,le=/\{\n\/\* \[wrapped with (.+)\] \*/,Mi=/,? & /,fe=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,pe=/[()=,{}\[\]\/\s]/,Ci=/\\(\\)?/g,de=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Xt=/\w*$/,ei=/^[-+]0x[0-9a-f]+$/i,ri=/^0b[01]+$/i,ii=/^\[object .+?Constructor\]$/,si=/^0o[0-7]+$/i,ni=/^(?:0|[1-9]\d*)$/,oi=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Vi=/($^)/,mn=/['\n\r\u2028\u2029\\]/g,Qi="\\ud800-\\udfff",vn="\\u0300-\\u036f",yn="\\ufe20-\\ufe2f",wn="\\u20d0-\\u20ff",xs=vn+yn+wn,Os="\\u2700-\\u27bf",Ts="a-z\\xdf-\\xf6\\xf8-\\xff",bn="\\xac\\xb1\\xd7\\xf7",An="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",En="\\u2000-\\u206f",_n=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Yc="A-Z\\xc0-\\xd6\\xd8-\\xde",Wc="\\ufe0e\\ufe0f",Xc=bn+An+En+_n,Ma="['’]",M0="["+Qi+"]",Zc="["+Xc+"]",ao="["+xs+"]",tu="\\d+",C0="["+Os+"]",eu="["+Ts+"]",ru="[^"+Qi+Xc+tu+Os+Ts+Yc+"]",Ca="\\ud83c[\\udffb-\\udfff]",R0="(?:"+ao+"|"+Ca+")",iu="[^"+Qi+"]",Ra="(?:\\ud83c[\\udde6-\\uddff]){2}",Na="[\\ud800-\\udbff][\\udc00-\\udfff]",Ds="["+Yc+"]",su="\\u200d",nu="(?:"+eu+"|"+ru+")",N0="(?:"+Ds+"|"+ru+")",ou="(?:"+Ma+"(?:d|ll|m|re|s|t|ve))?",au="(?:"+Ma+"(?:D|LL|M|RE|S|T|VE))?",hu=R0+"?",cu="["+Wc+"]?",x0="(?:"+su+"(?:"+[iu,Ra,Na].join("|")+")"+cu+hu+")*",O0="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",T0="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",uu=cu+hu+x0,D0="(?:"+[C0,Ra,Na].join("|")+")"+uu,F0="(?:"+[iu+ao+"?",ao,Ra,Na,M0].join("|")+")",q0=RegExp(Ma,"g"),B0=RegExp(ao,"g"),xa=RegExp(Ca+"(?="+Ca+")|"+F0+uu,"g"),k0=RegExp([Ds+"?"+eu+"+"+ou+"(?="+[Zc,Ds,"$"].join("|")+")",N0+"+"+au+"(?="+[Zc,Ds+nu,"$"].join("|")+")",Ds+"?"+nu+"+"+ou,Ds+"+"+au,T0,O0,tu,D0].join("|"),"g"),U0=RegExp("["+su+Qi+xs+Wc+"]"),$0=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,j0=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],z0=-1,ve={};ve[$t]=ve[qr]=ve[jt]=ve[zt]=ve[Br]=ve[Lt]=ve[Ht]=ve[kr]=ve[Kt]=!0,ve[v]=ve[$]=ve[hr]=ve[L]=ve[xt]=ve[Z]=ve[X]=ve[ot]=ve[G]=ve[Tt]=ve[Rt]=ve[Dt]=ve[Re]=ve[Ft]=ve[qt]=!1;var me={};me[v]=me[$]=me[hr]=me[xt]=me[L]=me[Z]=me[$t]=me[qr]=me[jt]=me[zt]=me[Br]=me[G]=me[Tt]=me[Rt]=me[Dt]=me[Re]=me[Ft]=me[kt]=me[Lt]=me[Ht]=me[kr]=me[Kt]=!0,me[X]=me[ot]=me[qt]=!1;var L0={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},H0={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},K0={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},V0={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Q0=parseFloat,G0=parseInt,lu=typeof Qn=="object"&&Qn&&Qn.Object===Object&&Qn,J0=typeof self=="object"&&self&&self.Object===Object&&self,qe=lu||J0||Function("return this")(),Oa=t&&!t.nodeType&&t,ls=Oa&&!0&&i&&!i.nodeType&&i,fu=ls&&ls.exports===Oa,Ta=fu&&lu.process,br=function(){try{var T=ls&&ls.require&&ls.require("util").types;return T||Ta&&Ta.binding&&Ta.binding("util")}catch{}}(),pu=br&&br.isArrayBuffer,du=br&&br.isDate,gu=br&&br.isMap,mu=br&&br.isRegExp,vu=br&&br.isSet,yu=br&&br.isTypedArray;function cr(T,U,B){switch(B.length){case 0:return T.call(U);case 1:return T.call(U,B[0]);case 2:return T.call(U,B[0],B[1]);case 3:return T.call(U,B[0],B[1],B[2])}return T.apply(U,B)}function Y0(T,U,B,tt){for(var vt=-1,Bt=T==null?0:T.length;++vt<Bt;){var Ne=T[vt];U(tt,Ne,B(Ne),T)}return tt}function Ar(T,U){for(var B=-1,tt=T==null?0:T.length;++B<tt&&U(T[B],B,T)!==!1;);return T}function W0(T,U){for(var B=T==null?0:T.length;B--&&U(T[B],B,T)!==!1;);return T}function wu(T,U){for(var B=-1,tt=T==null?0:T.length;++B<tt;)if(!U(T[B],B,T))return!1;return!0}function Gi(T,U){for(var B=-1,tt=T==null?0:T.length,vt=0,Bt=[];++B<tt;){var Ne=T[B];U(Ne,B,T)&&(Bt[vt++]=Ne)}return Bt}function ho(T,U){var B=T==null?0:T.length;return!!B&&Fs(T,U,0)>-1}function Da(T,U,B){for(var tt=-1,vt=T==null?0:T.length;++tt<vt;)if(B(U,T[tt]))return!0;return!1}function ye(T,U){for(var B=-1,tt=T==null?0:T.length,vt=Array(tt);++B<tt;)vt[B]=U(T[B],B,T);return vt}function Ji(T,U){for(var B=-1,tt=U.length,vt=T.length;++B<tt;)T[vt+B]=U[B];return T}function Fa(T,U,B,tt){var vt=-1,Bt=T==null?0:T.length;for(tt&&Bt&&(B=T[++vt]);++vt<Bt;)B=U(B,T[vt],vt,T);return B}function X0(T,U,B,tt){var vt=T==null?0:T.length;for(tt&&vt&&(B=T[--vt]);vt--;)B=U(B,T[vt],vt,T);return B}function qa(T,U){for(var B=-1,tt=T==null?0:T.length;++B<tt;)if(U(T[B],B,T))return!0;return!1}var Z0=Ba("length");function tg(T){return T.split("")}function eg(T){return T.match(fe)||[]}function bu(T,U,B){var tt;return B(T,function(vt,Bt,Ne){if(U(vt,Bt,Ne))return tt=Bt,!1}),tt}function co(T,U,B,tt){for(var vt=T.length,Bt=B+(tt?1:-1);tt?Bt--:++Bt<vt;)if(U(T[Bt],Bt,T))return Bt;return-1}function Fs(T,U,B){return U===U?pg(T,U,B):co(T,Au,B)}function rg(T,U,B,tt){for(var vt=B-1,Bt=T.length;++vt<Bt;)if(tt(T[vt],U))return vt;return-1}function Au(T){return T!==T}function Eu(T,U){var B=T==null?0:T.length;return B?Ua(T,U)/B:I}function Ba(T){return function(U){return U==null?e:U[T]}}function ka(T){return function(U){return T==null?e:T[U]}}function _u(T,U,B,tt,vt){return vt(T,function(Bt,Ne,ge){B=tt?(tt=!1,Bt):U(B,Bt,Ne,ge)}),B}function ig(T,U){var B=T.length;for(T.sort(U);B--;)T[B]=T[B].value;return T}function Ua(T,U){for(var B,tt=-1,vt=T.length;++tt<vt;){var Bt=U(T[tt]);Bt!==e&&(B=B===e?Bt:B+Bt)}return B}function $a(T,U){for(var B=-1,tt=Array(T);++B<T;)tt[B]=U(B);return tt}function sg(T,U){return ye(U,function(B){return[B,T[B]]})}function Iu(T){return T&&T.slice(0,Cu(T)+1).replace(Vt,"")}function ur(T){return function(U){return T(U)}}function ja(T,U){return ye(U,function(B){return T[B]})}function In(T,U){return T.has(U)}function Su(T,U){for(var B=-1,tt=T.length;++B<tt&&Fs(U,T[B],0)>-1;);return B}function Pu(T,U){for(var B=T.length;B--&&Fs(U,T[B],0)>-1;);return B}function ng(T,U){for(var B=T.length,tt=0;B--;)T[B]===U&&++tt;return tt}var og=ka(L0),ag=ka(H0);function hg(T){return"\\"+V0[T]}function cg(T,U){return T==null?e:T[U]}function qs(T){return U0.test(T)}function ug(T){return $0.test(T)}function lg(T){for(var U,B=[];!(U=T.next()).done;)B.push(U.value);return B}function za(T){var U=-1,B=Array(T.size);return T.forEach(function(tt,vt){B[++U]=[vt,tt]}),B}function Mu(T,U){return function(B){return T(U(B))}}function Yi(T,U){for(var B=-1,tt=T.length,vt=0,Bt=[];++B<tt;){var Ne=T[B];(Ne===U||Ne===C)&&(T[B]=C,Bt[vt++]=B)}return Bt}function uo(T){var U=-1,B=Array(T.size);return T.forEach(function(tt){B[++U]=tt}),B}function fg(T){var U=-1,B=Array(T.size);return T.forEach(function(tt){B[++U]=[tt,tt]}),B}function pg(T,U,B){for(var tt=B-1,vt=T.length;++tt<vt;)if(T[tt]===U)return tt;return-1}function dg(T,U,B){for(var tt=B+1;tt--;)if(T[tt]===U)return tt;return tt}function Bs(T){return qs(T)?mg(T):Z0(T)}function $r(T){return qs(T)?vg(T):tg(T)}function Cu(T){for(var U=T.length;U--&&Pi.test(T.charAt(U)););return U}var gg=ka(K0);function mg(T){for(var U=xa.lastIndex=0;xa.test(T);)++U;return U}function vg(T){return T.match(xa)||[]}function yg(T){return T.match(k0)||[]}var wg=function T(U){U=U==null?qe:ks.defaults(qe.Object(),U,ks.pick(qe,j0));var B=U.Array,tt=U.Date,vt=U.Error,Bt=U.Function,Ne=U.Math,ge=U.Object,La=U.RegExp,bg=U.String,Er=U.TypeError,lo=B.prototype,Ag=Bt.prototype,Us=ge.prototype,fo=U["__core-js_shared__"],po=Ag.toString,Qt=Us.hasOwnProperty,Eg=0,Ru=function(){var r=/[^.]+$/.exec(fo&&fo.keys&&fo.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),go=Us.toString,_g=po.call(ge),Ig=qe._,Sg=La("^"+po.call(Qt).replace(Ur,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),mo=fu?U.Buffer:e,Wi=U.Symbol,vo=U.Uint8Array,Nu=mo?mo.allocUnsafe:e,yo=Mu(ge.getPrototypeOf,ge),xu=ge.create,Ou=Us.propertyIsEnumerable,wo=lo.splice,Tu=Wi?Wi.isConcatSpreadable:e,Sn=Wi?Wi.iterator:e,fs=Wi?Wi.toStringTag:e,bo=function(){try{var r=vs(ge,"defineProperty");return r({},"",{}),r}catch{}}(),Pg=U.clearTimeout!==qe.clearTimeout&&U.clearTimeout,Mg=tt&&tt.now!==qe.Date.now&&tt.now,Cg=U.setTimeout!==qe.setTimeout&&U.setTimeout,Ao=Ne.ceil,Eo=Ne.floor,Ha=ge.getOwnPropertySymbols,Rg=mo?mo.isBuffer:e,Du=U.isFinite,Ng=lo.join,xg=Mu(ge.keys,ge),xe=Ne.max,je=Ne.min,Og=tt.now,Tg=U.parseInt,Fu=Ne.random,Dg=lo.reverse,Ka=vs(U,"DataView"),Pn=vs(U,"Map"),Va=vs(U,"Promise"),$s=vs(U,"Set"),Mn=vs(U,"WeakMap"),Cn=vs(ge,"create"),_o=Mn&&new Mn,js={},Fg=ys(Ka),qg=ys(Pn),Bg=ys(Va),kg=ys($s),Ug=ys(Mn),Io=Wi?Wi.prototype:e,Rn=Io?Io.valueOf:e,qu=Io?Io.toString:e;function w(r){if(_e(r)&&!wt(r)&&!(r instanceof Pt)){if(r instanceof _r)return r;if(Qt.call(r,"__wrapped__"))return Bl(r)}return new _r(r)}var zs=function(){function r(){}return function(n){if(!Ee(n))return{};if(xu)return xu(n);r.prototype=n;var h=new r;return r.prototype=e,h}}();function So(){}function _r(r,n){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=e}w.templateSettings={escape:Ii,evaluate:oe,interpolate:Wt,variable:"",imports:{_:w}},w.prototype=So.prototype,w.prototype.constructor=w,_r.prototype=zs(So.prototype),_r.prototype.constructor=_r;function Pt(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=p,this.__views__=[]}function $g(){var r=new Pt(this.__wrapped__);return r.__actions__=tr(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=tr(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=tr(this.__views__),r}function jg(){if(this.__filtered__){var r=new Pt(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function zg(){var r=this.__wrapped__.value(),n=this.__dir__,h=wt(r),l=n<0,m=h?r.length:0,A=tm(0,m,this.__views__),M=A.start,N=A.end,D=N-M,j=l?N:M-1,z=this.__iteratees__,K=z.length,J=0,nt=je(D,this.__takeCount__);if(!h||!l&&m==D&&nt==D)return ol(r,this.__actions__);var pt=[];t:for(;D--&&J<nt;){j+=n;for(var Et=-1,dt=r[j];++Et<K;){var It=z[Et],Nt=It.iteratee,pr=It.type,Qe=Nt(dt);if(pr==g)dt=Qe;else if(!Qe){if(pr==f)continue t;break t}}pt[J++]=dt}return pt}Pt.prototype=zs(So.prototype),Pt.prototype.constructor=Pt;function ps(r){var n=-1,h=r==null?0:r.length;for(this.clear();++n<h;){var l=r[n];this.set(l[0],l[1])}}function Lg(){this.__data__=Cn?Cn(null):{},this.size=0}function Hg(r){var n=this.has(r)&&delete this.__data__[r];return this.size-=n?1:0,n}function Kg(r){var n=this.__data__;if(Cn){var h=n[r];return h===y?e:h}return Qt.call(n,r)?n[r]:e}function Vg(r){var n=this.__data__;return Cn?n[r]!==e:Qt.call(n,r)}function Qg(r,n){var h=this.__data__;return this.size+=this.has(r)?0:1,h[r]=Cn&&n===e?y:n,this}ps.prototype.clear=Lg,ps.prototype.delete=Hg,ps.prototype.get=Kg,ps.prototype.has=Vg,ps.prototype.set=Qg;function Ri(r){var n=-1,h=r==null?0:r.length;for(this.clear();++n<h;){var l=r[n];this.set(l[0],l[1])}}function Gg(){this.__data__=[],this.size=0}function Jg(r){var n=this.__data__,h=Po(n,r);if(h<0)return!1;var l=n.length-1;return h==l?n.pop():wo.call(n,h,1),--this.size,!0}function Yg(r){var n=this.__data__,h=Po(n,r);return h<0?e:n[h][1]}function Wg(r){return Po(this.__data__,r)>-1}function Xg(r,n){var h=this.__data__,l=Po(h,r);return l<0?(++this.size,h.push([r,n])):h[l][1]=n,this}Ri.prototype.clear=Gg,Ri.prototype.delete=Jg,Ri.prototype.get=Yg,Ri.prototype.has=Wg,Ri.prototype.set=Xg;function Ni(r){var n=-1,h=r==null?0:r.length;for(this.clear();++n<h;){var l=r[n];this.set(l[0],l[1])}}function Zg(){this.size=0,this.__data__={hash:new ps,map:new(Pn||Ri),string:new ps}}function t1(r){var n=ko(this,r).delete(r);return this.size-=n?1:0,n}function e1(r){return ko(this,r).get(r)}function r1(r){return ko(this,r).has(r)}function i1(r,n){var h=ko(this,r),l=h.size;return h.set(r,n),this.size+=h.size==l?0:1,this}Ni.prototype.clear=Zg,Ni.prototype.delete=t1,Ni.prototype.get=e1,Ni.prototype.has=r1,Ni.prototype.set=i1;function ds(r){var n=-1,h=r==null?0:r.length;for(this.__data__=new Ni;++n<h;)this.add(r[n])}function s1(r){return this.__data__.set(r,y),this}function n1(r){return this.__data__.has(r)}ds.prototype.add=ds.prototype.push=s1,ds.prototype.has=n1;function jr(r){var n=this.__data__=new Ri(r);this.size=n.size}function o1(){this.__data__=new Ri,this.size=0}function a1(r){var n=this.__data__,h=n.delete(r);return this.size=n.size,h}function h1(r){return this.__data__.get(r)}function c1(r){return this.__data__.has(r)}function u1(r,n){var h=this.__data__;if(h instanceof Ri){var l=h.__data__;if(!Pn||l.length<o-1)return l.push([r,n]),this.size=++h.size,this;h=this.__data__=new Ni(l)}return h.set(r,n),this.size=h.size,this}jr.prototype.clear=o1,jr.prototype.delete=a1,jr.prototype.get=h1,jr.prototype.has=c1,jr.prototype.set=u1;function Bu(r,n){var h=wt(r),l=!h&&ws(r),m=!h&&!l&&rs(r),A=!h&&!l&&!m&&Vs(r),M=h||l||m||A,N=M?$a(r.length,bg):[],D=N.length;for(var j in r)(n||Qt.call(r,j))&&!(M&&(j=="length"||m&&(j=="offset"||j=="parent")||A&&(j=="buffer"||j=="byteLength"||j=="byteOffset")||Di(j,D)))&&N.push(j);return N}function ku(r){var n=r.length;return n?r[ih(0,n-1)]:e}function l1(r,n){return Uo(tr(r),gs(n,0,r.length))}function f1(r){return Uo(tr(r))}function Qa(r,n,h){(h!==e&&!zr(r[n],h)||h===e&&!(n in r))&&xi(r,n,h)}function Nn(r,n,h){var l=r[n];(!(Qt.call(r,n)&&zr(l,h))||h===e&&!(n in r))&&xi(r,n,h)}function Po(r,n){for(var h=r.length;h--;)if(zr(r[h][0],n))return h;return-1}function p1(r,n,h,l){return Xi(r,function(m,A,M){n(l,m,h(m),M)}),l}function Uu(r,n){return r&&hi(n,Te(n),r)}function d1(r,n){return r&&hi(n,rr(n),r)}function xi(r,n,h){n=="__proto__"&&bo?bo(r,n,{configurable:!0,enumerable:!0,value:h,writable:!0}):r[n]=h}function Ga(r,n){for(var h=-1,l=n.length,m=B(l),A=r==null;++h<l;)m[h]=A?e:Ch(r,n[h]);return m}function gs(r,n,h){return r===r&&(h!==e&&(r=r<=h?r:h),n!==e&&(r=r>=n?r:n)),r}function Ir(r,n,h,l,m,A){var M,N=n&P,D=n&O,j=n&F;if(h&&(M=m?h(r,l,m,A):h(r)),M!==e)return M;if(!Ee(r))return r;var z=wt(r);if(z){if(M=rm(r),!N)return tr(r,M)}else{var K=ze(r),J=K==ot||K==mt;if(rs(r))return cl(r,N);if(K==Rt||K==v||J&&!m){if(M=D||J?{}:Cl(r),!N)return D?K1(r,d1(M,r)):H1(r,Uu(M,r))}else{if(!me[K])return m?r:{};M=im(r,K,N)}}A||(A=new jr);var nt=A.get(r);if(nt)return nt;A.set(r,M),sf(r)?r.forEach(function(dt){M.add(Ir(dt,n,h,dt,r,A))}):ef(r)&&r.forEach(function(dt,It){M.set(It,Ir(dt,n,h,It,r,A))});var pt=j?D?dh:ph:D?rr:Te,Et=z?e:pt(r);return Ar(Et||r,function(dt,It){Et&&(It=dt,dt=r[It]),Nn(M,It,Ir(dt,n,h,It,r,A))}),M}function g1(r){var n=Te(r);return function(h){return $u(h,r,n)}}function $u(r,n,h){var l=h.length;if(r==null)return!l;for(r=ge(r);l--;){var m=h[l],A=n[m],M=r[m];if(M===e&&!(m in r)||!A(M))return!1}return!0}function ju(r,n,h){if(typeof r!="function")throw new Er(u);return Bn(function(){r.apply(e,h)},n)}function xn(r,n,h,l){var m=-1,A=ho,M=!0,N=r.length,D=[],j=n.length;if(!N)return D;h&&(n=ye(n,ur(h))),l?(A=Da,M=!1):n.length>=o&&(A=In,M=!1,n=new ds(n));t:for(;++m<N;){var z=r[m],K=h==null?z:h(z);if(z=l||z!==0?z:0,M&&K===K){for(var J=j;J--;)if(n[J]===K)continue t;D.push(z)}else A(n,K,l)||D.push(z)}return D}var Xi=dl(ai),zu=dl(Ya,!0);function m1(r,n){var h=!0;return Xi(r,function(l,m,A){return h=!!n(l,m,A),h}),h}function Mo(r,n,h){for(var l=-1,m=r.length;++l<m;){var A=r[l],M=n(A);if(M!=null&&(N===e?M===M&&!fr(M):h(M,N)))var N=M,D=A}return D}function v1(r,n,h,l){var m=r.length;for(h=At(h),h<0&&(h=-h>m?0:m+h),l=l===e||l>m?m:At(l),l<0&&(l+=m),l=h>l?0:of(l);h<l;)r[h++]=n;return r}function Lu(r,n){var h=[];return Xi(r,function(l,m,A){n(l,m,A)&&h.push(l)}),h}function Be(r,n,h,l,m){var A=-1,M=r.length;for(h||(h=nm),m||(m=[]);++A<M;){var N=r[A];n>0&&h(N)?n>1?Be(N,n-1,h,l,m):Ji(m,N):l||(m[m.length]=N)}return m}var Ja=gl(),Hu=gl(!0);function ai(r,n){return r&&Ja(r,n,Te)}function Ya(r,n){return r&&Hu(r,n,Te)}function Co(r,n){return Gi(n,function(h){return Fi(r[h])})}function ms(r,n){n=ts(n,r);for(var h=0,l=n.length;r!=null&&h<l;)r=r[ci(n[h++])];return h&&h==l?r:e}function Ku(r,n,h){var l=n(r);return wt(r)?l:Ji(l,h(r))}function Ke(r){return r==null?r===e?Ei:Zt:fs&&fs in ge(r)?Z1(r):fm(r)}function Wa(r,n){return r>n}function y1(r,n){return r!=null&&Qt.call(r,n)}function w1(r,n){return r!=null&&n in ge(r)}function b1(r,n,h){return r>=je(n,h)&&r<xe(n,h)}function Xa(r,n,h){for(var l=h?Da:ho,m=r[0].length,A=r.length,M=A,N=B(A),D=1/0,j=[];M--;){var z=r[M];M&&n&&(z=ye(z,ur(n))),D=je(z.length,D),N[M]=!h&&(n||m>=120&&z.length>=120)?new ds(M&&z):e}z=r[0];var K=-1,J=N[0];t:for(;++K<m&&j.length<D;){var nt=z[K],pt=n?n(nt):nt;if(nt=h||nt!==0?nt:0,!(J?In(J,pt):l(j,pt,h))){for(M=A;--M;){var Et=N[M];if(!(Et?In(Et,pt):l(r[M],pt,h)))continue t}J&&J.push(pt),j.push(nt)}}return j}function A1(r,n,h,l){return ai(r,function(m,A,M){n(l,h(m),A,M)}),l}function On(r,n,h){n=ts(n,r),r=Ol(r,n);var l=r==null?r:r[ci(Pr(n))];return l==null?e:cr(l,r,h)}function Vu(r){return _e(r)&&Ke(r)==v}function E1(r){return _e(r)&&Ke(r)==hr}function _1(r){return _e(r)&&Ke(r)==Z}function Tn(r,n,h,l,m){return r===n?!0:r==null||n==null||!_e(r)&&!_e(n)?r!==r&&n!==n:I1(r,n,h,l,Tn,m)}function I1(r,n,h,l,m,A){var M=wt(r),N=wt(n),D=M?$:ze(r),j=N?$:ze(n);D=D==v?Rt:D,j=j==v?Rt:j;var z=D==Rt,K=j==Rt,J=D==j;if(J&&rs(r)){if(!rs(n))return!1;M=!0,z=!1}if(J&&!z)return A||(A=new jr),M||Vs(r)?Sl(r,n,h,l,m,A):W1(r,n,D,h,l,m,A);if(!(h&q)){var nt=z&&Qt.call(r,"__wrapped__"),pt=K&&Qt.call(n,"__wrapped__");if(nt||pt){var Et=nt?r.value():r,dt=pt?n.value():n;return A||(A=new jr),m(Et,dt,h,l,A)}}return J?(A||(A=new jr),X1(r,n,h,l,m,A)):!1}function S1(r){return _e(r)&&ze(r)==G}function Za(r,n,h,l){var m=h.length,A=m,M=!l;if(r==null)return!A;for(r=ge(r);m--;){var N=h[m];if(M&&N[2]?N[1]!==r[N[0]]:!(N[0]in r))return!1}for(;++m<A;){N=h[m];var D=N[0],j=r[D],z=N[1];if(M&&N[2]){if(j===e&&!(D in r))return!1}else{var K=new jr;if(l)var J=l(j,z,D,r,n,K);if(!(J===e?Tn(z,j,q|H,l,K):J))return!1}}return!0}function Qu(r){if(!Ee(r)||am(r))return!1;var n=Fi(r)?Sg:ii;return n.test(ys(r))}function P1(r){return _e(r)&&Ke(r)==Dt}function M1(r){return _e(r)&&ze(r)==Re}function C1(r){return _e(r)&&Ko(r.length)&&!!ve[Ke(r)]}function Gu(r){return typeof r=="function"?r:r==null?ir:typeof r=="object"?wt(r)?Wu(r[0],r[1]):Yu(r):vf(r)}function th(r){if(!qn(r))return xg(r);var n=[];for(var h in ge(r))Qt.call(r,h)&&h!="constructor"&&n.push(h);return n}function R1(r){if(!Ee(r))return lm(r);var n=qn(r),h=[];for(var l in r)l=="constructor"&&(n||!Qt.call(r,l))||h.push(l);return h}function eh(r,n){return r<n}function Ju(r,n){var h=-1,l=er(r)?B(r.length):[];return Xi(r,function(m,A,M){l[++h]=n(m,A,M)}),l}function Yu(r){var n=mh(r);return n.length==1&&n[0][2]?Nl(n[0][0],n[0][1]):function(h){return h===r||Za(h,r,n)}}function Wu(r,n){return yh(r)&&Rl(n)?Nl(ci(r),n):function(h){var l=Ch(h,r);return l===e&&l===n?Rh(h,r):Tn(n,l,q|H)}}function Ro(r,n,h,l,m){r!==n&&Ja(n,function(A,M){if(m||(m=new jr),Ee(A))N1(r,n,M,h,Ro,l,m);else{var N=l?l(bh(r,M),A,M+"",r,n,m):e;N===e&&(N=A),Qa(r,M,N)}},rr)}function N1(r,n,h,l,m,A,M){var N=bh(r,h),D=bh(n,h),j=M.get(D);if(j){Qa(r,h,j);return}var z=A?A(N,D,h+"",r,n,M):e,K=z===e;if(K){var J=wt(D),nt=!J&&rs(D),pt=!J&&!nt&&Vs(D);z=D,J||nt||pt?wt(N)?z=N:Se(N)?z=tr(N):nt?(K=!1,z=cl(D,!0)):pt?(K=!1,z=ul(D,!0)):z=[]:kn(D)||ws(D)?(z=N,ws(N)?z=af(N):(!Ee(N)||Fi(N))&&(z=Cl(D))):K=!1}K&&(M.set(D,z),m(z,D,l,A,M),M.delete(D)),Qa(r,h,z)}function Xu(r,n){var h=r.length;if(h)return n+=n<0?h:0,Di(n,h)?r[n]:e}function Zu(r,n,h){n.length?n=ye(n,function(A){return wt(A)?function(M){return ms(M,A.length===1?A[0]:A)}:A}):n=[ir];var l=-1;n=ye(n,ur(ft()));var m=Ju(r,function(A,M,N){var D=ye(n,function(j){return j(A)});return{criteria:D,index:++l,value:A}});return ig(m,function(A,M){return L1(A,M,h)})}function x1(r,n){return tl(r,n,function(h,l){return Rh(r,l)})}function tl(r,n,h){for(var l=-1,m=n.length,A={};++l<m;){var M=n[l],N=ms(r,M);h(N,M)&&Dn(A,ts(M,r),N)}return A}function O1(r){return function(n){return ms(n,r)}}function rh(r,n,h,l){var m=l?rg:Fs,A=-1,M=n.length,N=r;for(r===n&&(n=tr(n)),h&&(N=ye(r,ur(h)));++A<M;)for(var D=0,j=n[A],z=h?h(j):j;(D=m(N,z,D,l))>-1;)N!==r&&wo.call(N,D,1),wo.call(r,D,1);return r}function el(r,n){for(var h=r?n.length:0,l=h-1;h--;){var m=n[h];if(h==l||m!==A){var A=m;Di(m)?wo.call(r,m,1):oh(r,m)}}return r}function ih(r,n){return r+Eo(Fu()*(n-r+1))}function T1(r,n,h,l){for(var m=-1,A=xe(Ao((n-r)/(h||1)),0),M=B(A);A--;)M[l?A:++m]=r,r+=h;return M}function sh(r,n){var h="";if(!r||n<1||n>R)return h;do n%2&&(h+=r),n=Eo(n/2),n&&(r+=r);while(n);return h}function _t(r,n){return Ah(xl(r,n,ir),r+"")}function D1(r){return ku(Qs(r))}function F1(r,n){var h=Qs(r);return Uo(h,gs(n,0,h.length))}function Dn(r,n,h,l){if(!Ee(r))return r;n=ts(n,r);for(var m=-1,A=n.length,M=A-1,N=r;N!=null&&++m<A;){var D=ci(n[m]),j=h;if(D==="__proto__"||D==="constructor"||D==="prototype")return r;if(m!=M){var z=N[D];j=l?l(z,D,N):e,j===e&&(j=Ee(z)?z:Di(n[m+1])?[]:{})}Nn(N,D,j),N=N[D]}return r}var rl=_o?function(r,n){return _o.set(r,n),r}:ir,q1=bo?function(r,n){return bo(r,"toString",{configurable:!0,enumerable:!1,value:xh(n),writable:!0})}:ir;function B1(r){return Uo(Qs(r))}function Sr(r,n,h){var l=-1,m=r.length;n<0&&(n=-n>m?0:m+n),h=h>m?m:h,h<0&&(h+=m),m=n>h?0:h-n>>>0,n>>>=0;for(var A=B(m);++l<m;)A[l]=r[l+n];return A}function k1(r,n){var h;return Xi(r,function(l,m,A){return h=n(l,m,A),!h}),!!h}function No(r,n,h){var l=0,m=r==null?l:r.length;if(typeof n=="number"&&n===n&&m<=lt){for(;l<m;){var A=l+m>>>1,M=r[A];M!==null&&!fr(M)&&(h?M<=n:M<n)?l=A+1:m=A}return m}return nh(r,n,ir,h)}function nh(r,n,h,l){var m=0,A=r==null?0:r.length;if(A===0)return 0;n=h(n);for(var M=n!==n,N=n===null,D=fr(n),j=n===e;m<A;){var z=Eo((m+A)/2),K=h(r[z]),J=K!==e,nt=K===null,pt=K===K,Et=fr(K);if(M)var dt=l||pt;else j?dt=pt&&(l||J):N?dt=pt&&J&&(l||!nt):D?dt=pt&&J&&!nt&&(l||!Et):nt||Et?dt=!1:dt=l?K<=n:K<n;dt?m=z+1:A=z}return je(A,_)}function il(r,n){for(var h=-1,l=r.length,m=0,A=[];++h<l;){var M=r[h],N=n?n(M):M;if(!h||!zr(N,D)){var D=N;A[m++]=M===0?0:M}}return A}function sl(r){return typeof r=="number"?r:fr(r)?I:+r}function lr(r){if(typeof r=="string")return r;if(wt(r))return ye(r,lr)+"";if(fr(r))return qu?qu.call(r):"";var n=r+"";return n=="0"&&1/r==-S?"-0":n}function Zi(r,n,h){var l=-1,m=ho,A=r.length,M=!0,N=[],D=N;if(h)M=!1,m=Da;else if(A>=o){var j=n?null:J1(r);if(j)return uo(j);M=!1,m=In,D=new ds}else D=n?[]:N;t:for(;++l<A;){var z=r[l],K=n?n(z):z;if(z=h||z!==0?z:0,M&&K===K){for(var J=D.length;J--;)if(D[J]===K)continue t;n&&D.push(K),N.push(z)}else m(D,K,h)||(D!==N&&D.push(K),N.push(z))}return N}function oh(r,n){return n=ts(n,r),r=Ol(r,n),r==null||delete r[ci(Pr(n))]}function nl(r,n,h,l){return Dn(r,n,h(ms(r,n)),l)}function xo(r,n,h,l){for(var m=r.length,A=l?m:-1;(l?A--:++A<m)&&n(r[A],A,r););return h?Sr(r,l?0:A,l?A+1:m):Sr(r,l?A+1:0,l?m:A)}function ol(r,n){var h=r;return h instanceof Pt&&(h=h.value()),Fa(n,function(l,m){return m.func.apply(m.thisArg,Ji([l],m.args))},h)}function ah(r,n,h){var l=r.length;if(l<2)return l?Zi(r[0]):[];for(var m=-1,A=B(l);++m<l;)for(var M=r[m],N=-1;++N<l;)N!=m&&(A[m]=xn(A[m]||M,r[N],n,h));return Zi(Be(A,1),n,h)}function al(r,n,h){for(var l=-1,m=r.length,A=n.length,M={};++l<m;){var N=l<A?n[l]:e;h(M,r[l],N)}return M}function hh(r){return Se(r)?r:[]}function ch(r){return typeof r=="function"?r:ir}function ts(r,n){return wt(r)?r:yh(r,n)?[r]:ql(Ut(r))}var U1=_t;function es(r,n,h){var l=r.length;return h=h===e?l:h,!n&&h>=l?r:Sr(r,n,h)}var hl=Pg||function(r){return qe.clearTimeout(r)};function cl(r,n){if(n)return r.slice();var h=r.length,l=Nu?Nu(h):new r.constructor(h);return r.copy(l),l}function uh(r){var n=new r.constructor(r.byteLength);return new vo(n).set(new vo(r)),n}function $1(r,n){var h=n?uh(r.buffer):r.buffer;return new r.constructor(h,r.byteOffset,r.byteLength)}function j1(r){var n=new r.constructor(r.source,Xt.exec(r));return n.lastIndex=r.lastIndex,n}function z1(r){return Rn?ge(Rn.call(r)):{}}function ul(r,n){var h=n?uh(r.buffer):r.buffer;return new r.constructor(h,r.byteOffset,r.length)}function ll(r,n){if(r!==n){var h=r!==e,l=r===null,m=r===r,A=fr(r),M=n!==e,N=n===null,D=n===n,j=fr(n);if(!N&&!j&&!A&&r>n||A&&M&&D&&!N&&!j||l&&M&&D||!h&&D||!m)return 1;if(!l&&!A&&!j&&r<n||j&&h&&m&&!l&&!A||N&&h&&m||!M&&m||!D)return-1}return 0}function L1(r,n,h){for(var l=-1,m=r.criteria,A=n.criteria,M=m.length,N=h.length;++l<M;){var D=ll(m[l],A[l]);if(D){if(l>=N)return D;var j=h[l];return D*(j=="desc"?-1:1)}}return r.index-n.index}function fl(r,n,h,l){for(var m=-1,A=r.length,M=h.length,N=-1,D=n.length,j=xe(A-M,0),z=B(D+j),K=!l;++N<D;)z[N]=n[N];for(;++m<M;)(K||m<A)&&(z[h[m]]=r[m]);for(;j--;)z[N++]=r[m++];return z}function pl(r,n,h,l){for(var m=-1,A=r.length,M=-1,N=h.length,D=-1,j=n.length,z=xe(A-N,0),K=B(z+j),J=!l;++m<z;)K[m]=r[m];for(var nt=m;++D<j;)K[nt+D]=n[D];for(;++M<N;)(J||m<A)&&(K[nt+h[M]]=r[m++]);return K}function tr(r,n){var h=-1,l=r.length;for(n||(n=B(l));++h<l;)n[h]=r[h];return n}function hi(r,n,h,l){var m=!h;h||(h={});for(var A=-1,M=n.length;++A<M;){var N=n[A],D=l?l(h[N],r[N],N,h,r):e;D===e&&(D=r[N]),m?xi(h,N,D):Nn(h,N,D)}return h}function H1(r,n){return hi(r,vh(r),n)}function K1(r,n){return hi(r,Pl(r),n)}function Oo(r,n){return function(h,l){var m=wt(h)?Y0:p1,A=n?n():{};return m(h,r,ft(l,2),A)}}function Ls(r){return _t(function(n,h){var l=-1,m=h.length,A=m>1?h[m-1]:e,M=m>2?h[2]:e;for(A=r.length>3&&typeof A=="function"?(m--,A):e,M&&Ve(h[0],h[1],M)&&(A=m<3?e:A,m=1),n=ge(n);++l<m;){var N=h[l];N&&r(n,N,l,A)}return n})}function dl(r,n){return function(h,l){if(h==null)return h;if(!er(h))return r(h,l);for(var m=h.length,A=n?m:-1,M=ge(h);(n?A--:++A<m)&&l(M[A],A,M)!==!1;);return h}}function gl(r){return function(n,h,l){for(var m=-1,A=ge(n),M=l(n),N=M.length;N--;){var D=M[r?N:++m];if(h(A[D],D,A)===!1)break}return n}}function V1(r,n,h){var l=n&V,m=Fn(r);function A(){var M=this&&this!==qe&&this instanceof A?m:r;return M.apply(l?h:this,arguments)}return A}function ml(r){return function(n){n=Ut(n);var h=qs(n)?$r(n):e,l=h?h[0]:n.charAt(0),m=h?es(h,1).join(""):n.slice(1);return l[r]()+m}}function Hs(r){return function(n){return Fa(gf(df(n).replace(q0,"")),r,"")}}function Fn(r){return function(){var n=arguments;switch(n.length){case 0:return new r;case 1:return new r(n[0]);case 2:return new r(n[0],n[1]);case 3:return new r(n[0],n[1],n[2]);case 4:return new r(n[0],n[1],n[2],n[3]);case 5:return new r(n[0],n[1],n[2],n[3],n[4]);case 6:return new r(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new r(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var h=zs(r.prototype),l=r.apply(h,n);return Ee(l)?l:h}}function Q1(r,n,h){var l=Fn(r);function m(){for(var A=arguments.length,M=B(A),N=A,D=Ks(m);N--;)M[N]=arguments[N];var j=A<3&&M[0]!==D&&M[A-1]!==D?[]:Yi(M,D);if(A-=j.length,A<h)return Al(r,n,To,m.placeholder,e,M,j,e,e,h-A);var z=this&&this!==qe&&this instanceof m?l:r;return cr(z,this,M)}return m}function vl(r){return function(n,h,l){var m=ge(n);if(!er(n)){var A=ft(h,3);n=Te(n),h=function(N){return A(m[N],N,m)}}var M=r(n,h,l);return M>-1?m[A?n[M]:M]:e}}function yl(r){return Ti(function(n){var h=n.length,l=h,m=_r.prototype.thru;for(r&&n.reverse();l--;){var A=n[l];if(typeof A!="function")throw new Er(u);if(m&&!M&&Bo(A)=="wrapper")var M=new _r([],!0)}for(l=M?l:h;++l<h;){A=n[l];var N=Bo(A),D=N=="wrapper"?gh(A):e;D&&wh(D[0])&&D[1]==(gt|at|rt|ut)&&!D[4].length&&D[9]==1?M=M[Bo(D[0])].apply(M,D[3]):M=A.length==1&&wh(A)?M[N]():M.thru(A)}return function(){var j=arguments,z=j[0];if(M&&j.length==1&&wt(z))return M.plant(z).value();for(var K=0,J=h?n[K].apply(this,j):z;++K<h;)J=n[K].call(this,J);return J}})}function To(r,n,h,l,m,A,M,N,D,j){var z=n&gt,K=n&V,J=n&Y,nt=n&(at|it),pt=n&Ot,Et=J?e:Fn(r);function dt(){for(var It=arguments.length,Nt=B(It),pr=It;pr--;)Nt[pr]=arguments[pr];if(nt)var Qe=Ks(dt),dr=ng(Nt,Qe);if(l&&(Nt=fl(Nt,l,m,nt)),A&&(Nt=pl(Nt,A,M,nt)),It-=dr,nt&&It<j){var Pe=Yi(Nt,Qe);return Al(r,n,To,dt.placeholder,h,Nt,Pe,N,D,j-It)}var Lr=K?h:this,Bi=J?Lr[r]:r;return It=Nt.length,N?Nt=pm(Nt,N):pt&&It>1&&Nt.reverse(),z&&D<It&&(Nt.length=D),this&&this!==qe&&this instanceof dt&&(Bi=Et||Fn(Bi)),Bi.apply(Lr,Nt)}return dt}function wl(r,n){return function(h,l){return A1(h,r,n(l),{})}}function Do(r,n){return function(h,l){var m;if(h===e&&l===e)return n;if(h!==e&&(m=h),l!==e){if(m===e)return l;typeof h=="string"||typeof l=="string"?(h=lr(h),l=lr(l)):(h=sl(h),l=sl(l)),m=r(h,l)}return m}}function lh(r){return Ti(function(n){return n=ye(n,ur(ft())),_t(function(h){var l=this;return r(n,function(m){return cr(m,l,h)})})})}function Fo(r,n){n=n===e?" ":lr(n);var h=n.length;if(h<2)return h?sh(n,r):n;var l=sh(n,Ao(r/Bs(n)));return qs(n)?es($r(l),0,r).join(""):l.slice(0,r)}function G1(r,n,h,l){var m=n&V,A=Fn(r);function M(){for(var N=-1,D=arguments.length,j=-1,z=l.length,K=B(z+D),J=this&&this!==qe&&this instanceof M?A:r;++j<z;)K[j]=l[j];for(;D--;)K[j++]=arguments[++N];return cr(J,m?h:this,K)}return M}function bl(r){return function(n,h,l){return l&&typeof l!="number"&&Ve(n,h,l)&&(h=l=e),n=qi(n),h===e?(h=n,n=0):h=qi(h),l=l===e?n<h?1:-1:qi(l),T1(n,h,l,r)}}function qo(r){return function(n,h){return typeof n=="string"&&typeof h=="string"||(n=Mr(n),h=Mr(h)),r(n,h)}}function Al(r,n,h,l,m,A,M,N,D,j){var z=n&at,K=z?M:e,J=z?e:M,nt=z?A:e,pt=z?e:A;n|=z?rt:ht,n&=~(z?ht:rt),n&ct||(n&=~(V|Y));var Et=[r,n,m,nt,K,pt,J,N,D,j],dt=h.apply(e,Et);return wh(r)&&Tl(dt,Et),dt.placeholder=l,Dl(dt,r,n)}function fh(r){var n=Ne[r];return function(h,l){if(h=Mr(h),l=l==null?0:je(At(l),292),l&&Du(h)){var m=(Ut(h)+"e").split("e"),A=n(m[0]+"e"+(+m[1]+l));return m=(Ut(A)+"e").split("e"),+(m[0]+"e"+(+m[1]-l))}return n(h)}}var J1=$s&&1/uo(new $s([,-0]))[1]==S?function(r){return new $s(r)}:Dh;function El(r){return function(n){var h=ze(n);return h==G?za(n):h==Re?fg(n):sg(n,r(n))}}function Oi(r,n,h,l,m,A,M,N){var D=n&Y;if(!D&&typeof r!="function")throw new Er(u);var j=l?l.length:0;if(j||(n&=~(rt|ht),l=m=e),M=M===e?M:xe(At(M),0),N=N===e?N:At(N),j-=m?m.length:0,n&ht){var z=l,K=m;l=m=e}var J=D?e:gh(r),nt=[r,n,h,l,m,z,K,A,M,N];if(J&&um(nt,J),r=nt[0],n=nt[1],h=nt[2],l=nt[3],m=nt[4],N=nt[9]=nt[9]===e?D?0:r.length:xe(nt[9]-j,0),!N&&n&(at|it)&&(n&=~(at|it)),!n||n==V)var pt=V1(r,n,h);else n==at||n==it?pt=Q1(r,n,N):(n==rt||n==(V|rt))&&!m.length?pt=G1(r,n,h,l):pt=To.apply(e,nt);var Et=J?rl:Tl;return Dl(Et(pt,nt),r,n)}function _l(r,n,h,l){return r===e||zr(r,Us[h])&&!Qt.call(l,h)?n:r}function Il(r,n,h,l,m,A){return Ee(r)&&Ee(n)&&(A.set(n,r),Ro(r,n,e,Il,A),A.delete(n)),r}function Y1(r){return kn(r)?e:r}function Sl(r,n,h,l,m,A){var M=h&q,N=r.length,D=n.length;if(N!=D&&!(M&&D>N))return!1;var j=A.get(r),z=A.get(n);if(j&&z)return j==n&&z==r;var K=-1,J=!0,nt=h&H?new ds:e;for(A.set(r,n),A.set(n,r);++K<N;){var pt=r[K],Et=n[K];if(l)var dt=M?l(Et,pt,K,n,r,A):l(pt,Et,K,r,n,A);if(dt!==e){if(dt)continue;J=!1;break}if(nt){if(!qa(n,function(It,Nt){if(!In(nt,Nt)&&(pt===It||m(pt,It,h,l,A)))return nt.push(Nt)})){J=!1;break}}else if(!(pt===Et||m(pt,Et,h,l,A))){J=!1;break}}return A.delete(r),A.delete(n),J}function W1(r,n,h,l,m,A,M){switch(h){case xt:if(r.byteLength!=n.byteLength||r.byteOffset!=n.byteOffset)return!1;r=r.buffer,n=n.buffer;case hr:return!(r.byteLength!=n.byteLength||!A(new vo(r),new vo(n)));case L:case Z:case Tt:return zr(+r,+n);case X:return r.name==n.name&&r.message==n.message;case Dt:case Ft:return r==n+"";case G:var N=za;case Re:var D=l&q;if(N||(N=uo),r.size!=n.size&&!D)return!1;var j=M.get(r);if(j)return j==n;l|=H,M.set(r,n);var z=Sl(N(r),N(n),l,m,A,M);return M.delete(r),z;case kt:if(Rn)return Rn.call(r)==Rn.call(n)}return!1}function X1(r,n,h,l,m,A){var M=h&q,N=ph(r),D=N.length,j=ph(n),z=j.length;if(D!=z&&!M)return!1;for(var K=D;K--;){var J=N[K];if(!(M?J in n:Qt.call(n,J)))return!1}var nt=A.get(r),pt=A.get(n);if(nt&&pt)return nt==n&&pt==r;var Et=!0;A.set(r,n),A.set(n,r);for(var dt=M;++K<D;){J=N[K];var It=r[J],Nt=n[J];if(l)var pr=M?l(Nt,It,J,n,r,A):l(It,Nt,J,r,n,A);if(!(pr===e?It===Nt||m(It,Nt,h,l,A):pr)){Et=!1;break}dt||(dt=J=="constructor")}if(Et&&!dt){var Qe=r.constructor,dr=n.constructor;Qe!=dr&&"constructor"in r&&"constructor"in n&&!(typeof Qe=="function"&&Qe instanceof Qe&&typeof dr=="function"&&dr instanceof dr)&&(Et=!1)}return A.delete(r),A.delete(n),Et}function Ti(r){return Ah(xl(r,e,$l),r+"")}function ph(r){return Ku(r,Te,vh)}function dh(r){return Ku(r,rr,Pl)}var gh=_o?function(r){return _o.get(r)}:Dh;function Bo(r){for(var n=r.name+"",h=js[n],l=Qt.call(js,n)?h.length:0;l--;){var m=h[l],A=m.func;if(A==null||A==r)return m.name}return n}function Ks(r){var n=Qt.call(w,"placeholder")?w:r;return n.placeholder}function ft(){var r=w.iteratee||Oh;return r=r===Oh?Gu:r,arguments.length?r(arguments[0],arguments[1]):r}function ko(r,n){var h=r.__data__;return om(n)?h[typeof n=="string"?"string":"hash"]:h.map}function mh(r){for(var n=Te(r),h=n.length;h--;){var l=n[h],m=r[l];n[h]=[l,m,Rl(m)]}return n}function vs(r,n){var h=cg(r,n);return Qu(h)?h:e}function Z1(r){var n=Qt.call(r,fs),h=r[fs];try{r[fs]=e;var l=!0}catch{}var m=go.call(r);return l&&(n?r[fs]=h:delete r[fs]),m}var vh=Ha?function(r){return r==null?[]:(r=ge(r),Gi(Ha(r),function(n){return Ou.call(r,n)}))}:Fh,Pl=Ha?function(r){for(var n=[];r;)Ji(n,vh(r)),r=yo(r);return n}:Fh,ze=Ke;(Ka&&ze(new Ka(new ArrayBuffer(1)))!=xt||Pn&&ze(new Pn)!=G||Va&&ze(Va.resolve())!=Zr||$s&&ze(new $s)!=Re||Mn&&ze(new Mn)!=qt)&&(ze=function(r){var n=Ke(r),h=n==Rt?r.constructor:e,l=h?ys(h):"";if(l)switch(l){case Fg:return xt;case qg:return G;case Bg:return Zr;case kg:return Re;case Ug:return qt}return n});function tm(r,n,h){for(var l=-1,m=h.length;++l<m;){var A=h[l],M=A.size;switch(A.type){case"drop":r+=M;break;case"dropRight":n-=M;break;case"take":n=je(n,r+M);break;case"takeRight":r=xe(r,n-M);break}}return{start:r,end:n}}function em(r){var n=r.match(le);return n?n[1].split(Mi):[]}function Ml(r,n,h){n=ts(n,r);for(var l=-1,m=n.length,A=!1;++l<m;){var M=ci(n[l]);if(!(A=r!=null&&h(r,M)))break;r=r[M]}return A||++l!=m?A:(m=r==null?0:r.length,!!m&&Ko(m)&&Di(M,m)&&(wt(r)||ws(r)))}function rm(r){var n=r.length,h=new r.constructor(n);return n&&typeof r[0]=="string"&&Qt.call(r,"index")&&(h.index=r.index,h.input=r.input),h}function Cl(r){return typeof r.constructor=="function"&&!qn(r)?zs(yo(r)):{}}function im(r,n,h){var l=r.constructor;switch(n){case hr:return uh(r);case L:case Z:return new l(+r);case xt:return $1(r,h);case $t:case qr:case jt:case zt:case Br:case Lt:case Ht:case kr:case Kt:return ul(r,h);case G:return new l;case Tt:case Ft:return new l(r);case Dt:return j1(r);case Re:return new l;case kt:return z1(r)}}function sm(r,n){var h=n.length;if(!h)return r;var l=h-1;return n[l]=(h>1?"& ":"")+n[l],n=n.join(h>2?", ":" "),r.replace(ue,`{
/* [wrapped with `+n+`] */
`)}function nm(r){return wt(r)||ws(r)||!!(Tu&&r&&r[Tu])}function Di(r,n){var h=typeof r;return n=n??R,!!n&&(h=="number"||h!="symbol"&&ni.test(r))&&r>-1&&r%1==0&&r<n}function Ve(r,n,h){if(!Ee(h))return!1;var l=typeof n;return(l=="number"?er(h)&&Di(n,h.length):l=="string"&&n in h)?zr(h[n],r):!1}function yh(r,n){if(wt(r))return!1;var h=typeof r;return h=="number"||h=="symbol"||h=="boolean"||r==null||fr(r)?!0:ae.test(r)||!Si.test(r)||n!=null&&r in ge(n)}function om(r){var n=typeof r;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?r!=="__proto__":r===null}function wh(r){var n=Bo(r),h=w[n];if(typeof h!="function"||!(n in Pt.prototype))return!1;if(r===h)return!0;var l=gh(h);return!!l&&r===l[0]}function am(r){return!!Ru&&Ru in r}var hm=fo?Fi:qh;function qn(r){var n=r&&r.constructor,h=typeof n=="function"&&n.prototype||Us;return r===h}function Rl(r){return r===r&&!Ee(r)}function Nl(r,n){return function(h){return h==null?!1:h[r]===n&&(n!==e||r in ge(h))}}function cm(r){var n=Lo(r,function(l){return h.size===b&&h.clear(),l}),h=n.cache;return n}function um(r,n){var h=r[1],l=n[1],m=h|l,A=m<(V|Y|gt),M=l==gt&&h==at||l==gt&&h==ut&&r[7].length<=n[8]||l==(gt|ut)&&n[7].length<=n[8]&&h==at;if(!(A||M))return r;l&V&&(r[2]=n[2],m|=h&V?0:ct);var N=n[3];if(N){var D=r[3];r[3]=D?fl(D,N,n[4]):N,r[4]=D?Yi(r[3],C):n[4]}return N=n[5],N&&(D=r[5],r[5]=D?pl(D,N,n[6]):N,r[6]=D?Yi(r[5],C):n[6]),N=n[7],N&&(r[7]=N),l&gt&&(r[8]=r[8]==null?n[8]:je(r[8],n[8])),r[9]==null&&(r[9]=n[9]),r[0]=n[0],r[1]=m,r}function lm(r){var n=[];if(r!=null)for(var h in ge(r))n.push(h);return n}function fm(r){return go.call(r)}function xl(r,n,h){return n=xe(n===e?r.length-1:n,0),function(){for(var l=arguments,m=-1,A=xe(l.length-n,0),M=B(A);++m<A;)M[m]=l[n+m];m=-1;for(var N=B(n+1);++m<n;)N[m]=l[m];return N[n]=h(M),cr(r,this,N)}}function Ol(r,n){return n.length<2?r:ms(r,Sr(n,0,-1))}function pm(r,n){for(var h=r.length,l=je(n.length,h),m=tr(r);l--;){var A=n[l];r[l]=Di(A,h)?m[A]:e}return r}function bh(r,n){if(!(n==="constructor"&&typeof r[n]=="function")&&n!="__proto__")return r[n]}var Tl=Fl(rl),Bn=Cg||function(r,n){return qe.setTimeout(r,n)},Ah=Fl(q1);function Dl(r,n,h){var l=n+"";return Ah(r,sm(l,dm(em(l),h)))}function Fl(r){var n=0,h=0;return function(){var l=Og(),m=c-(l-h);if(h=l,m>0){if(++n>=Jt)return arguments[0]}else n=0;return r.apply(e,arguments)}}function Uo(r,n){var h=-1,l=r.length,m=l-1;for(n=n===e?l:n;++h<n;){var A=ih(h,m),M=r[A];r[A]=r[h],r[h]=M}return r.length=n,r}var ql=cm(function(r){var n=[];return r.charCodeAt(0)===46&&n.push(""),r.replace(he,function(h,l,m,A){n.push(m?A.replace(Ci,"$1"):l||h)}),n});function ci(r){if(typeof r=="string"||fr(r))return r;var n=r+"";return n=="0"&&1/r==-S?"-0":n}function ys(r){if(r!=null){try{return po.call(r)}catch{}try{return r+""}catch{}}return""}function dm(r,n){return Ar(st,function(h){var l="_."+h[0];n&h[1]&&!ho(r,l)&&r.push(l)}),r.sort()}function Bl(r){if(r instanceof Pt)return r.clone();var n=new _r(r.__wrapped__,r.__chain__);return n.__actions__=tr(r.__actions__),n.__index__=r.__index__,n.__values__=r.__values__,n}function gm(r,n,h){(h?Ve(r,n,h):n===e)?n=1:n=xe(At(n),0);var l=r==null?0:r.length;if(!l||n<1)return[];for(var m=0,A=0,M=B(Ao(l/n));m<l;)M[A++]=Sr(r,m,m+=n);return M}function mm(r){for(var n=-1,h=r==null?0:r.length,l=0,m=[];++n<h;){var A=r[n];A&&(m[l++]=A)}return m}function vm(){var r=arguments.length;if(!r)return[];for(var n=B(r-1),h=arguments[0],l=r;l--;)n[l-1]=arguments[l];return Ji(wt(h)?tr(h):[h],Be(n,1))}var ym=_t(function(r,n){return Se(r)?xn(r,Be(n,1,Se,!0)):[]}),wm=_t(function(r,n){var h=Pr(n);return Se(h)&&(h=e),Se(r)?xn(r,Be(n,1,Se,!0),ft(h,2)):[]}),bm=_t(function(r,n){var h=Pr(n);return Se(h)&&(h=e),Se(r)?xn(r,Be(n,1,Se,!0),e,h):[]});function Am(r,n,h){var l=r==null?0:r.length;return l?(n=h||n===e?1:At(n),Sr(r,n<0?0:n,l)):[]}function Em(r,n,h){var l=r==null?0:r.length;return l?(n=h||n===e?1:At(n),n=l-n,Sr(r,0,n<0?0:n)):[]}function _m(r,n){return r&&r.length?xo(r,ft(n,3),!0,!0):[]}function Im(r,n){return r&&r.length?xo(r,ft(n,3),!0):[]}function Sm(r,n,h,l){var m=r==null?0:r.length;return m?(h&&typeof h!="number"&&Ve(r,n,h)&&(h=0,l=m),v1(r,n,h,l)):[]}function kl(r,n,h){var l=r==null?0:r.length;if(!l)return-1;var m=h==null?0:At(h);return m<0&&(m=xe(l+m,0)),co(r,ft(n,3),m)}function Ul(r,n,h){var l=r==null?0:r.length;if(!l)return-1;var m=l-1;return h!==e&&(m=At(h),m=h<0?xe(l+m,0):je(m,l-1)),co(r,ft(n,3),m,!0)}function $l(r){var n=r==null?0:r.length;return n?Be(r,1):[]}function Pm(r){var n=r==null?0:r.length;return n?Be(r,S):[]}function Mm(r,n){var h=r==null?0:r.length;return h?(n=n===e?1:At(n),Be(r,n)):[]}function Cm(r){for(var n=-1,h=r==null?0:r.length,l={};++n<h;){var m=r[n];l[m[0]]=m[1]}return l}function jl(r){return r&&r.length?r[0]:e}function Rm(r,n,h){var l=r==null?0:r.length;if(!l)return-1;var m=h==null?0:At(h);return m<0&&(m=xe(l+m,0)),Fs(r,n,m)}function Nm(r){var n=r==null?0:r.length;return n?Sr(r,0,-1):[]}var xm=_t(function(r){var n=ye(r,hh);return n.length&&n[0]===r[0]?Xa(n):[]}),Om=_t(function(r){var n=Pr(r),h=ye(r,hh);return n===Pr(h)?n=e:h.pop(),h.length&&h[0]===r[0]?Xa(h,ft(n,2)):[]}),Tm=_t(function(r){var n=Pr(r),h=ye(r,hh);return n=typeof n=="function"?n:e,n&&h.pop(),h.length&&h[0]===r[0]?Xa(h,e,n):[]});function Dm(r,n){return r==null?"":Ng.call(r,n)}function Pr(r){var n=r==null?0:r.length;return n?r[n-1]:e}function Fm(r,n,h){var l=r==null?0:r.length;if(!l)return-1;var m=l;return h!==e&&(m=At(h),m=m<0?xe(l+m,0):je(m,l-1)),n===n?dg(r,n,m):co(r,Au,m,!0)}function qm(r,n){return r&&r.length?Xu(r,At(n)):e}var Bm=_t(zl);function zl(r,n){return r&&r.length&&n&&n.length?rh(r,n):r}function km(r,n,h){return r&&r.length&&n&&n.length?rh(r,n,ft(h,2)):r}function Um(r,n,h){return r&&r.length&&n&&n.length?rh(r,n,e,h):r}var $m=Ti(function(r,n){var h=r==null?0:r.length,l=Ga(r,n);return el(r,ye(n,function(m){return Di(m,h)?+m:m}).sort(ll)),l});function jm(r,n){var h=[];if(!(r&&r.length))return h;var l=-1,m=[],A=r.length;for(n=ft(n,3);++l<A;){var M=r[l];n(M,l,r)&&(h.push(M),m.push(l))}return el(r,m),h}function Eh(r){return r==null?r:Dg.call(r)}function zm(r,n,h){var l=r==null?0:r.length;return l?(h&&typeof h!="number"&&Ve(r,n,h)?(n=0,h=l):(n=n==null?0:At(n),h=h===e?l:At(h)),Sr(r,n,h)):[]}function Lm(r,n){return No(r,n)}function Hm(r,n,h){return nh(r,n,ft(h,2))}function Km(r,n){var h=r==null?0:r.length;if(h){var l=No(r,n);if(l<h&&zr(r[l],n))return l}return-1}function Vm(r,n){return No(r,n,!0)}function Qm(r,n,h){return nh(r,n,ft(h,2),!0)}function Gm(r,n){var h=r==null?0:r.length;if(h){var l=No(r,n,!0)-1;if(zr(r[l],n))return l}return-1}function Jm(r){return r&&r.length?il(r):[]}function Ym(r,n){return r&&r.length?il(r,ft(n,2)):[]}function Wm(r){var n=r==null?0:r.length;return n?Sr(r,1,n):[]}function Xm(r,n,h){return r&&r.length?(n=h||n===e?1:At(n),Sr(r,0,n<0?0:n)):[]}function Zm(r,n,h){var l=r==null?0:r.length;return l?(n=h||n===e?1:At(n),n=l-n,Sr(r,n<0?0:n,l)):[]}function tv(r,n){return r&&r.length?xo(r,ft(n,3),!1,!0):[]}function ev(r,n){return r&&r.length?xo(r,ft(n,3)):[]}var rv=_t(function(r){return Zi(Be(r,1,Se,!0))}),iv=_t(function(r){var n=Pr(r);return Se(n)&&(n=e),Zi(Be(r,1,Se,!0),ft(n,2))}),sv=_t(function(r){var n=Pr(r);return n=typeof n=="function"?n:e,Zi(Be(r,1,Se,!0),e,n)});function nv(r){return r&&r.length?Zi(r):[]}function ov(r,n){return r&&r.length?Zi(r,ft(n,2)):[]}function av(r,n){return n=typeof n=="function"?n:e,r&&r.length?Zi(r,e,n):[]}function _h(r){if(!(r&&r.length))return[];var n=0;return r=Gi(r,function(h){if(Se(h))return n=xe(h.length,n),!0}),$a(n,function(h){return ye(r,Ba(h))})}function Ll(r,n){if(!(r&&r.length))return[];var h=_h(r);return n==null?h:ye(h,function(l){return cr(n,e,l)})}var hv=_t(function(r,n){return Se(r)?xn(r,n):[]}),cv=_t(function(r){return ah(Gi(r,Se))}),uv=_t(function(r){var n=Pr(r);return Se(n)&&(n=e),ah(Gi(r,Se),ft(n,2))}),lv=_t(function(r){var n=Pr(r);return n=typeof n=="function"?n:e,ah(Gi(r,Se),e,n)}),fv=_t(_h);function pv(r,n){return al(r||[],n||[],Nn)}function dv(r,n){return al(r||[],n||[],Dn)}var gv=_t(function(r){var n=r.length,h=n>1?r[n-1]:e;return h=typeof h=="function"?(r.pop(),h):e,Ll(r,h)});function Hl(r){var n=w(r);return n.__chain__=!0,n}function mv(r,n){return n(r),r}function $o(r,n){return n(r)}var vv=Ti(function(r){var n=r.length,h=n?r[0]:0,l=this.__wrapped__,m=function(A){return Ga(A,r)};return n>1||this.__actions__.length||!(l instanceof Pt)||!Di(h)?this.thru(m):(l=l.slice(h,+h+(n?1:0)),l.__actions__.push({func:$o,args:[m],thisArg:e}),new _r(l,this.__chain__).thru(function(A){return n&&!A.length&&A.push(e),A}))});function yv(){return Hl(this)}function wv(){return new _r(this.value(),this.__chain__)}function bv(){this.__values__===e&&(this.__values__=nf(this.value()));var r=this.__index__>=this.__values__.length,n=r?e:this.__values__[this.__index__++];return{done:r,value:n}}function Av(){return this}function Ev(r){for(var n,h=this;h instanceof So;){var l=Bl(h);l.__index__=0,l.__values__=e,n?m.__wrapped__=l:n=l;var m=l;h=h.__wrapped__}return m.__wrapped__=r,n}function _v(){var r=this.__wrapped__;if(r instanceof Pt){var n=r;return this.__actions__.length&&(n=new Pt(this)),n=n.reverse(),n.__actions__.push({func:$o,args:[Eh],thisArg:e}),new _r(n,this.__chain__)}return this.thru(Eh)}function Iv(){return ol(this.__wrapped__,this.__actions__)}var Sv=Oo(function(r,n,h){Qt.call(r,h)?++r[h]:xi(r,h,1)});function Pv(r,n,h){var l=wt(r)?wu:m1;return h&&Ve(r,n,h)&&(n=e),l(r,ft(n,3))}function Mv(r,n){var h=wt(r)?Gi:Lu;return h(r,ft(n,3))}var Cv=vl(kl),Rv=vl(Ul);function Nv(r,n){return Be(jo(r,n),1)}function xv(r,n){return Be(jo(r,n),S)}function Ov(r,n,h){return h=h===e?1:At(h),Be(jo(r,n),h)}function Kl(r,n){var h=wt(r)?Ar:Xi;return h(r,ft(n,3))}function Vl(r,n){var h=wt(r)?W0:zu;return h(r,ft(n,3))}var Tv=Oo(function(r,n,h){Qt.call(r,h)?r[h].push(n):xi(r,h,[n])});function Dv(r,n,h,l){r=er(r)?r:Qs(r),h=h&&!l?At(h):0;var m=r.length;return h<0&&(h=xe(m+h,0)),Vo(r)?h<=m&&r.indexOf(n,h)>-1:!!m&&Fs(r,n,h)>-1}var Fv=_t(function(r,n,h){var l=-1,m=typeof n=="function",A=er(r)?B(r.length):[];return Xi(r,function(M){A[++l]=m?cr(n,M,h):On(M,n,h)}),A}),qv=Oo(function(r,n,h){xi(r,h,n)});function jo(r,n){var h=wt(r)?ye:Ju;return h(r,ft(n,3))}function Bv(r,n,h,l){return r==null?[]:(wt(n)||(n=n==null?[]:[n]),h=l?e:h,wt(h)||(h=h==null?[]:[h]),Zu(r,n,h))}var kv=Oo(function(r,n,h){r[h?0:1].push(n)},function(){return[[],[]]});function Uv(r,n,h){var l=wt(r)?Fa:_u,m=arguments.length<3;return l(r,ft(n,4),h,m,Xi)}function $v(r,n,h){var l=wt(r)?X0:_u,m=arguments.length<3;return l(r,ft(n,4),h,m,zu)}function jv(r,n){var h=wt(r)?Gi:Lu;return h(r,Ho(ft(n,3)))}function zv(r){var n=wt(r)?ku:D1;return n(r)}function Lv(r,n,h){(h?Ve(r,n,h):n===e)?n=1:n=At(n);var l=wt(r)?l1:F1;return l(r,n)}function Hv(r){var n=wt(r)?f1:B1;return n(r)}function Kv(r){if(r==null)return 0;if(er(r))return Vo(r)?Bs(r):r.length;var n=ze(r);return n==G||n==Re?r.size:th(r).length}function Vv(r,n,h){var l=wt(r)?qa:k1;return h&&Ve(r,n,h)&&(n=e),l(r,ft(n,3))}var Qv=_t(function(r,n){if(r==null)return[];var h=n.length;return h>1&&Ve(r,n[0],n[1])?n=[]:h>2&&Ve(n[0],n[1],n[2])&&(n=[n[0]]),Zu(r,Be(n,1),[])}),zo=Mg||function(){return qe.Date.now()};function Gv(r,n){if(typeof n!="function")throw new Er(u);return r=At(r),function(){if(--r<1)return n.apply(this,arguments)}}function Ql(r,n,h){return n=h?e:n,n=r&&n==null?r.length:n,Oi(r,gt,e,e,e,e,n)}function Gl(r,n){var h;if(typeof n!="function")throw new Er(u);return r=At(r),function(){return--r>0&&(h=n.apply(this,arguments)),r<=1&&(n=e),h}}var Ih=_t(function(r,n,h){var l=V;if(h.length){var m=Yi(h,Ks(Ih));l|=rt}return Oi(r,l,n,h,m)}),Jl=_t(function(r,n,h){var l=V|Y;if(h.length){var m=Yi(h,Ks(Jl));l|=rt}return Oi(n,l,r,h,m)});function Yl(r,n,h){n=h?e:n;var l=Oi(r,at,e,e,e,e,e,n);return l.placeholder=Yl.placeholder,l}function Wl(r,n,h){n=h?e:n;var l=Oi(r,it,e,e,e,e,e,n);return l.placeholder=Wl.placeholder,l}function Xl(r,n,h){var l,m,A,M,N,D,j=0,z=!1,K=!1,J=!0;if(typeof r!="function")throw new Er(u);n=Mr(n)||0,Ee(h)&&(z=!!h.leading,K="maxWait"in h,A=K?xe(Mr(h.maxWait)||0,n):A,J="trailing"in h?!!h.trailing:J);function nt(Pe){var Lr=l,Bi=m;return l=m=e,j=Pe,M=r.apply(Bi,Lr),M}function pt(Pe){return j=Pe,N=Bn(It,n),z?nt(Pe):M}function Et(Pe){var Lr=Pe-D,Bi=Pe-j,yf=n-Lr;return K?je(yf,A-Bi):yf}function dt(Pe){var Lr=Pe-D,Bi=Pe-j;return D===e||Lr>=n||Lr<0||K&&Bi>=A}function It(){var Pe=zo();if(dt(Pe))return Nt(Pe);N=Bn(It,Et(Pe))}function Nt(Pe){return N=e,J&&l?nt(Pe):(l=m=e,M)}function pr(){N!==e&&hl(N),j=0,l=D=m=N=e}function Qe(){return N===e?M:Nt(zo())}function dr(){var Pe=zo(),Lr=dt(Pe);if(l=arguments,m=this,D=Pe,Lr){if(N===e)return pt(D);if(K)return hl(N),N=Bn(It,n),nt(D)}return N===e&&(N=Bn(It,n)),M}return dr.cancel=pr,dr.flush=Qe,dr}var Jv=_t(function(r,n){return ju(r,1,n)}),Yv=_t(function(r,n,h){return ju(r,Mr(n)||0,h)});function Wv(r){return Oi(r,Ot)}function Lo(r,n){if(typeof r!="function"||n!=null&&typeof n!="function")throw new Er(u);var h=function(){var l=arguments,m=n?n.apply(this,l):l[0],A=h.cache;if(A.has(m))return A.get(m);var M=r.apply(this,l);return h.cache=A.set(m,M)||A,M};return h.cache=new(Lo.Cache||Ni),h}Lo.Cache=Ni;function Ho(r){if(typeof r!="function")throw new Er(u);return function(){var n=arguments;switch(n.length){case 0:return!r.call(this);case 1:return!r.call(this,n[0]);case 2:return!r.call(this,n[0],n[1]);case 3:return!r.call(this,n[0],n[1],n[2])}return!r.apply(this,n)}}function Xv(r){return Gl(2,r)}var Zv=U1(function(r,n){n=n.length==1&&wt(n[0])?ye(n[0],ur(ft())):ye(Be(n,1),ur(ft()));var h=n.length;return _t(function(l){for(var m=-1,A=je(l.length,h);++m<A;)l[m]=n[m].call(this,l[m]);return cr(r,this,l)})}),Sh=_t(function(r,n){var h=Yi(n,Ks(Sh));return Oi(r,rt,e,n,h)}),Zl=_t(function(r,n){var h=Yi(n,Ks(Zl));return Oi(r,ht,e,n,h)}),ty=Ti(function(r,n){return Oi(r,ut,e,e,e,n)});function ey(r,n){if(typeof r!="function")throw new Er(u);return n=n===e?n:At(n),_t(r,n)}function ry(r,n){if(typeof r!="function")throw new Er(u);return n=n==null?0:xe(At(n),0),_t(function(h){var l=h[n],m=es(h,0,n);return l&&Ji(m,l),cr(r,this,m)})}function iy(r,n,h){var l=!0,m=!0;if(typeof r!="function")throw new Er(u);return Ee(h)&&(l="leading"in h?!!h.leading:l,m="trailing"in h?!!h.trailing:m),Xl(r,n,{leading:l,maxWait:n,trailing:m})}function sy(r){return Ql(r,1)}function ny(r,n){return Sh(ch(n),r)}function oy(){if(!arguments.length)return[];var r=arguments[0];return wt(r)?r:[r]}function ay(r){return Ir(r,F)}function hy(r,n){return n=typeof n=="function"?n:e,Ir(r,F,n)}function cy(r){return Ir(r,P|F)}function uy(r,n){return n=typeof n=="function"?n:e,Ir(r,P|F,n)}function ly(r,n){return n==null||$u(r,n,Te(n))}function zr(r,n){return r===n||r!==r&&n!==n}var fy=qo(Wa),py=qo(function(r,n){return r>=n}),ws=Vu(function(){return arguments}())?Vu:function(r){return _e(r)&&Qt.call(r,"callee")&&!Ou.call(r,"callee")},wt=B.isArray,dy=pu?ur(pu):E1;function er(r){return r!=null&&Ko(r.length)&&!Fi(r)}function Se(r){return _e(r)&&er(r)}function gy(r){return r===!0||r===!1||_e(r)&&Ke(r)==L}var rs=Rg||qh,my=du?ur(du):_1;function vy(r){return _e(r)&&r.nodeType===1&&!kn(r)}function yy(r){if(r==null)return!0;if(er(r)&&(wt(r)||typeof r=="string"||typeof r.splice=="function"||rs(r)||Vs(r)||ws(r)))return!r.length;var n=ze(r);if(n==G||n==Re)return!r.size;if(qn(r))return!th(r).length;for(var h in r)if(Qt.call(r,h))return!1;return!0}function wy(r,n){return Tn(r,n)}function by(r,n,h){h=typeof h=="function"?h:e;var l=h?h(r,n):e;return l===e?Tn(r,n,e,h):!!l}function Ph(r){if(!_e(r))return!1;var n=Ke(r);return n==X||n==W||typeof r.message=="string"&&typeof r.name=="string"&&!kn(r)}function Ay(r){return typeof r=="number"&&Du(r)}function Fi(r){if(!Ee(r))return!1;var n=Ke(r);return n==ot||n==mt||n==k||n==te}function tf(r){return typeof r=="number"&&r==At(r)}function Ko(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=R}function Ee(r){var n=typeof r;return r!=null&&(n=="object"||n=="function")}function _e(r){return r!=null&&typeof r=="object"}var ef=gu?ur(gu):S1;function Ey(r,n){return r===n||Za(r,n,mh(n))}function _y(r,n,h){return h=typeof h=="function"?h:e,Za(r,n,mh(n),h)}function Iy(r){return rf(r)&&r!=+r}function Sy(r){if(hm(r))throw new vt(a);return Qu(r)}function Py(r){return r===null}function My(r){return r==null}function rf(r){return typeof r=="number"||_e(r)&&Ke(r)==Tt}function kn(r){if(!_e(r)||Ke(r)!=Rt)return!1;var n=yo(r);if(n===null)return!0;var h=Qt.call(n,"constructor")&&n.constructor;return typeof h=="function"&&h instanceof h&&po.call(h)==_g}var Mh=mu?ur(mu):P1;function Cy(r){return tf(r)&&r>=-R&&r<=R}var sf=vu?ur(vu):M1;function Vo(r){return typeof r=="string"||!wt(r)&&_e(r)&&Ke(r)==Ft}function fr(r){return typeof r=="symbol"||_e(r)&&Ke(r)==kt}var Vs=yu?ur(yu):C1;function Ry(r){return r===e}function Ny(r){return _e(r)&&ze(r)==qt}function xy(r){return _e(r)&&Ke(r)==ee}var Oy=qo(eh),Ty=qo(function(r,n){return r<=n});function nf(r){if(!r)return[];if(er(r))return Vo(r)?$r(r):tr(r);if(Sn&&r[Sn])return lg(r[Sn]());var n=ze(r),h=n==G?za:n==Re?uo:Qs;return h(r)}function qi(r){if(!r)return r===0?r:0;if(r=Mr(r),r===S||r===-S){var n=r<0?-1:1;return n*x}return r===r?r:0}function At(r){var n=qi(r),h=n%1;return n===n?h?n-h:n:0}function of(r){return r?gs(At(r),0,p):0}function Mr(r){if(typeof r=="number")return r;if(fr(r))return I;if(Ee(r)){var n=typeof r.valueOf=="function"?r.valueOf():r;r=Ee(n)?n+"":n}if(typeof r!="string")return r===0?r:+r;r=Iu(r);var h=ri.test(r);return h||si.test(r)?G0(r.slice(2),h?2:8):ei.test(r)?I:+r}function af(r){return hi(r,rr(r))}function Dy(r){return r?gs(At(r),-R,R):r===0?r:0}function Ut(r){return r==null?"":lr(r)}var Fy=Ls(function(r,n){if(qn(n)||er(n)){hi(n,Te(n),r);return}for(var h in n)Qt.call(n,h)&&Nn(r,h,n[h])}),hf=Ls(function(r,n){hi(n,rr(n),r)}),Qo=Ls(function(r,n,h,l){hi(n,rr(n),r,l)}),qy=Ls(function(r,n,h,l){hi(n,Te(n),r,l)}),By=Ti(Ga);function ky(r,n){var h=zs(r);return n==null?h:Uu(h,n)}var Uy=_t(function(r,n){r=ge(r);var h=-1,l=n.length,m=l>2?n[2]:e;for(m&&Ve(n[0],n[1],m)&&(l=1);++h<l;)for(var A=n[h],M=rr(A),N=-1,D=M.length;++N<D;){var j=M[N],z=r[j];(z===e||zr(z,Us[j])&&!Qt.call(r,j))&&(r[j]=A[j])}return r}),$y=_t(function(r){return r.push(e,Il),cr(cf,e,r)});function jy(r,n){return bu(r,ft(n,3),ai)}function zy(r,n){return bu(r,ft(n,3),Ya)}function Ly(r,n){return r==null?r:Ja(r,ft(n,3),rr)}function Hy(r,n){return r==null?r:Hu(r,ft(n,3),rr)}function Ky(r,n){return r&&ai(r,ft(n,3))}function Vy(r,n){return r&&Ya(r,ft(n,3))}function Qy(r){return r==null?[]:Co(r,Te(r))}function Gy(r){return r==null?[]:Co(r,rr(r))}function Ch(r,n,h){var l=r==null?e:ms(r,n);return l===e?h:l}function Jy(r,n){return r!=null&&Ml(r,n,y1)}function Rh(r,n){return r!=null&&Ml(r,n,w1)}var Yy=wl(function(r,n,h){n!=null&&typeof n.toString!="function"&&(n=go.call(n)),r[n]=h},xh(ir)),Wy=wl(function(r,n,h){n!=null&&typeof n.toString!="function"&&(n=go.call(n)),Qt.call(r,n)?r[n].push(h):r[n]=[h]},ft),Xy=_t(On);function Te(r){return er(r)?Bu(r):th(r)}function rr(r){return er(r)?Bu(r,!0):R1(r)}function Zy(r,n){var h={};return n=ft(n,3),ai(r,function(l,m,A){xi(h,n(l,m,A),l)}),h}function tw(r,n){var h={};return n=ft(n,3),ai(r,function(l,m,A){xi(h,m,n(l,m,A))}),h}var ew=Ls(function(r,n,h){Ro(r,n,h)}),cf=Ls(function(r,n,h,l){Ro(r,n,h,l)}),rw=Ti(function(r,n){var h={};if(r==null)return h;var l=!1;n=ye(n,function(A){return A=ts(A,r),l||(l=A.length>1),A}),hi(r,dh(r),h),l&&(h=Ir(h,P|O|F,Y1));for(var m=n.length;m--;)oh(h,n[m]);return h});function iw(r,n){return uf(r,Ho(ft(n)))}var sw=Ti(function(r,n){return r==null?{}:x1(r,n)});function uf(r,n){if(r==null)return{};var h=ye(dh(r),function(l){return[l]});return n=ft(n),tl(r,h,function(l,m){return n(l,m[0])})}function nw(r,n,h){n=ts(n,r);var l=-1,m=n.length;for(m||(m=1,r=e);++l<m;){var A=r==null?e:r[ci(n[l])];A===e&&(l=m,A=h),r=Fi(A)?A.call(r):A}return r}function ow(r,n,h){return r==null?r:Dn(r,n,h)}function aw(r,n,h,l){return l=typeof l=="function"?l:e,r==null?r:Dn(r,n,h,l)}var lf=El(Te),ff=El(rr);function hw(r,n,h){var l=wt(r),m=l||rs(r)||Vs(r);if(n=ft(n,4),h==null){var A=r&&r.constructor;m?h=l?new A:[]:Ee(r)?h=Fi(A)?zs(yo(r)):{}:h={}}return(m?Ar:ai)(r,function(M,N,D){return n(h,M,N,D)}),h}function cw(r,n){return r==null?!0:oh(r,n)}function uw(r,n,h){return r==null?r:nl(r,n,ch(h))}function lw(r,n,h,l){return l=typeof l=="function"?l:e,r==null?r:nl(r,n,ch(h),l)}function Qs(r){return r==null?[]:ja(r,Te(r))}function fw(r){return r==null?[]:ja(r,rr(r))}function pw(r,n,h){return h===e&&(h=n,n=e),h!==e&&(h=Mr(h),h=h===h?h:0),n!==e&&(n=Mr(n),n=n===n?n:0),gs(Mr(r),n,h)}function dw(r,n,h){return n=qi(n),h===e?(h=n,n=0):h=qi(h),r=Mr(r),b1(r,n,h)}function gw(r,n,h){if(h&&typeof h!="boolean"&&Ve(r,n,h)&&(n=h=e),h===e&&(typeof n=="boolean"?(h=n,n=e):typeof r=="boolean"&&(h=r,r=e)),r===e&&n===e?(r=0,n=1):(r=qi(r),n===e?(n=r,r=0):n=qi(n)),r>n){var l=r;r=n,n=l}if(h||r%1||n%1){var m=Fu();return je(r+m*(n-r+Q0("1e-"+((m+"").length-1))),n)}return ih(r,n)}var mw=Hs(function(r,n,h){return n=n.toLowerCase(),r+(h?pf(n):n)});function pf(r){return Nh(Ut(r).toLowerCase())}function df(r){return r=Ut(r),r&&r.replace(oi,og).replace(B0,"")}function vw(r,n,h){r=Ut(r),n=lr(n);var l=r.length;h=h===e?l:gs(At(h),0,l);var m=h;return h-=n.length,h>=0&&r.slice(h,m)==n}function yw(r){return r=Ut(r),r&&ne.test(r)?r.replace(ti,ag):r}function ww(r){return r=Ut(r),r&&ce.test(r)?r.replace(Ur,"\\$&"):r}var bw=Hs(function(r,n,h){return r+(h?"-":"")+n.toLowerCase()}),Aw=Hs(function(r,n,h){return r+(h?" ":"")+n.toLowerCase()}),Ew=ml("toLowerCase");function _w(r,n,h){r=Ut(r),n=At(n);var l=n?Bs(r):0;if(!n||l>=n)return r;var m=(n-l)/2;return Fo(Eo(m),h)+r+Fo(Ao(m),h)}function Iw(r,n,h){r=Ut(r),n=At(n);var l=n?Bs(r):0;return n&&l<n?r+Fo(n-l,h):r}function Sw(r,n,h){r=Ut(r),n=At(n);var l=n?Bs(r):0;return n&&l<n?Fo(n-l,h)+r:r}function Pw(r,n,h){return h||n==null?n=0:n&&(n=+n),Tg(Ut(r).replace(Vt,""),n||0)}function Mw(r,n,h){return(h?Ve(r,n,h):n===e)?n=1:n=At(n),sh(Ut(r),n)}function Cw(){var r=arguments,n=Ut(r[0]);return r.length<3?n:n.replace(r[1],r[2])}var Rw=Hs(function(r,n,h){return r+(h?"_":"")+n.toLowerCase()});function Nw(r,n,h){return h&&typeof h!="number"&&Ve(r,n,h)&&(n=h=e),h=h===e?p:h>>>0,h?(r=Ut(r),r&&(typeof n=="string"||n!=null&&!Mh(n))&&(n=lr(n),!n&&qs(r))?es($r(r),0,h):r.split(n,h)):[]}var xw=Hs(function(r,n,h){return r+(h?" ":"")+Nh(n)});function Ow(r,n,h){return r=Ut(r),h=h==null?0:gs(At(h),0,r.length),n=lr(n),r.slice(h,h+n.length)==n}function Tw(r,n,h){var l=w.templateSettings;h&&Ve(r,n,h)&&(n=e),r=Ut(r),n=Qo({},n,l,_l);var m=Qo({},n.imports,l.imports,_l),A=Te(m),M=ja(m,A),N,D,j=0,z=n.interpolate||Vi,K="__p += '",J=La((n.escape||Vi).source+"|"+z.source+"|"+(z===Wt?de:Vi).source+"|"+(n.evaluate||Vi).source+"|$","g"),nt="//# sourceURL="+(Qt.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++z0+"]")+`
`;r.replace(J,function(dt,It,Nt,pr,Qe,dr){return Nt||(Nt=pr),K+=r.slice(j,dr).replace(mn,hg),It&&(N=!0,K+=`' +
__e(`+It+`) +
'`),Qe&&(D=!0,K+=`';
`+Qe+`;
__p += '`),Nt&&(K+=`' +
((__t = (`+Nt+`)) == null ? '' : __t) +
'`),j=dr+dt.length,dt}),K+=`';
`;var pt=Qt.call(n,"variable")&&n.variable;if(!pt)K=`with (obj) {
`+K+`
}
`;else if(pe.test(pt))throw new vt(d);K=(D?K.replace(re,""):K).replace(_i,"$1").replace(ie,"$1;"),K="function("+(pt||"obj")+`) {
`+(pt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(N?", __e = _.escape":"")+(D?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+K+`return __p
}`;var Et=mf(function(){return Bt(A,nt+"return "+K).apply(e,M)});if(Et.source=K,Ph(Et))throw Et;return Et}function Dw(r){return Ut(r).toLowerCase()}function Fw(r){return Ut(r).toUpperCase()}function qw(r,n,h){if(r=Ut(r),r&&(h||n===e))return Iu(r);if(!r||!(n=lr(n)))return r;var l=$r(r),m=$r(n),A=Su(l,m),M=Pu(l,m)+1;return es(l,A,M).join("")}function Bw(r,n,h){if(r=Ut(r),r&&(h||n===e))return r.slice(0,Cu(r)+1);if(!r||!(n=lr(n)))return r;var l=$r(r),m=Pu(l,$r(n))+1;return es(l,0,m).join("")}function kw(r,n,h){if(r=Ut(r),r&&(h||n===e))return r.replace(Vt,"");if(!r||!(n=lr(n)))return r;var l=$r(r),m=Su(l,$r(n));return es(l,m).join("")}function Uw(r,n){var h=Ae,l=yt;if(Ee(n)){var m="separator"in n?n.separator:m;h="length"in n?At(n.length):h,l="omission"in n?lr(n.omission):l}r=Ut(r);var A=r.length;if(qs(r)){var M=$r(r);A=M.length}if(h>=A)return r;var N=h-Bs(l);if(N<1)return l;var D=M?es(M,0,N).join(""):r.slice(0,N);if(m===e)return D+l;if(M&&(N+=D.length-N),Mh(m)){if(r.slice(N).search(m)){var j,z=D;for(m.global||(m=La(m.source,Ut(Xt.exec(m))+"g")),m.lastIndex=0;j=m.exec(z);)var K=j.index;D=D.slice(0,K===e?N:K)}}else if(r.indexOf(lr(m),N)!=N){var J=D.lastIndexOf(m);J>-1&&(D=D.slice(0,J))}return D+l}function $w(r){return r=Ut(r),r&&se.test(r)?r.replace(Yt,gg):r}var jw=Hs(function(r,n,h){return r+(h?" ":"")+n.toUpperCase()}),Nh=ml("toUpperCase");function gf(r,n,h){return r=Ut(r),n=h?e:n,n===e?ug(r)?yg(r):eg(r):r.match(n)||[]}var mf=_t(function(r,n){try{return cr(r,e,n)}catch(h){return Ph(h)?h:new vt(h)}}),zw=Ti(function(r,n){return Ar(n,function(h){h=ci(h),xi(r,h,Ih(r[h],r))}),r});function Lw(r){var n=r==null?0:r.length,h=ft();return r=n?ye(r,function(l){if(typeof l[1]!="function")throw new Er(u);return[h(l[0]),l[1]]}):[],_t(function(l){for(var m=-1;++m<n;){var A=r[m];if(cr(A[0],this,l))return cr(A[1],this,l)}})}function Hw(r){return g1(Ir(r,P))}function xh(r){return function(){return r}}function Kw(r,n){return r==null||r!==r?n:r}var Vw=yl(),Qw=yl(!0);function ir(r){return r}function Oh(r){return Gu(typeof r=="function"?r:Ir(r,P))}function Gw(r){return Yu(Ir(r,P))}function Jw(r,n){return Wu(r,Ir(n,P))}var Yw=_t(function(r,n){return function(h){return On(h,r,n)}}),Ww=_t(function(r,n){return function(h){return On(r,h,n)}});function Th(r,n,h){var l=Te(n),m=Co(n,l);h==null&&!(Ee(n)&&(m.length||!l.length))&&(h=n,n=r,r=this,m=Co(n,Te(n)));var A=!(Ee(h)&&"chain"in h)||!!h.chain,M=Fi(r);return Ar(m,function(N){var D=n[N];r[N]=D,M&&(r.prototype[N]=function(){var j=this.__chain__;if(A||j){var z=r(this.__wrapped__),K=z.__actions__=tr(this.__actions__);return K.push({func:D,args:arguments,thisArg:r}),z.__chain__=j,z}return D.apply(r,Ji([this.value()],arguments))})}),r}function Xw(){return qe._===this&&(qe._=Ig),this}function Dh(){}function Zw(r){return r=At(r),_t(function(n){return Xu(n,r)})}var tb=lh(ye),eb=lh(wu),rb=lh(qa);function vf(r){return yh(r)?Ba(ci(r)):O1(r)}function ib(r){return function(n){return r==null?e:ms(r,n)}}var sb=bl(),nb=bl(!0);function Fh(){return[]}function qh(){return!1}function ob(){return{}}function ab(){return""}function hb(){return!0}function cb(r,n){if(r=At(r),r<1||r>R)return[];var h=p,l=je(r,p);n=ft(n),r-=p;for(var m=$a(l,n);++h<r;)n(h);return m}function ub(r){return wt(r)?ye(r,ci):fr(r)?[r]:tr(ql(Ut(r)))}function lb(r){var n=++Eg;return Ut(r)+n}var fb=Do(function(r,n){return r+n},0),pb=fh("ceil"),db=Do(function(r,n){return r/n},1),gb=fh("floor");function mb(r){return r&&r.length?Mo(r,ir,Wa):e}function vb(r,n){return r&&r.length?Mo(r,ft(n,2),Wa):e}function yb(r){return Eu(r,ir)}function wb(r,n){return Eu(r,ft(n,2))}function bb(r){return r&&r.length?Mo(r,ir,eh):e}function Ab(r,n){return r&&r.length?Mo(r,ft(n,2),eh):e}var Eb=Do(function(r,n){return r*n},1),_b=fh("round"),Ib=Do(function(r,n){return r-n},0);function Sb(r){return r&&r.length?Ua(r,ir):0}function Pb(r,n){return r&&r.length?Ua(r,ft(n,2)):0}return w.after=Gv,w.ary=Ql,w.assign=Fy,w.assignIn=hf,w.assignInWith=Qo,w.assignWith=qy,w.at=By,w.before=Gl,w.bind=Ih,w.bindAll=zw,w.bindKey=Jl,w.castArray=oy,w.chain=Hl,w.chunk=gm,w.compact=mm,w.concat=vm,w.cond=Lw,w.conforms=Hw,w.constant=xh,w.countBy=Sv,w.create=ky,w.curry=Yl,w.curryRight=Wl,w.debounce=Xl,w.defaults=Uy,w.defaultsDeep=$y,w.defer=Jv,w.delay=Yv,w.difference=ym,w.differenceBy=wm,w.differenceWith=bm,w.drop=Am,w.dropRight=Em,w.dropRightWhile=_m,w.dropWhile=Im,w.fill=Sm,w.filter=Mv,w.flatMap=Nv,w.flatMapDeep=xv,w.flatMapDepth=Ov,w.flatten=$l,w.flattenDeep=Pm,w.flattenDepth=Mm,w.flip=Wv,w.flow=Vw,w.flowRight=Qw,w.fromPairs=Cm,w.functions=Qy,w.functionsIn=Gy,w.groupBy=Tv,w.initial=Nm,w.intersection=xm,w.intersectionBy=Om,w.intersectionWith=Tm,w.invert=Yy,w.invertBy=Wy,w.invokeMap=Fv,w.iteratee=Oh,w.keyBy=qv,w.keys=Te,w.keysIn=rr,w.map=jo,w.mapKeys=Zy,w.mapValues=tw,w.matches=Gw,w.matchesProperty=Jw,w.memoize=Lo,w.merge=ew,w.mergeWith=cf,w.method=Yw,w.methodOf=Ww,w.mixin=Th,w.negate=Ho,w.nthArg=Zw,w.omit=rw,w.omitBy=iw,w.once=Xv,w.orderBy=Bv,w.over=tb,w.overArgs=Zv,w.overEvery=eb,w.overSome=rb,w.partial=Sh,w.partialRight=Zl,w.partition=kv,w.pick=sw,w.pickBy=uf,w.property=vf,w.propertyOf=ib,w.pull=Bm,w.pullAll=zl,w.pullAllBy=km,w.pullAllWith=Um,w.pullAt=$m,w.range=sb,w.rangeRight=nb,w.rearg=ty,w.reject=jv,w.remove=jm,w.rest=ey,w.reverse=Eh,w.sampleSize=Lv,w.set=ow,w.setWith=aw,w.shuffle=Hv,w.slice=zm,w.sortBy=Qv,w.sortedUniq=Jm,w.sortedUniqBy=Ym,w.split=Nw,w.spread=ry,w.tail=Wm,w.take=Xm,w.takeRight=Zm,w.takeRightWhile=tv,w.takeWhile=ev,w.tap=mv,w.throttle=iy,w.thru=$o,w.toArray=nf,w.toPairs=lf,w.toPairsIn=ff,w.toPath=ub,w.toPlainObject=af,w.transform=hw,w.unary=sy,w.union=rv,w.unionBy=iv,w.unionWith=sv,w.uniq=nv,w.uniqBy=ov,w.uniqWith=av,w.unset=cw,w.unzip=_h,w.unzipWith=Ll,w.update=uw,w.updateWith=lw,w.values=Qs,w.valuesIn=fw,w.without=hv,w.words=gf,w.wrap=ny,w.xor=cv,w.xorBy=uv,w.xorWith=lv,w.zip=fv,w.zipObject=pv,w.zipObjectDeep=dv,w.zipWith=gv,w.entries=lf,w.entriesIn=ff,w.extend=hf,w.extendWith=Qo,Th(w,w),w.add=fb,w.attempt=mf,w.camelCase=mw,w.capitalize=pf,w.ceil=pb,w.clamp=pw,w.clone=ay,w.cloneDeep=cy,w.cloneDeepWith=uy,w.cloneWith=hy,w.conformsTo=ly,w.deburr=df,w.defaultTo=Kw,w.divide=db,w.endsWith=vw,w.eq=zr,w.escape=yw,w.escapeRegExp=ww,w.every=Pv,w.find=Cv,w.findIndex=kl,w.findKey=jy,w.findLast=Rv,w.findLastIndex=Ul,w.findLastKey=zy,w.floor=gb,w.forEach=Kl,w.forEachRight=Vl,w.forIn=Ly,w.forInRight=Hy,w.forOwn=Ky,w.forOwnRight=Vy,w.get=Ch,w.gt=fy,w.gte=py,w.has=Jy,w.hasIn=Rh,w.head=jl,w.identity=ir,w.includes=Dv,w.indexOf=Rm,w.inRange=dw,w.invoke=Xy,w.isArguments=ws,w.isArray=wt,w.isArrayBuffer=dy,w.isArrayLike=er,w.isArrayLikeObject=Se,w.isBoolean=gy,w.isBuffer=rs,w.isDate=my,w.isElement=vy,w.isEmpty=yy,w.isEqual=wy,w.isEqualWith=by,w.isError=Ph,w.isFinite=Ay,w.isFunction=Fi,w.isInteger=tf,w.isLength=Ko,w.isMap=ef,w.isMatch=Ey,w.isMatchWith=_y,w.isNaN=Iy,w.isNative=Sy,w.isNil=My,w.isNull=Py,w.isNumber=rf,w.isObject=Ee,w.isObjectLike=_e,w.isPlainObject=kn,w.isRegExp=Mh,w.isSafeInteger=Cy,w.isSet=sf,w.isString=Vo,w.isSymbol=fr,w.isTypedArray=Vs,w.isUndefined=Ry,w.isWeakMap=Ny,w.isWeakSet=xy,w.join=Dm,w.kebabCase=bw,w.last=Pr,w.lastIndexOf=Fm,w.lowerCase=Aw,w.lowerFirst=Ew,w.lt=Oy,w.lte=Ty,w.max=mb,w.maxBy=vb,w.mean=yb,w.meanBy=wb,w.min=bb,w.minBy=Ab,w.stubArray=Fh,w.stubFalse=qh,w.stubObject=ob,w.stubString=ab,w.stubTrue=hb,w.multiply=Eb,w.nth=qm,w.noConflict=Xw,w.noop=Dh,w.now=zo,w.pad=_w,w.padEnd=Iw,w.padStart=Sw,w.parseInt=Pw,w.random=gw,w.reduce=Uv,w.reduceRight=$v,w.repeat=Mw,w.replace=Cw,w.result=nw,w.round=_b,w.runInContext=T,w.sample=zv,w.size=Kv,w.snakeCase=Rw,w.some=Vv,w.sortedIndex=Lm,w.sortedIndexBy=Hm,w.sortedIndexOf=Km,w.sortedLastIndex=Vm,w.sortedLastIndexBy=Qm,w.sortedLastIndexOf=Gm,w.startCase=xw,w.startsWith=Ow,w.subtract=Ib,w.sum=Sb,w.sumBy=Pb,w.template=Tw,w.times=cb,w.toFinite=qi,w.toInteger=At,w.toLength=of,w.toLower=Dw,w.toNumber=Mr,w.toSafeInteger=Dy,w.toString=Ut,w.toUpper=Fw,w.trim=qw,w.trimEnd=Bw,w.trimStart=kw,w.truncate=Uw,w.unescape=$w,w.uniqueId=lb,w.upperCase=jw,w.upperFirst=Nh,w.each=Kl,w.eachRight=Vl,w.first=jl,Th(w,function(){var r={};return ai(w,function(n,h){Qt.call(w.prototype,h)||(r[h]=n)}),r}(),{chain:!1}),w.VERSION=s,Ar(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){w[r].placeholder=w}),Ar(["drop","take"],function(r,n){Pt.prototype[r]=function(h){h=h===e?1:xe(At(h),0);var l=this.__filtered__&&!n?new Pt(this):this.clone();return l.__filtered__?l.__takeCount__=je(h,l.__takeCount__):l.__views__.push({size:je(h,p),type:r+(l.__dir__<0?"Right":"")}),l},Pt.prototype[r+"Right"]=function(h){return this.reverse()[r](h).reverse()}}),Ar(["filter","map","takeWhile"],function(r,n){var h=n+1,l=h==f||h==E;Pt.prototype[r]=function(m){var A=this.clone();return A.__iteratees__.push({iteratee:ft(m,3),type:h}),A.__filtered__=A.__filtered__||l,A}}),Ar(["head","last"],function(r,n){var h="take"+(n?"Right":"");Pt.prototype[r]=function(){return this[h](1).value()[0]}}),Ar(["initial","tail"],function(r,n){var h="drop"+(n?"":"Right");Pt.prototype[r]=function(){return this.__filtered__?new Pt(this):this[h](1)}}),Pt.prototype.compact=function(){return this.filter(ir)},Pt.prototype.find=function(r){return this.filter(r).head()},Pt.prototype.findLast=function(r){return this.reverse().find(r)},Pt.prototype.invokeMap=_t(function(r,n){return typeof r=="function"?new Pt(this):this.map(function(h){return On(h,r,n)})}),Pt.prototype.reject=function(r){return this.filter(Ho(ft(r)))},Pt.prototype.slice=function(r,n){r=At(r);var h=this;return h.__filtered__&&(r>0||n<0)?new Pt(h):(r<0?h=h.takeRight(-r):r&&(h=h.drop(r)),n!==e&&(n=At(n),h=n<0?h.dropRight(-n):h.take(n-r)),h)},Pt.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},Pt.prototype.toArray=function(){return this.take(p)},ai(Pt.prototype,function(r,n){var h=/^(?:filter|find|map|reject)|While$/.test(n),l=/^(?:head|last)$/.test(n),m=w[l?"take"+(n=="last"?"Right":""):n],A=l||/^find/.test(n);m&&(w.prototype[n]=function(){var M=this.__wrapped__,N=l?[1]:arguments,D=M instanceof Pt,j=N[0],z=D||wt(M),K=function(It){var Nt=m.apply(w,Ji([It],N));return l&&J?Nt[0]:Nt};z&&h&&typeof j=="function"&&j.length!=1&&(D=z=!1);var J=this.__chain__,nt=!!this.__actions__.length,pt=A&&!J,Et=D&&!nt;if(!A&&z){M=Et?M:new Pt(this);var dt=r.apply(M,N);return dt.__actions__.push({func:$o,args:[K],thisArg:e}),new _r(dt,J)}return pt&&Et?r.apply(this,N):(dt=this.thru(K),pt?l?dt.value()[0]:dt.value():dt)})}),Ar(["pop","push","shift","sort","splice","unshift"],function(r){var n=lo[r],h=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",l=/^(?:pop|shift)$/.test(r);w.prototype[r]=function(){var m=arguments;if(l&&!this.__chain__){var A=this.value();return n.apply(wt(A)?A:[],m)}return this[h](function(M){return n.apply(wt(M)?M:[],m)})}}),ai(Pt.prototype,function(r,n){var h=w[n];if(h){var l=h.name+"";Qt.call(js,l)||(js[l]=[]),js[l].push({name:n,func:h})}}),js[To(e,Y).name]=[{name:"wrapper",func:e}],Pt.prototype.clone=$g,Pt.prototype.reverse=jg,Pt.prototype.value=zg,w.prototype.at=vv,w.prototype.chain=yv,w.prototype.commit=wv,w.prototype.next=bv,w.prototype.plant=Ev,w.prototype.reverse=_v,w.prototype.toJSON=w.prototype.valueOf=w.prototype.value=Iv,w.prototype.first=w.prototype.head,Sn&&(w.prototype[Sn]=Av),w},ks=wg();ls?((ls.exports=ks)._=ks,Oa._=ks):qe._=ks}).call(Qn)})(Mc,Mc.exports);var D8=Object.defineProperty,F8=Object.defineProperties,q8=Object.getOwnPropertyDescriptors,Gp=Object.getOwnPropertySymbols,B8=Object.prototype.hasOwnProperty,k8=Object.prototype.propertyIsEnumerable,Jp=(i,t,e)=>t in i?D8(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Zo=(i,t)=>{for(var e in t||(t={}))B8.call(t,e)&&Jp(i,e,t[e]);if(Gp)for(var e of Gp(t))k8.call(t,e)&&Jp(i,e,t[e]);return i},U8=(i,t)=>F8(i,q8(t));function cs(i,t,e){var s;const o=ra(i);return((s=t.rpcMap)==null?void 0:s[o.reference])||`${T8}?chainId=${o.namespace}:${o.reference}&projectId=${e}`}function Ns(i){return i.includes(":")?i.split(":")[1]:i}function S0(i){return i.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function $8(i,t){const e=Object.keys(t.namespaces).filter(o=>o.includes(i));if(!e.length)return[];const s=[];return e.forEach(o=>{const a=t.namespaces[o].accounts;s.push(...a)}),s}function ac(i={},t={}){const e=Yp(i),s=Yp(t);return Mc.exports.merge(e,s)}function Yp(i){var t,e,s,o;const a={};if(!ro(i))return a;for(const[u,d]of Object.entries(i)){const y=Lc(u)?[u]:d.chains,b=d.methods||[],C=d.events||[],P=d.rpcMap||{},O=Jn(u);a[O]=U8(Zo(Zo({},a[O]),d),{chains:ia(y,(t=a[O])==null?void 0:t.chains),methods:ia(b,(e=a[O])==null?void 0:e.methods),events:ia(C,(s=a[O])==null?void 0:s.events),rpcMap:Zo(Zo({},P),(o=a[O])==null?void 0:o.rpcMap)})}return a}function j8(i){return i.includes(":")?i.split(":")[2]:i}function Wp(i){const t={};for(const[e,s]of Object.entries(i)){const o=s.methods||[],a=s.events||[],u=s.accounts||[],d=Lc(e)?[e]:s.chains?s.chains:S0(s.accounts);t[e]={chains:d,methods:o,events:a,accounts:u}}return t}function hc(i){return typeof i=="number"?i:i.includes("0x")?parseInt(i,16):(i=i.includes(":")?i.split(":")[1]:i,isNaN(Number(i))?i:Number(i))}const P0={},be=i=>P0[i],cc=(i,t)=>{P0[i]=t};class z8{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=be("events"),this.client=be("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(Ki.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var s;const o=Ns(e);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const s=this.createHttpProvider(t,e);s&&(this.httpProviders[t]=s)}createHttpProvider(t,e){const s=e||cs(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Hi(new us(s,be("disableProviderPing")))}}class L8{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=be("events"),this.client=be("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(parseInt(t),e),this.chainId=parseInt(t),this.events.emit(Ki.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,e){const s=e||cs(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Hi(new us(s,be("disableProviderPing")))}setHttpProvider(t,e){const s=this.createHttpProvider(t,e);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var s;const o=parseInt(Ns(e));t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[e])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}async handleSwitchChain(t){var e,s;let o=t.request.params?(e=t.request.params[0])==null?void 0:e.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const a=parseInt(o,16);if(this.isChainApproved(a))this.setDefaultChain(`${a}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${a}`);else throw new Error(`Failed to switch to chain 'eip155:${a}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class H8{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=be("events"),this.client=be("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(Ki.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var s;const o=Ns(e);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const s=this.createHttpProvider(t,e);s&&(this.httpProviders[t]=s)}createHttpProvider(t,e){const s=e||cs(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Hi(new us(s,be("disableProviderPing")))}}class K8{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=be("events"),this.client=be("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(Ki.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var s;const o=Ns(e);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const s=this.createHttpProvider(t,e);s&&(this.httpProviders[t]=s)}createHttpProvider(t,e){const s=e||cs(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Hi(new us(s,be("disableProviderPing")))}}class V8{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=be("events"),this.client=be("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(Ki.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{const s=this.getCardanoRPCUrl(e),o=Ns(e);t[o]=this.createHttpProvider(o,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}getCardanoRPCUrl(t){const e=this.namespace.rpcMap;if(e)return e[t]}setHttpProvider(t,e){const s=this.createHttpProvider(t,e);s&&(this.httpProviders[t]=s)}createHttpProvider(t,e){const s=e||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Hi(new us(s,be("disableProviderPing")))}}class Q8{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=be("events"),this.client=be("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(Ki.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var s;const o=Ns(e);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const s=this.createHttpProvider(t,e);s&&(this.httpProviders[t]=s)}createHttpProvider(t,e){const s=e||cs(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Hi(new us(s,be("disableProviderPing")))}}class G8{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=be("events"),this.client=be("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(Ki.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var s;const o=Ns(e);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const s=this.createHttpProvider(t,e);s&&(this.httpProviders[t]=s)}createHttpProvider(t,e){const s=e||cs(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Hi(new us(s,be("disableProviderPing")))}}class J8{constructor(t){this.name="near",this.namespace=t.namespace,this.events=be("events"),this.client=be("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){if(this.chainId=t,!this.httpProviders[t]){const s=e||cs(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Ki.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var s;t[e]=this.createHttpProvider(e,(s=this.namespace.rpcMap)==null?void 0:s[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const s=this.createHttpProvider(t,e);s&&(this.httpProviders[t]=s)}createHttpProvider(t,e){const s=e||cs(t,this.namespace);return typeof s>"u"?void 0:new Hi(new us(s,be("disableProviderPing")))}}var Y8=Object.defineProperty,W8=Object.defineProperties,X8=Object.getOwnPropertyDescriptors,Xp=Object.getOwnPropertySymbols,Z8=Object.prototype.hasOwnProperty,t4=Object.prototype.propertyIsEnumerable,Zp=(i,t,e)=>t in i?Y8(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,ta=(i,t)=>{for(var e in t||(t={}))Z8.call(t,e)&&Zp(i,e,t[e]);if(Xp)for(var e of Xp(t))t4.call(t,e)&&Zp(i,e,t[e]);return i},uc=(i,t)=>W8(i,X8(t));class Gc{constructor(t){this.events=new Tc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:xc(Ea({level:(t==null?void 0:t.logger)||Vp})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const e=new Gc(t);return await e.initialize(),e}async request(t,e,s){const[o,a]=this.validateChain(e);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(o).request({request:ta({},t),chainId:`${o}:${a}`,topic:this.session.topic,expiry:s})}sendAsync(t,e,s,o){const a=new Date().getTime();this.request(t,s,o).then(u=>e(null,_a(a,u))).catch(u=>e(u,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Gt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}async authenticate(t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(t),await this.cleanupPendingPairings();const{uri:e,response:s}=await this.client.authenticate(t);e&&(this.uri=e,this.events.emit("display_uri",e));const o=await s();if(this.session=o.session,this.session){const a=Wp(this.session.namespaces);this.namespaces=ac(this.namespaces,a),this.persist("namespaces",this.namespaces),this.onConnect()}return o}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}removeListener(t,e){this.events.removeListener(t,e)}off(t,e){this.events.off(t,e)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let e=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(e>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(a=>{this.session=a;const u=Wp(a.namespaces);this.namespaces=ac(this.namespaces,u),this.persist("namespaces",this.namespaces)}).catch(a=>{if(a.message!==I0)throw a;e++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,e){try{if(!this.session)return;const[s,o]=this.validateChain(t);this.getProvider(s).setDefaultChain(o,e)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const e=this.client.pairing.getAll();if(bi(e)){for(const s of e)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${e.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Qc.init({logger:this.providerOpts.logger||Vp,relayUrl:this.providerOpts.relayUrl||N8,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(e=>Jn(e)))];cc("client",this.client),cc("events",this.events),cc("disableProviderPing",this.disableProviderPing),t.forEach(e=>{if(!this.session)return;const s=$8(e,this.session),o=S0(s),a=ac(this.namespaces,this.optionalNamespaces),u=uc(ta({},a[e]),{accounts:s,chains:o});switch(e){case"eip155":this.rpcProviders[e]=new L8({namespace:u});break;case"solana":this.rpcProviders[e]=new H8({namespace:u});break;case"cosmos":this.rpcProviders[e]=new K8({namespace:u});break;case"polkadot":this.rpcProviders[e]=new z8({namespace:u});break;case"cip34":this.rpcProviders[e]=new V8({namespace:u});break;case"elrond":this.rpcProviders[e]=new Q8({namespace:u});break;case"multiversx":this.rpcProviders[e]=new G8({namespace:u});break;case"near":this.rpcProviders[e]=new J8({namespace:u});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:e}=t,{event:s}=e;if(s.name==="accountsChanged"){const o=s.data;o&&bi(o)&&this.events.emit("accountsChanged",o.map(j8))}else if(s.name==="chainChanged"){const o=e.chainId,a=e.event.data,u=Jn(o),d=hc(o)!==hc(a)?`${u}:${hc(a)}`:o;this.onChainChanged(d)}else this.events.emit(s.name,s.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:e})=>{var s;const{namespaces:o}=e,a=(s=this.client)==null?void 0:s.session.get(t);this.session=uc(ta({},a),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:e})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",uc(ta({},Gt("USER_DISCONNECTED")),{data:t.topic}))}),this.on(Ki.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var e;this.getProvider(t).updateNamespace((e=this.session)==null?void 0:e.namespaces[t])})}setNamespaces(t){const{namespaces:e,optionalNamespaces:s,sessionProperties:o}=t;e&&Object.keys(e).length&&(this.namespaces=e),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",e),this.persist("optionalNamespaces",s)}validateChain(t){const[e,s]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[e,s];if(e&&!Object.keys(this.namespaces||{}).map(u=>Jn(u)).includes(e))throw new Error(`Namespace '${e}' is not configured. Please call connect() first with namespace config.`);if(e&&s)return[e,s];const o=Jn(Object.keys(this.namespaces)[0]),a=this.rpcProviders[o].getDefaultChain();return[o,a]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,e=!1){if(!this.namespaces)return;const[s,o]=this.validateChain(t);o&&(e||this.getProvider(s).setDefaultChain(o),this.namespaces[s]?this.namespaces[s].defaultChain=o:this.namespaces[`${s}:${o}`]?this.namespaces[`${s}:${o}`].defaultChain=o:this.namespaces[`${s}:${o}`]={defaultChain:o},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",o))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,e){this.client.core.storage.setItem(`${Qp}/${t}`,e)}async getFromStore(t){return await this.client.core.storage.getItem(`${Qp}/${t}`)}}const e4=Gc,r4="wc",i4="ethereum_provider",s4=`${r4}@2:${i4}:`,n4="https://rpc.walletconnect.com/v1/",Cc=["eth_sendTransaction","personal_sign"],o4=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Rc=["chainChanged","accountsChanged"],a4=["chainChanged","accountsChanged","message","disconnect","connect"];var h4=Object.defineProperty,c4=Object.defineProperties,u4=Object.getOwnPropertyDescriptors,td=Object.getOwnPropertySymbols,l4=Object.prototype.hasOwnProperty,f4=Object.prototype.propertyIsEnumerable,ed=(i,t,e)=>t in i?h4(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Xs=(i,t)=>{for(var e in t||(t={}))l4.call(t,e)&&ed(i,e,t[e]);if(td)for(var e of td(t))f4.call(t,e)&&ed(i,e,t[e]);return i},lc=(i,t)=>c4(i,u4(t));function wa(i){return Number(i[0].split(":")[1])}function ea(i){return`0x${i.toString(16)}`}function p4(i){const{chains:t,optionalChains:e,methods:s,optionalMethods:o,events:a,optionalEvents:u,rpcMap:d}=i;if(!bi(t))throw new Error("Invalid chains");const y={chains:t,methods:s||Cc,events:a||Rc,rpcMap:Xs({},t.length?{[wa(t)]:d[wa(t)]}:{})},b=a==null?void 0:a.filter(F=>!Rc.includes(F)),C=s==null?void 0:s.filter(F=>!Cc.includes(F));if(!e&&!u&&!o&&!(b!=null&&b.length)&&!(C!=null&&C.length))return{required:t.length?y:void 0};const P=(b==null?void 0:b.length)&&(C==null?void 0:C.length)||!e,O={chains:[...new Set(P?y.chains.concat(e||[]):e)],methods:[...new Set(y.methods.concat(o!=null&&o.length?o:o4))],events:[...new Set(y.events.concat(u!=null&&u.length?u:a4))],rpcMap:d};return{required:t.length?y:void 0,optional:e.length?O:void 0}}class Jc{constructor(){this.events=new Xr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=s4,this.on=(t,e)=>(this.events.on(t,e),this),this.once=(t,e)=>(this.events.once(t,e),this),this.removeListener=(t,e)=>(this.events.removeListener(t,e),this),this.off=(t,e)=>(this.events.off(t,e),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const e=new Jc;return await e.initialize(t),e}async request(t,e){return await this.signer.request(t,this.formatChainId(this.chainId),e)}sendAsync(t,e,s){this.signer.sendAsync(t,e,this.formatChainId(this.chainId),s)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:e,optional:s}=p4(this.rpc);try{const o=await new Promise(async(u,d)=>{var y;this.rpc.showQrModal&&((y=this.modal)==null||y.subscribeModal(b=>{!b.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),d(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(lc(Xs({namespaces:Xs({},e&&{[this.namespace]:e})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(b=>{u(b)}).catch(b=>{d(new Error(b.message))})});if(!o)return;const a=Ef(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:a),this.setAccounts(a),this.events.emit("connect",{chainId:ea(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async authenticate(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:t==null?void 0:t.chains});try{const e=await new Promise(async(o,a)=>{var u;this.rpc.showQrModal&&((u=this.modal)==null||u.subscribeModal(d=>{!d.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),a(new Error("Connection request reset. Please try again.")))})),await this.signer.authenticate(lc(Xs({},t),{chains:this.rpc.chains})).then(d=>{o(d)}).catch(d=>{a(new Error(d.message))})}),s=e.session;if(s){const o=Ef(s.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:o),this.setAccounts(o),this.events.emit("connect",{chainId:ea(this.chainId)})}return e}catch(e){throw this.signer.logger.error(e),e}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:e}=t,{event:s}=e;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const e=parseInt(t);this.chainId=e,this.events.emit("chainChanged",ea(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",lc(Xs({},Gt("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var e,s;this.rpc.showQrModal&&((e=this.modal)==null||e.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const e=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));e.length&&(this.chainId=e[0],this.events.emit("chainChanged",ea(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const e=this.parseChainId(t);this.chainId=e,this.switchEthereumChain(e)}}parseAccountId(t){const[e,s,o]=t.split(":");return{chainId:`${e}:${s}`,address:o}}setAccounts(t){this.accounts=t.filter(e=>this.parseChainId(this.parseAccountId(e).chainId)===this.chainId).map(e=>this.parseAccountId(e).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var e,s;const o=(e=t==null?void 0:t.chains)!=null?e:[],a=(s=t==null?void 0:t.optionalChains)!=null?s:[],u=o.concat(a);if(!u.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const d=o.length?(t==null?void 0:t.methods)||Cc:[],y=o.length?(t==null?void 0:t.events)||Rc:[],b=(t==null?void 0:t.optionalMethods)||[],C=(t==null?void 0:t.optionalEvents)||[],P=(t==null?void 0:t.rpcMap)||this.buildRpcMap(u,t.projectId),O=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(F=>this.formatChainId(F)),optionalChains:a.map(F=>this.formatChainId(F)),methods:d,events:y,optionalMethods:b,optionalEvents:C,rpcMap:P,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:O,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,e){const s={};return t.forEach(o=>{s[o]=this.getRpcUrl(o,e)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?wa(this.rpc.chains):wa(this.rpc.optionalChains),this.signer=await e4.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let e;try{const{WalletConnectModal:s}=await jb(()=>import("./index-bcb6e679.js").then(o=>o.i),["assets/index-bcb6e679.js","assets/index-85f30e3b.js","assets/index-b41033e1.css"]);e=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(e)try{this.modal=new e(Xs({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:e,optionalChains:s,rpcMap:o}=t;e&&bi(e)&&(this.rpc.chains=e.map(a=>this.formatChainId(a)),e.forEach(a=>{this.rpc.rpcMap[a]=(o==null?void 0:o[a])||this.getRpcUrl(a)})),s&&bi(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(a=>this.formatChainId(a)),s.forEach(a=>{this.rpc.rpcMap[a]=(o==null?void 0:o[a])||this.getRpcUrl(a)}))}getRpcUrl(t,e){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${n4}?chainId=eip155:${t}&projectId=${e||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),e=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:e==null?void 0:e.accounts),this.setAccounts(e==null?void 0:e.accounts)}catch(t){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(t),await this.disconnect().catch(e=>this.signer.logger.warn(e))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(e=>this.parseAccount(e))}}const x4=Jc;export{x4 as EthereumProvider,a4 as OPTIONAL_EVENTS,o4 as OPTIONAL_METHODS,Rc as REQUIRED_EVENTS,Cc as REQUIRED_METHODS,Jc as default};
